!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=289)}([function(e,t,r){e.exports=r(241)},function(e,t,r){e.exports=r(242)},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return o})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return u})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return f})),r.d(t,"__exportStar",(function(){return d})),r.d(t,"__values",(function(){return p})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return v})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__await",(function(){return _})),r.d(t,"__asyncGenerator",(function(){return y})),r.d(t,"__asyncDelegator",(function(){return b})),r.d(t,"__asyncValues",(function(){return m})),r.d(t,"__makeTemplateObject",(function(){return k})),r.d(t,"__importStar",(function(){return T})),r.d(t,"__importDefault",(function(){return S})),r.d(t,"__classPrivateFieldGet",(function(){return w})),r.d(t,"__classPrivateFieldSet",(function(){return x}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function f(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function d(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function y(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof _?Promise.resolve(r.value.v).then(c,u):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:_(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function m(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function x(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},function(e,t,r){"use strict";var n=r(84),i=r(28),o=r(40),a=r(4),s=r(12),c=r(39),u=r(44),l=r(63),f=Object.prototype.hasOwnProperty;t.a=function(e){if(null==e)return!0;if(Object(s.a)(e)&&(Object(a.a)(e)||"string"==typeof e||"function"==typeof e.splice||Object(c.a)(e)||Object(l.a)(e)||Object(o.a)(e)))return!e.length;var t=Object(i.a)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Object(u.a)(e))return!Object(n.a)(e).length;for(var r in e)if(f.call(e,r))return!1;return!0}},function(e,t,r){"use strict";var n=Array.isArray;t.a=n},function(e,t,r){e.exports=r(260)},function(e,t,r){"use strict";var n=r(58),i=r(34),o=r(118),a=r(12),s=r(44),c=r(19),u=Object.prototype.hasOwnProperty,l=Object(o.a)((function(e,t){if(Object(s.a)(t)||Object(a.a)(t))Object(i.a)(t,Object(c.a)(t),e);else for(var r in t)u.call(t,r)&&Object(n.a)(e,r,t[r])}));t.a=l},function(e,t,r){e.exports=r(258)},function(e,t,r){"use strict";r.r(t),r.d(t,"filterOutNull",(function(){return n.filterOutNull})),r.d(t,"isDefined",(function(){return i.a})),r.d(t,"isEmpty",(function(){return o.a})),r.d(t,"keys",(function(){return a.keys})),r.d(t,"makeObject",(function(){return s})),r.d(t,"matchAll",(function(){return c})),r.d(t,"merge",(function(){return u})),r.d(t,"memoizeFunction",(function(){return l.a})),r.d(t,"memoizeSelector",(function(){return b})),r.d(t,"memoizeFunctionProperties",(function(){return k})),r.d(t,"range",(function(){return T})),r.d(t,"sortObjectBy",(function(){return S})),r.d(t,"stringLiteralArray",(function(){return w.stringLiteralArray})),r.d(t,"throwError",(function(){return x.throwError})),r.d(t,"neverGuard",(function(){return C.g})),r.d(t,"neverGuardDefault",(function(){return C.h})),r.d(t,"defaultToEmptyArray",(function(){return C.d})),r.d(t,"omitEmpty",(function(){return C.i})),r.d(t,"omitNull",(function(){return C.j})),r.d(t,"updateWith",(function(){return C.l})),r.d(t,"hasOwnProperty",(function(){return C.e})),r.d(t,"cacheLatest",(function(){return C.b})),r.d(t,"undefinedToNull",(function(){return C.k})),r.d(t,"createArrayAndFillWith",(function(){return C.c})),r.d(t,"identity",(function(){return C.f})),r.d(t,"areEqualNumbers",(function(){return C.a})),r.d(t,"uniq",(function(){return E})),r.d(t,"uniqBy",(function(){return O})),r.d(t,"countStringOccurrences",(function(){return P})),r.d(t,"isString",(function(){return I})),r.d(t,"upperFirst",(function(){return A})),r.d(t,"lowerFirst",(function(){return R})),r.d(t,"startsWith",(function(){return j})),r.d(t,"endsWith",(function(){return D})),r.d(t,"find",(function(){return M.a}));var n=r(149),i=r(114),o=r(183),a=r(56);function s(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={};return t.forEach((function(t){return n[t]=e(t)})),n}function c(e,t){var r=[];if(!t.global)throw new Error("regular expression must have the global flag set");var n=null;do{(n=t.exec(e))&&r.push(n)}while(n&&n[0]);return r}function u(e,t,r){if(0===t.length)return e;if(0===e.length)return t;for(var n=0,i=0,o=[];n<e.length&&i<t.length;)switch(r(e[n],t[i])){case 1:o.push(t[i++]);break;default:o.push(e[n++])}return n===e.length&&o.push.apply(o,t.slice(i)),i===t.length&&o.push.apply(o,e.slice(n)),o}var l=r(115),f=r(23),d=r(31),p=r.n(d),h=r(35),v=r.n(h),g=r(2),_=v.a,y=function(e,t){if(!e||!t||e===t)return e===t;var r=_(e);return r.length===_(t).length&&r.every((function(r){return t.hasOwnProperty(r)&&e[r]===t[r]}))},b=function(e,t){var r,n,i=(r=t,n=[],function(e){var t=void 0;if(n.forEach((function(r){var n=Object(g.__read)(r,2),i=n[0],o=n[1];return y(i,e)&&(t=o)})),t)return t;var i=r(e);return n.unshift([e,i]),n=n.slice(0,25),i}),o=void 0;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=i(e.apply(void 0,Object(g.__spread)(t)));if(void 0!==o&&o!==n)if(p()(n)&&p()(o)){var a=o;if(n.length===a.length&&n.every((function(e,t){return e===a[t]})))return o}else if("object"===Object(f.a)(n)&&"object"===Object(f.a)(o)&&y(o,n))return o;return o=n,n}},m=v.a;function k(e){var t,r,n={};try{for(var i=Object(g.__values)(m(e)),o=i.next();!o.done;o=i.next()){var a=o.value,s=e[a];n[a]="function"==typeof s?Object(l.a)(s.bind(n)):s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}function T(e,t,r){return Object(g.__spreadArrays)(Array(e)).map((function(e,n){return(t||0)+n*(r||1)}))}function S(e,t){var r=Object(a.keys)(e).sort((function(e,r){return t(e.toString()).localeCompare(t(r.toString()))})),n={};return r.forEach((function(t){n[t]=e[t]})),n}var w=r(153),x=r(154),C=r(96);function O(e,t){var r=e.map(t);return e.filter((function(e,n){return r.indexOf(t(e))===n}))}function E(e){return O(e,(function(e){return e}))}function P(e){return e.reduce((function(e,t){var r;return Object(g.__assign)(Object(g.__assign)({},e),((r={})[t]=(e[t]||0)+1,r))}),{})}function I(e){return"string"==typeof e}function A(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function R(e){return e.length?e[0].toLowerCase()+e.slice(1):e}function j(e,t){return e.slice(0,t.length)===t}function D(e,t){return e.slice(0-t.length)===t}var M=r(184)},function(e,t,r){e.exports=r(209)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetStringMapLoader=t.setLocalizationErrorHandlerForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.lookupStringInDefaultStringProvider=t.getDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=t.stringExists=t.setLocalizationErrorHandler=t.setCurrentLocale=t.lookUpString=t.getCurrentLocale=t.flattenStringMap=t.clearStringMapLoaders=t.addStringMapLoader=t.addStringMap=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithOnlyKey=t.isDevLocalization=t.isDev=t.disableDevModeForLocalization=t.enableDevModeForLocalization=t.togglePseudoLocalization=t.enablePseudoLocalization=t.disablePseudoLocalization=t.lookupStringInStringProvider=t.declareStringWithPlaceholders=t.declareString=void 0;var n=r(264);Object.defineProperty(t,"declareString",{enumerable:!0,get:function(){return n.declareString}}),Object.defineProperty(t,"declareStringWithPlaceholders",{enumerable:!0,get:function(){return n.declareStringWithPlaceholders}}),Object.defineProperty(t,"lookupStringInStringProvider",{enumerable:!0,get:function(){return n.lookupStringInStringProvider}});var i=r(152);Object.defineProperty(t,"disablePseudoLocalization",{enumerable:!0,get:function(){return i.disablePseudoLocalization}}),Object.defineProperty(t,"enablePseudoLocalization",{enumerable:!0,get:function(){return i.enablePseudoLocalization}}),Object.defineProperty(t,"togglePseudoLocalization",{enumerable:!0,get:function(){return i.togglePseudoLocalization}}),Object.defineProperty(t,"enableDevModeForLocalization",{enumerable:!0,get:function(){return i.enableDevModeForLocalization}}),Object.defineProperty(t,"disableDevModeForLocalization",{enumerable:!0,get:function(){return i.disableDevModeForLocalization}}),Object.defineProperty(t,"isDev",{enumerable:!0,get:function(){return i.isDev}}),Object.defineProperty(t,"isDevLocalization",{enumerable:!0,get:function(){return i.isDevLocalization}});var o=r(186);Object.defineProperty(t,"getStringDescriptionWithOnlyKey",{enumerable:!0,get:function(){return o.getStringDescriptionWithOnlyKey}}),Object.defineProperty(t,"getStringDescriptionWithPlaceholders",{enumerable:!0,get:function(){return o.getStringDescriptionWithPlaceholders}}),Object.defineProperty(t,"getStringDescriptionWithoutPlaceholders",{enumerable:!0,get:function(){return o.getStringDescriptionWithoutPlaceholders}});var a=r(151);Object.defineProperty(t,"addStringMap",{enumerable:!0,get:function(){return a.addStringMap}}),Object.defineProperty(t,"addStringMapLoader",{enumerable:!0,get:function(){return a.addStringMapLoader}}),Object.defineProperty(t,"clearStringMapLoaders",{enumerable:!0,get:function(){return a.clearStringMapLoaders}}),Object.defineProperty(t,"flattenStringMap",{enumerable:!0,get:function(){return a.flattenStringMap}}),Object.defineProperty(t,"getCurrentLocale",{enumerable:!0,get:function(){return a.getCurrentLocale}}),Object.defineProperty(t,"lookUpString",{enumerable:!0,get:function(){return a.lookUpString}}),Object.defineProperty(t,"setCurrentLocale",{enumerable:!0,get:function(){return a.setCurrentLocale}}),Object.defineProperty(t,"setLocalizationErrorHandler",{enumerable:!0,get:function(){return a.setLocalizationErrorHandler}}),Object.defineProperty(t,"stringExists",{enumerable:!0,get:function(){return a.stringExists}});var s=r(187);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return s.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return s.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return s.toSupportedLocale}});var c=r(185);Object.defineProperty(t,"addStringMapForDefaultStringProvider",{enumerable:!0,get:function(){return c.addStringMapForDefaultStringProvider}}),Object.defineProperty(t,"addStringMapLoaderForDefaultStringProvider",{enumerable:!0,get:function(){return c.addStringMapLoaderForDefaultStringProvider}}),Object.defineProperty(t,"clearStringMapLoadersForDefaultStringProvider",{enumerable:!0,get:function(){return c.clearStringMapLoadersForDefaultStringProvider}}),Object.defineProperty(t,"getCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return c.getCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"getDefaultStringProvider",{enumerable:!0,get:function(){return c.getDefaultStringProvider}}),Object.defineProperty(t,"lookupStringInDefaultStringProvider",{enumerable:!0,get:function(){return c.lookupStringInDefaultStringProvider}}),Object.defineProperty(t,"setCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return c.setCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"setLocalizationErrorHandlerForDefaultStringProvider",{enumerable:!0,get:function(){return c.setLocalizationErrorHandlerForDefaultStringProvider}});var u=r(267);Object.defineProperty(t,"makeGetStringMapLoader",{enumerable:!0,get:function(){return u.makeGetStringMapLoader}})},function(e,t){var r=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=r)},function(e,t,r){"use strict";var n=r(79),i=r(80);t.a=function(e){return null!=e&&Object(i.a)(e.length)&&!Object(n.a)(e)}},function(e,t,r){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,r){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){e.exports=r(201)},function(e,t,r){"use strict";var n=r(18).a.Symbol;t.a=n},,function(e,t,r){"use strict";var n=r(119),i="object"==typeof self&&self&&self.Object===Object&&self,o=n.a||i||Function("return this")();t.a=o},function(e,t,r){"use strict";var n=r(127),i=r(84),o=r(12);t.a=function(e){return Object(o.a)(e)?Object(n.a)(e):Object(i.a)(e)}},function(e,t,r){e.exports=r(249)},function(e,t,r){var n=r(22),i=r(11),o=r(48),a=r(52),s=r(54),c=function(e,t,r){var u,l,f,d=e&c.F,p=e&c.G,h=e&c.S,v=e&c.P,g=e&c.B,_=e&c.W,y=p?i:i[t]||(i[t]={}),b=y.prototype,m=p?n:h?n[t]:(n[t]||{}).prototype;for(u in p&&(r=t),r)(l=!d&&m&&void 0!==m[u])&&s(y,u)||(f=l?m[u]:r[u],y[u]=p&&"function"!=typeof m[u]?r[u]:g&&l?o(f,n):_&&m[u]==f?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):v&&"function"==typeof f?o(Function.call,f):f,v&&((y.virtual||(y.virtual={}))[u]=f,e&c.R&&b&&!b[u]&&a(b,u,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(15),i=r.n(n),o=r(9),a=r.n(o);function s(e){return(s="function"==typeof a.a&&"symbol"==typeof i.a?function(e){return typeof e}:function(e){return e&&"function"==typeof a.a&&e.constructor===a.a&&e!==a.a.prototype?"symbol":typeof e})(e)}function c(e){return(c="function"==typeof a.a&&"symbol"===s(i.a)?function(e){return s(e)}:function(e){return e&&"function"==typeof a.a&&e.constructor===a.a&&e!==a.a.prototype?"symbol":s(e)})(e)}},function(e,t,r){"use strict";var n=r(16),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n.a?n.a.toStringTag:void 0;var c=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=a.call(e);return n&&(t?e[s]=r:delete e[s]),i},u=Object.prototype.toString;var l=function(e){return u.call(e)},f=n.a?n.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":f&&f in Object(e)?c(e):l(e)}},function(e,t,r){"use strict";t.a=function(e){return function(t){return e(t)}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=r(136)("wks"),i=r(106),o=r(22).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){"use strict";var n=r(29),i=r(18),o=Object(n.a)(i.a,"DataView"),a=r(64),s=Object(n.a)(i.a,"Promise"),c=r(65),u=Object(n.a)(i.a,"WeakMap"),l=r(24),f=r(51),d=Object(f.a)(o),p=Object(f.a)(a.a),h=Object(f.a)(s),v=Object(f.a)(c.a),g=Object(f.a)(u),_=l.a;(o&&"[object DataView]"!=_(new o(new ArrayBuffer(1)))||a.a&&"[object Map]"!=_(new a.a)||s&&"[object Promise]"!=_(s.resolve())||c.a&&"[object Set]"!=_(new c.a)||u&&"[object WeakMap]"!=_(new u))&&(_=function(e){var t=Object(l.a)(e),r="[object Object]"==t?e.constructor:void 0,n=r?Object(f.a)(r):"";if(n)switch(n){case d:return"[object DataView]";case p:return"[object Map]";case h:return"[object Promise]";case v:return"[object Set]";case g:return"[object WeakMap]"}return t});t.a=_},function(e,t,r){"use strict";var n,i=r(79),o=r(18).a["__core-js_shared__"],a=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";var s=function(e){return!!a&&a in e},c=r(13),u=r(51),l=/^\[object .+?Constructor\]$/,f=Function.prototype,d=Object.prototype,p=f.toString,h=d.hasOwnProperty,v=RegExp("^"+p.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var g=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(i.a)(e)?v:l).test(Object(u.a)(e))};var _=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var r=_(e,t);return g(r)?r:void 0}},function(e,t,r){e.exports=r(232)},function(e,t,r){e.exports=r(234)},function(e,t,r){var n=r(26);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},function(e,t,r){"use strict";var n=r(58),i=r(81);t.a=function(e,t,r,o){var a=!r;r||(r={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=o?o(r[u],e[u],u,r,e):void 0;void 0===l&&(l=e[u]),a?Object(i.a)(r,u,l):Object(n.a)(r,u,l)}return r}},function(e,t,r){e.exports=r(251)},function(e,t,r){"use strict";var n=r(42);var i=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},o=Math.max;var a=function(e,t,r){return t=o(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=o(n.length-t,0),c=Array(s);++a<s;)c[a]=n[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=n[a];return u[t]=r(c),i(e,this,u)}};var s=function(e){return function(){return e}},c=r(85),u=c.a?function(e,t){return Object(c.a)(e,"toString",{configurable:!0,enumerable:!1,value:s(t),writable:!0})}:n.a,l=Date.now;var f=function(e){var t=0,r=0;return function(){var n=l(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(u);t.a=function(e,t){return f(a(e,t,n.a),e+"")}},function(e,t,r){"use strict";(function(e){var n=r(119),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i&&n.a.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,r(148)(e))},function(e,t,r){var n=r(32),i=r(162),o=r(132),a=Object.defineProperty;t.f=r(41)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";(function(e){var n=r(18),i=r(197),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o?n.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||i.a;t.a=c}).call(this,r(148)(e))},function(e,t,r){"use strict";var n=r(24),i=r(14);var o=function(e){return Object(i.a)(e)&&"[object Arguments]"==Object(n.a)(e)},a=Object.prototype,s=a.hasOwnProperty,c=a.propertyIsEnumerable,u=o(function(){return arguments}())?o:function(e){return Object(i.a)(e)&&s.call(e,"callee")&&!c.call(e,"callee")};t.a=u},function(e,t,r){e.exports=!r(53)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";t.a=function(e){return e}},function(e,t,r){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,r){"use strict";var n=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,r){"use strict";var n=r(61);var i=function(){this.__data__=new n.a,this.size=0};var o=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var a=function(e){return this.__data__.get(e)};var s=function(e){return this.__data__.has(e)},c=r(64),u=r(72);var l=function(e,t){var r=this.__data__;if(r instanceof n.a){var i=r.__data__;if(!c.a||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new u.a(i)}return r.set(e,t),this.size=r.size,this};function f(e){var t=this.__data__=new n.a(e);this.size=t.size}f.prototype.clear=i,f.prototype.delete=o,f.prototype.get=a,f.prototype.has=s,f.prototype.set=l;t.a=f},function(e,t,r){"use strict";var n=r(83);t.a=function(e,t){return Object(n.a)(e,t)}},,function(e,t,r){var n=r(68);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){"use strict";var n=r(43),i=r(12),o=r(57),a=r(13);t.a=function(e,t,r){if(!Object(a.a)(r))return!1;var s=typeof t;return!!("number"==s?Object(i.a)(r)&&Object(o.a)(t,r.length):"string"==s&&t in r)&&Object(n.a)(r[t],e)}},function(e,t,r){"use strict";t.a=function(e,t){return e.has(t)}},function(e,t,r){"use strict";var n=Function.prototype.toString;t.a=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,r){var n=r(38),i=r(89);e.exports=r(41)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(113),i=r(33),o=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var a=null,s=null,c=null;function u(e){return"string"==typeof e}function l(e){return"number"==typeof e}function f(e){return"boolean"==typeof e}function d(e){return e instanceof Date}function p(e){return 1e4*(e+621355968e5)}function h(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function v(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function g(e){return e<10?"0"+e:e.toString()}function _(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new n.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=u,t.isNumber=l,t.isBoolean=f,t.isDate=d,t.msToTicks=p,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===a&&(a="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),a},t.isUint8ArrayAvailable=function(){return null===s&&(s="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!h()),s},t.isPriority=function(e){return!(!l(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,r){return!t.PropertyNameRegex.test(e)||_(r)?null:(_(r.value)&&(r={value:r,type:i.AWTPropertyType.Unspecified}),r.type=function(e,t){switch(t=function(e){if(l(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:i.AWTPropertyType.Unspecified){case i.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return i.AWTPropertyType.String;case"boolean":return i.AWTPropertyType.Boolean;case"number":return i.AWTPropertyType.Double;case"object":return d(e)?i.AWTPropertyType.Date:null}return null}(e);case i.AWTPropertyType.String:return u(e)?t:null;case i.AWTPropertyType.Boolean:return f(e)?t:null;case i.AWTPropertyType.Date:return d(e)&&NaN!==e.getTime()?t:null;case i.AWTPropertyType.Int64:return l(e)&&e%1==0?t:null;case i.AWTPropertyType.Double:return l(e)?t:null}return null}(r.value,r.type),r.type?(d(r.value)&&(r.value=p(r.value.getTime())),r.pii>0&&r.cc>0?null:r.pii?function(e){if(l(e)&&e>=0&&e<=13)return!0;return!1}(r.pii)?r:null:r.cc?function(e){if(l(e)&&e>=0&&e<=1)return!0;return!1}(r.cc)?r:null:r):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+g(e.getUTCMonth()+1)+"-"+g(e.getUTCDate())+"T"+g(e.getUTCHours())+":"+g(e.getUTCMinutes())+":"+g(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===c){var e=new XMLHttpRequest;c=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return c},t.useFetchRequest=function(){return h()||v()},t.isReactNative=h,t.isServiceWorkerGlobalScope=v},function(e,t,r){"use strict";function n(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}r.r(t),r.d(t,"keys",(function(){return n}))},function(e,t,r){"use strict";var n=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){"use strict";var n=r(81),i=r(43),o=Object.prototype.hasOwnProperty;t.a=function(e,t,r){var a=e[t];o.call(e,t)&&Object(i.a)(a,r)&&(void 0!==r||t in e)||Object(n.a)(e,t,r)}},function(e,t,r){"use strict";t.a=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},function(e,t,r){"use strict";t.a=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},function(e,t,r){"use strict";var n=function(){this.__data__=[],this.size=0},i=r(43);var o=function(e,t){for(var r=e.length;r--;)if(Object(i.a)(e[r][0],t))return r;return-1},a=Array.prototype.splice;var s=function(e){var t=this.__data__,r=o(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),--this.size,!0)};var c=function(e){var t=this.__data__,r=o(t,e);return r<0?void 0:t[r][1]};var u=function(e){return o(this.__data__,e)>-1};var l=function(e,t){var r=this.__data__,n=o(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function f(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}f.prototype.clear=n,f.prototype.delete=s,f.prototype.get=c,f.prototype.has=u,f.prototype.set=l;t.a=f},function(e,t,r){"use strict";var n=r(72);var i=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var o=function(e){return this.__data__.has(e)};function a(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n.a;++t<r;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o;t.a=a},function(e,t,r){"use strict";var n=r(24),i=r(80),o=r(14),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=function(e){return Object(o.a)(e)&&Object(i.a)(e.length)&&!!a[Object(n.a)(e)]},c=r(25),u=r(37),l=u.a&&u.a.isTypedArray,f=l?Object(c.a)(l):s;t.a=f},function(e,t,r){"use strict";var n=r(29),i=r(18),o=Object(n.a)(i.a,"Map");t.a=o},function(e,t,r){"use strict";var n=r(29),i=r(18),o=Object(n.a)(i.a,"Set");t.a=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33);t.AWTPropertyType=n.AWTPropertyType,t.AWTPiiKind=n.AWTPiiKind,t.AWTEventPriority=n.AWTEventPriority,t.AWTEventsDroppedReason=n.AWTEventsDroppedReason,t.AWTEventsRejectedReason=n.AWTEventsRejectedReason,t.AWTCustomerContentKind=n.AWTCustomerContentKind;var i=r(111);t.AWTUserIdType=i.AWTUserIdType,t.AWTSessionState=i.AWTSessionState;var o=r(188);t.AWT_BEST_EFFORT=o.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=o.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=o.AWT_REAL_TIME;var a=r(112);t.AWTEventProperties=a.default;var s=r(189);t.AWTLogger=s.default;var c=r(193);t.AWTLogManager=c.default;var u=r(288);t.AWTTransmissionManager=u.default;var l=r(191);t.AWTSerializer=l.default;var f=r(155);t.AWTSemanticContext=f.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,r){"use strict";var n=r(202)(!0);r(130)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){r(207);for(var n=r(22),i=r(52),o=r(73),a=r(27)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var u=s[c],l=n[u],f=l&&l.prototype;f&&!f[a]&&i(f,a,u),o[u]=o.Array}},function(e,t,r){"use strict";function n(e){return e}function i(e,t){return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},function(e,t,r){e.exports=r(221)},function(e,t,r){"use strict";var n=r(29),i=Object(n.a)(Object,"create");var o=function(){this.__data__=i?i(null):{},this.size=0};var a=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},s=Object.prototype.hasOwnProperty;var c=function(e){var t=this.__data__;if(i){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return s.call(t,e)?t[e]:void 0},u=Object.prototype.hasOwnProperty;var l=function(e){var t=this.__data__;return i?void 0!==t[e]:u.call(t,e)};var f=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this};function d(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}d.prototype.clear=o,d.prototype.delete=a,d.prototype.get=c,d.prototype.has=l,d.prototype.set=f;var p=d,h=r(61),v=r(64);var g=function(){this.size=0,this.__data__={hash:new p,map:new(v.a||h.a),string:new p}};var _=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var y=function(e,t){var r=e.__data__;return _(t)?r["string"==typeof t?"string":"hash"]:r.map};var b=function(e){var t=y(this,e).delete(e);return this.size-=t?1:0,t};var m=function(e){return y(this,e).get(e)};var k=function(e){return y(this,e).has(e)};var T=function(e,t){var r=y(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function S(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}S.prototype.clear=g,S.prototype.delete=b,S.prototype.get=m,S.prototype.has=k,S.prototype.set=T;t.a=S},function(e,t){e.exports={}},function(e,t,r){var n=r(134),i=r(129);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(129);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(48),i=r(172),o=r(173),a=r(32),s=r(105),c=r(142),u={},l={};(t=e.exports=function(e,t,r,f,d){var p,h,v,g,_=d?function(){return e}:c(e),y=n(r,f,t?2:1),b=0;if("function"!=typeof _)throw TypeError(e+" is not iterable!");if(o(_)){for(p=s(e.length);p>b;b++)if((g=t?y(a(h=e[b])[0],h[1]):y(e[b]))===u||g===l)return g}else for(v=_.call(e);!(h=v.next()).done;)if((g=i(v,y,h.value,t))===u||g===l)return g}).BREAK=u,t.RETURN=l},function(e,t,r){var n=r(26);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,r=function(r){n.listeners[r].eventsSent&&setTimeout((function(){return t.listeners[r].eventsSent(e)}),0)},n=this,i=0;i<this.listeners.length;++i)r(i)},e.eventsDropped=function(e,t){for(var r=this,n=function(n){i.listeners[n].eventsDropped&&setTimeout((function(){return r.listeners[n].eventsDropped(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)n(o)},e.eventsRetrying=function(e){for(var t=this,r=function(r){n.listeners[r].eventsRetrying&&setTimeout((function(){return t.listeners[r].eventsRetrying(e)}),0)},n=this,i=0;i<this.listeners.length;++i)r(i)},e.eventsRejected=function(e,t){for(var r=this,n=function(n){i.listeners[n].eventsRejected&&setTimeout((function(){return r.listeners[n].eventsRejected(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)n(o)},e.listeners=[],e}();t.default=n},function(e,t,r){"use strict";var n=r(24),i=r(13);t.a=function(e){if(!Object(i.a)(e))return!1;var t=Object(n.a)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,r){"use strict";t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,r){"use strict";var n=r(85);t.a=function(e,t,r){"__proto__"==t&&n.a?Object(n.a)(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t,r){"use strict";var n=r(125),i=r(124),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),Object(n.a)(a(e),(function(t){return o.call(e,t)})))}:i.a;t.a=s},function(e,t,r){"use strict";var n=r(45),i=r(62),o=r(121),a=r(50);var s=function(e,t,r,n,s,c){var u=1&r,l=e.length,f=t.length;if(l!=f&&!(u&&f>l))return!1;var d=c.get(e);if(d&&c.get(t))return d==t;var p=-1,h=!0,v=2&r?new i.a:void 0;for(c.set(e,t),c.set(t,e);++p<l;){var g=e[p],_=t[p];if(n)var y=u?n(_,g,p,t,e,c):n(g,_,p,e,t,c);if(void 0!==y){if(y)continue;h=!1;break}if(v){if(!Object(o.a)(t,(function(e,t){if(!Object(a.a)(v,t)&&(g===e||s(g,e,r,n,c)))return v.push(t)}))){h=!1;break}}else if(g!==_&&!s(g,_,r,n,c)){h=!1;break}}return c.delete(e),c.delete(t),h},c=r(16),u=r(86),l=r(43),f=r(122),d=r(59),p=c.a?c.a.prototype:void 0,h=p?p.valueOf:void 0;var v=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new u.a(e),new u.a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Object(l.a)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=f.a;case"[object Set]":var p=1&n;if(c||(c=d.a),e.size!=t.size&&!p)return!1;var v=a.get(e);if(v)return v==t;n|=2,a.set(e,t);var g=s(c(e),c(t),n,i,o,a);return a.delete(e),g;case"[object Symbol]":if(h)return h.call(e)==h.call(t)}return!1},g=r(98),_=Object.prototype.hasOwnProperty;var y=function(e,t,r,n,i,o){var a=1&r,s=Object(g.a)(e),c=s.length;if(c!=Object(g.a)(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:_.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var d=!0;o.set(e,t),o.set(t,e);for(var p=a;++u<c;){var h=e[l=s[u]],v=t[l];if(n)var y=a?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===y?h===v||i(h,v,r,n,o):y)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var b=e.constructor,m=t.constructor;b==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof m&&m instanceof m||(d=!1)}return o.delete(e),o.delete(t),d},b=r(28),m=r(4),k=r(39),T=r(63),S="[object Object]",w=Object.prototype.hasOwnProperty;var x=function(e,t,r,i,o,a){var c=Object(m.a)(e),u=Object(m.a)(t),l=c?"[object Array]":Object(b.a)(e),f=u?"[object Array]":Object(b.a)(t),d=(l="[object Arguments]"==l?S:l)==S,p=(f="[object Arguments]"==f?S:f)==S,h=l==f;if(h&&Object(k.a)(e)){if(!Object(k.a)(t))return!1;c=!0,d=!1}if(h&&!d)return a||(a=new n.a),c||Object(T.a)(e)?s(e,t,r,i,o,a):v(e,t,l,r,i,o,a);if(!(1&r)){var g=d&&w.call(e,"__wrapped__"),_=p&&w.call(t,"__wrapped__");if(g||_){var x=g?e.value():e,C=_?t.value():t;return a||(a=new n.a),o(x,C,r,i,a)}}return!!h&&(a||(a=new n.a),y(e,t,r,i,o,a))},C=r(14);t.a=function e(t,r,n,i,o){return t===r||(null==t||null==r||!Object(C.a)(t)&&!Object(C.a)(r)?t!=t&&r!=r:x(t,r,n,i,e,o))}},function(e,t,r){"use strict";var n=r(44),i=r(120),o=Object(i.a)(Object.keys,Object),a=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(n.a)(e))return o(e);var t=[];for(var r in Object(e))a.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t,r){"use strict";var n=r(29),i=function(){try{var e=Object(n.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=i},function(e,t,r){"use strict";var n=r(18).a.Uint8Array;t.a=n},function(e,t,r){e.exports=r(273)},function(e,t){e.exports=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(32),i=r(204),o=r(137),a=r(135)("IE_PROTO"),s=function(){},c=function(){var e,t=r(131)("iframe"),n=o.length;for(t.style.display="none",r(164).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[o[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=c(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(163),i=r(137);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(38).f,i=r(54),o=r(27)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(106)("meta"),i=r(26),o=r(54),a=r(38).f,s=0,c=Object.isExtensible||function(){return!0},u=!r(53)((function(){return c(Object.preventExtensions({}))})),l=function(e){a(e,n,{value:{i:"O"+ ++s,w:{}}})},f=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,n)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[n].i},getWeak:function(e,t){if(!o(e,n)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[n].w},onFreeze:function(e){return u&&f.NEED&&c(e)&&!o(e,n)&&l(e),e}}},function(e,t){},function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"j",(function(){return u})),r.d(t,"l",(function(){return f})),r.d(t,"e",(function(){return d})),r.d(t,"b",(function(){return p})),r.d(t,"k",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"f",(function(){return g})),r.d(t,"a",(function(){return _}));var n=r(6),i=r(56),o=r(70);r.d(t,"g",(function(){return o.a})),r.d(t,"h",(function(){return o.b}));var a=[];function s(e){return e||a}function c(e){return l(e,(function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)}))}function u(e){return l(e,(function(e){return null!==e}))}function l(e,t){if(null==e)return e;for(var r={},n=0,o=Object(i.keys)(e);n<o.length;n++){var a=o[n];t(e[a])&&(r[a]=e[a])}return r}function f(e,t){return Object(n.a)({},e,t)}function d(e,t){return e.hasOwnProperty(t)}function p(e){var t=void 0;return function(r){if(t&&r===t.arg)return t.result;var n=e(r);return t={arg:r,result:n},n}}function h(e){return void 0===e?null:e}function v(e,t){var r=[];if(e>0&&e<Number.MAX_VALUE)for(var n=0;n<e;n+=1)r.push(t(n));return r}function g(e){return e}function _(e,t,r){return void 0===r&&(r=1e-5),Math.abs(e-t)<r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(188),i=r(33),o=r(276),a=r(190),s=r(112),c=r(193),u=r(55),l=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),a.default.initialize((function(e,r){if(t._config.canSendStatEvent("awt_stats")){var n=new s.default("awt_stats");for(var o in n.setEventPriority(i.AWTEventPriority.High),n.setProperty("TenantId",r),e)e.hasOwnProperty(o)&&n.setProperty(o,e[o].toString());c.default.getLogger(u.StatsApiKey).logEvent(n)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var r=2;r>=0;--r)if(e[t][r]<0){for(var n=r;n>=0;--n)e[t][n]=-1;break}for(r=2;r>0;--r)if(e[t][r]>0&&e[t][r-1]>0){var i=e[t][r-1]/e[t][r];e[t][r-1]=Math.ceil(i)*e[t][r]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===i.AWTEventPriority.Immediate_sync&&(e.priority=i.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){a.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=n.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=i.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=i.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=i.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[n.AWT_REAL_TIME]=[4,2,1],this._profiles[n.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[n.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=n.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=l},function(e,t,r){"use strict";var n=r(123),i=r(82),o=r(19);t.a=function(e){return Object(n.a)(e,o.a,i.a)}},function(e,t,r){e.exports=r(229)},function(e,t,r){"use strict";var n=r(261),i=r(262),o=r(263);function a(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function s(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function c(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=i({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),a=t.length>0?t.join("="):void 0;a=void 0===a?null:o(a),r(o(i),a,n)})),Object.keys(n).sort().reduce((function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(r):e[t]=r,e}),Object.create(null))):n}t.extract=s,t.parse=c,t.stringify=function(e,t){!1===(t=i({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[a(t,e),"[",n,"]"].join(""):[a(t,e),"[",a(n,e),"]=",a(r,e)].join("")};case"bracket":return function(t,r){return null===r?a(t,e):[a(t,e),"[]=",a(r,e)].join("")};default:return function(t,r){return null===r?a(t,e):[a(t,e),"=",a(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(n){var i=e[n];if(void 0===i)return"";if(null===i)return a(n,t);if(Array.isArray(i)){var o=[];return i.slice().forEach((function(e){void 0!==e&&o.push(r(n,e,o.length))})),o.join("&")}return a(n,t)+"="+a(i,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:c(s(e),t)}}},,,,,function(e,t,r){var n=r(128),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){var n=r(52);e.exports=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(92),i=r(27)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(55),i=r(33),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,r){void 0===r&&(r=i.AWTPropertyType.Unspecified);var o={value:t,type:r,pii:i.AWTPiiKind.NotSet,cc:i.AWTCustomerContentKind.NotSet};null!==(o=n.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,r,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:r,cc:i.AWTCustomerContentKind.NotSet};null!==(a=n.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,r,o){void 0===o&&(o=i.AWTPropertyType.Unspecified);var a={value:t,type:o,pii:i.AWTPiiKind.NotSet,cc:r};null!==(a=n.sanitizeProperty(e,a))?this._event.properties[e]=a:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var r=new e(t);return this.low===r.low&&this.high===r.high},e}();t.Int64=n;var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var r=new e(t);return this.low===r.low&&this.high===r.high},e}();t.UInt64=i;var o=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},function(e,t,r){"use strict";function n(e){return null!=e}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n,i,o,a=r(23),s=r(35),c=r.n(s),u=r(71),l=r.n(u),f=r(158),d=r.n(f),p=r(46),h=r(2),v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},g="undefined"!=typeof console?console:void 0,_={trace:(null!==(n=null==g?void 0:g.trace)&&void 0!==n?n:v).bind(g),warn:(null!==(i=null==g?void 0:g.warn)&&void 0!==i?i:v).bind(g),table:(null!==(o=null==g?void 0:g.table)&&void 0!==o?o:v).bind(g)},y="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,b={empty:!0},m={},k=void 0===d.a?null:d.a,T=function(e,t){if(void 0===t&&(t=100),!k)return e;var r=w(),n=0,i=0,o=y?new l.a:void 0,a=new Error("Memoized function defined").stack;return function(){for(var s,u,l,f,d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];var g=r;(0!==i||t>0&&n>t)&&(r=w(),n=0,i=0,null==o||o.clear()),g=r;for(var b=function(e){var t=S(d[e]);if(!(null===(s=g.map)||void 0===s?void 0:s.has(t))&&(null===(u=g.map)||void 0===u||u.set(t,w()),y&&o)){var r=null!==(l=o.get(g))&&void 0!==l?l:[],n=r.filter((function(e){return e!==t&&Object(p.a)(e,t)}))[0];if(n){_.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var i=new Error("Indentical argument passed").stack;!function e(t,r){_.table(t),c()(t).forEach((function(n){var i=t[n],o=r[n];i!==o&&Object(p.a)(i,o)&&(_.warn("Duplication present in child prop '"+n+"'"),e(i,o))}))}(n,t),_.warn(i),_.warn(a)}o.set(g,Object(h.__spread)(r,[t]))}g=null===(f=g.map)||void 0===f?void 0:f.get(t)},m=0;m<d.length;m++)b(m);return g.hasOwnProperty("value")||(g.value=e.apply(void 0,Object(h.__spread)(d)),n++),g.value}};function S(e){return e?"object"===Object(a.a)(e)||"function"==typeof e?e:(m[e]||(m[e]={val:e}),m[e]):b}function w(){return{map:k?new k:null}}},function(e,t,r){e.exports=r(216)},function(e,t,r){e.exports=r(219)},function(e,t,r){"use strict";var n=r(36),i=r(49);t.a=function(e){return Object(n.a)((function(t,r){var n=-1,o=r.length,a=o>1?r[o-1]:void 0,s=o>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&Object(i.a)(r[0],r[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++n<o;){var c=r[n];c&&e(t,c,n,a)}return t}))}},function(e,t,r){"use strict";(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.a=r}).call(this,r(248))},function(e,t,r){"use strict";t.a=function(e,t){return function(r){return e(t(r))}}},function(e,t,r){"use strict";t.a=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},function(e,t,r){"use strict";t.a=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},function(e,t,r){"use strict";var n=r(60),i=r(4);t.a=function(e,t,r){var o=t(e);return Object(i.a)(e)?o:Object(n.a)(o,r(e))}},function(e,t,r){"use strict";t.a=function(){return[]}},function(e,t,r){"use strict";t.a=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}},function(e,t,r){"use strict";(function(e){var n=r(18),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=o&&o.exports===i?n.a.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(148)(e))},function(e,t,r){"use strict";var n=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},i=r(40),o=r(4),a=r(39),s=r(57),c=r(63),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var r=Object(o.a)(e),l=!r&&Object(i.a)(e),f=!r&&!l&&Object(a.a)(e),d=!r&&!l&&!f&&Object(c.a)(e),p=r||l||f||d,h=p?n(e.length,String):[],v=h.length;for(var g in e)!t&&!u.call(e,g)||p&&("length"==g||f&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||Object(s.a)(g,v))||h.push(g);return h}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){"use strict";var n=r(88),i=r(21),o=r(133),a=r(52),s=r(73),c=r(203),u=r(93),l=r(165),f=r(27)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,r,h,v,g,_){c(r,t,h);var y,b,m,k=function(e){if(!d&&e in x)return x[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},T=t+" Iterator",S="values"==v,w=!1,x=e.prototype,C=x[f]||x["@@iterator"]||v&&x[v],O=C||k(v),E=v?S?k("entries"):O:void 0,P="Array"==t&&x.entries||C;if(P&&(m=l(P.call(new e)))!==Object.prototype&&m.next&&(u(m,T,!0),n||"function"==typeof m[f]||a(m,f,p)),S&&C&&"values"!==C.name&&(w=!0,O=function(){return C.call(this)}),n&&!_||!d&&!w&&x[f]||a(x,f,O),s[t]=O,s[T]=p,v)if(y={values:S?O:k("values"),keys:g?O:k("keys"),entries:E},_)for(b in y)b in x||o(x,b,y[b]);else i(i.P+i.F*(d||w),t,y);return y}},function(e,t,r){var n=r(26),i=r(22).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(26);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=r(52)},function(e,t,r){var n=r(92);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(136)("keys"),i=r(106);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t,r){var n=r(11),i=r(22),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(88)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){t.f=r(27)},function(e,t,r){var n=r(22),i=r(11),o=r(88),a=r(138),s=r(38).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(92);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(110),i=r(27)("iterator"),o=r(73);e.exports=r(11).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){"use strict";var n=r(22),i=r(21),o=r(94),a=r(53),s=r(52),c=r(108),u=r(76),l=r(109),f=r(26),d=r(93),p=r(38).f,h=r(144)(0),v=r(41);e.exports=function(e,t,r,g,_,y){var b=n[e],m=b,k=_?"set":"add",T=m&&m.prototype,S={};return v&&"function"==typeof m&&(y||T.forEach&&!a((function(){(new m).entries().next()})))?(m=t((function(t,r){l(t,m,e,"_c"),t._c=new b,null!=r&&u(r,_,t[k],t)})),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in T)||y&&"clear"==e||s(m.prototype,e,(function(r,n){if(l(this,m,e),!t&&y&&!f(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i}))})),y||p(m.prototype,"size",{get:function(){return this._c.size}})):(m=g.getConstructor(t,e,_,k),c(m.prototype,r),o.NEED=!0),d(m,e),S[e]=m,i(i.G+i.W+i.F,S),y||g.setStrong(m,e,_),m}},function(e,t,r){var n=r(48),i=r(134),o=r(75),a=r(105),s=r(223);e.exports=function(e,t){var r=1==e,c=2==e,u=3==e,l=4==e,f=6==e,d=5==e||f,p=t||s;return function(t,s,h){for(var v,g,_=o(t),y=i(_),b=n(s,h,3),m=a(y.length),k=0,T=r?p(t,m):c?p(t,0):void 0;m>k;k++)if((d||k in y)&&(g=b(v=y[k],k,_),e))if(r)T[k]=g;else if(g)switch(e){case 3:return!0;case 5:return v;case 6:return k;case 2:T.push(v)}else if(l)return!1;return f?-1:u||l?l:T}}},function(e,t,r){"use strict";var n=r(21);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){"use strict";var n=r(21),i=r(68),o=r(48),a=r(76);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),null==e?new this:(r=[],t?(n=0,s=o(c,arguments[2],2),a(e,!1,(function(e){r.push(s(e,n++))}))):a(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";var n=r(68);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";r.r(t),r.d(t,"filterOutNull",(function(){return i}));var n=r(114);function i(e){return e.filter(n.a)}},function(e,t,r){"use strict";r.r(t);var n=r(115);r.d(t,"memoizeFunction",(function(){return n.a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lookUpString=t.stringExists=t.flattenStringMap=t.clearStringMapLoaders=t.setCurrentLocale=t.getCurrentLocale=t.addStringMapLoader=t.addStringMap=t.handleLocalizationError=t.setLocalizationErrorHandler=void 0;var n=r(2),i=r(56),o=r(150),a=r(152);t.setLocalizationErrorHandler=function(e,t){return n.__assign(n.__assign({},t),{errorHandler:e})},t.handleLocalizationError=function(e,t){t.errorHandler(e)};var s,c=o.memoizeFunction((function(e,t){var r=l(t);return function(t){return Promise.resolve(e===t?r:{})}}));function u(e,t){return-1===t.loaders.indexOf(e)?n.__assign(n.__assign({},t),{loaders:t.loaders.concat(e)}):t}function l(e){var t={};return e&&function e(r,n){for(var o=0,a=i.keys(n);o<a.length;o++){var s=a[o];if("string"==typeof s){var c=n[s];"string"==typeof c?t[r+s]=c:"object"==typeof c&&e(r+s+".",c)}}}("",e),t}t.addStringMap=function(e,t,r){if(r.currentLocale===e||void 0===r.currentLocale){var i=l(t);return n.__assign(n.__assign({},r),{currentLocale:void 0===r.currentLocale?e:r.currentLocale,strings:n.__assign(n.__assign({},r.strings),i),stringMapInitialized:!0})}return u(c(e,t),r)},t.addStringMapLoader=u,t.getCurrentLocale=function(e){return s?s.then((function(e){return e.currentLocale})):Promise.resolve(e.currentLocale)},t.setCurrentLocale=function(e,t){var r=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,i,o=this;return n.__generator(this,(function(a){switch(a.label){case 0:return r=function(r){return n.__awaiter(o,void 0,void 0,(function(){var i,o;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r(e)];case 1:return[2,n.sent()];case 2:return i=n.sent(),o=i.message||"unknown error",t.errorHandler("Async string map loader failed: "+o),[2,{}];case 3:return[2]}}))}))},i=t.loaders.map(r),[4,Promise.all(i)];case 1:return[2,a.sent().map(l).reduce((function(e,t){return n.__assign(n.__assign({},e),t)}),{})]}}))}))}(e,t).then((function(r){return n.__assign(n.__assign({},t),{strings:r,currentLocale:e,stringMapInitialized:!0})}));return s=s?s.then((function(){return r})):r},t.clearStringMapLoaders=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return s?[4,s]:[3,2];case 1:t.sent(),t.label=2;case 2:return s=void 0,[2,n.__assign(n.__assign({},e),{loaders:[],strings:{},currentLocale:void 0})]}}))}))},t.flattenStringMap=l,t.stringExists=function(e,t){return"string"==typeof t.strings[e]},t.lookUpString=function(e,t){var r=a.isDev()||a.isTest()?e:"";if(0===Object.keys(t.strings).length)return!t.suppressEmptyStringMapErrors&&t.errorHandler("The current string map is empty. The string is probably resolved too early, at import time. Key: "+e),r;var n=t.strings[e];return"string"!=typeof n?(t.errorHandler("Key "+e+" does not exist in string map",{stringsLoaded:!!t.stringMapInitialized}),r):n}},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.doPseudoLocalization=t.disableDevModeForLocalization=t.enableDevModeForLocalization=t.enablePseudoLocalization=t.disablePseudoLocalization=t.togglePseudoLocalization=t.isTest=t.isDevLocalization=t.skipLocalization=t.isDev=void 0;var r=!1;function n(){return!1}function i(){return"undefined"!=typeof __SKIP_LOC__&&__SKIP_LOC__}t.isDev=n,t.skipLocalization=i,t.isDevLocalization=function(){return i()},t.isTest=function(){return Boolean(void 0!==e&&Object({NODE_ENV:"production"})&&!1)},t.togglePseudoLocalization=function(){r=!r},t.disablePseudoLocalization=function(){r=!0},t.enablePseudoLocalization=function(){r=!1},t.enableDevModeForLocalization=function(){!1},t.disableDevModeForLocalization=function(){!0},t.doPseudoLocalization=function(){return!1}}).call(this,r(265))},function(e,t,r){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}r.r(t),r.d(t,"stringLiteralArray",(function(){return n}))},function(e,t,r){"use strict";function n(e){throw new Error(e)}r.r(t),r.d(t,"throwError",(function(){return n}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(156),i=r(33),o=r(111),a=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(n.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,r){if(!isNaN(r)&&null!==r&&r>=0&&r<=12)this._addContext("UserInfo.IdType",r.toString());else{var n=void 0;switch(t){case i.AWTPiiKind.SipAddress:n=o.AWTUserIdType.SipAddress;break;case i.AWTPiiKind.PhoneNumber:n=o.AWTUserIdType.PhoneNumber;break;case i.AWTPiiKind.SmtpAddress:n=o.AWTUserIdType.EmailAddress;break;default:n=o.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",n.toString())}if(isNaN(t)||null===t||t===i.AWTPiiKind.NotSet||t>13)switch(r){case o.AWTUserIdType.Skype:t=i.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=i.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=i.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=i.AWTPiiKind.SipAddress;break;default:t=i.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,r){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,r)},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(55),i="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",a="MSIE",s="Chrome",c="Firefox",u="Safari",l="Edge",f="Electron",d="SkypeShell",p="PhantomJS",h="Opera",v="Windows",g="Mac OS X",_="Windows Phone",y="Windows RT",b="iOS",m="Android",k="Linux",T="Chrome OS",S=/(windows|win32)/i,w=/ arm;/i,x=/windows\sphone\s\d+\.\d+/i,C=/(macintosh|mac os x)/i,O=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,E=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,P=/android/i,I=/CrOS/i,A={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},R=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,r){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),r||"undefined"==typeof navigator||(r=navigator.userAgent||""),this._autoCollectFromUserAgent(r),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(i),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(i),r=this._getData(o);t!==e&&(r=n.getISOString(new Date)),this._saveData(i,e),this._saveData(o,r),this._setFirstLaunchTime(r)}},e._autoCollectDeviceId=function(){var e=this._getData(i);e||(e=n.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this._semanticContext.setUserTimeZone(n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var r=this._getOsName(e);this._semanticContext.setDeviceOsName(r),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,r))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(p,e)?p:this._userAgentContainsString(l,e)||this._userAgentContainsString("Edg",e)?l:this._userAgentContainsString(f,e)?f:this._userAgentContainsString(s,e)?s:this._userAgentContainsString("Trident",e)?a:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(d,e)?d:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=n.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===a)return this._getIeVersion(e);if(t===l){var r=this._getOtherVersion(t,e);return"Unknown"===r?this._getOtherVersion("Edg",e):r}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(a+" ([\\d,.]+)"));if(t)return t[1];var r=e.match(new RegExp("rv:([\\d,.]+)"));return r?r[1]:void 0},e._getOtherVersion=function(e,t){e===u&&(e="Version");var r=t.match(new RegExp(e+"/([\\d,.]+)"));return r?r[1]:"Unknown"},e._getOsName=function(e){return e.match(x)?_:e.match(w)?y:e.match(O)?b:e.match(P)?m:e.match(E)?k:e.match(C)?g:e.match(S)?v:e.match(I)?T:"Unknown"},e._getOsVersion=function(e,t){return t===v?this._getGenericOsVersion(e,"Windows NT"):t===m?this._getGenericOsVersion(e,t):t===g?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var r=e.match(new RegExp(t+" ([\\d,.]+)"));return r?A[r[1]]?A[r[1]]:r[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(g+" ([\\d,_,.]+)"));if(t){var r=t[1].replace(/_/g,".");if(r){var n=this._getDelimiter(r);return n?r.split(n)[0]:r}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var r=new Date;r.setTime(r.getTime()+31536e6);var n="expires="+r.toUTCString();document.cookie=e+"="+t+"; "+n}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),r=0;r<t.length;r++){for(var n=t[r],i=0;" "===n.charAt(i);)i++;if(0===(n=n.substring(i)).indexOf(e))return n.substring(e.length,n.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=R},function(e,t,r){e.exports=r(214)},function(e,t,r){e.exports=r(253)},function(e,t,r){e.exports=r(274)},,,function(e,t,r){e.exports=!r(41)&&!r(53)((function(){return 7!=Object.defineProperty(r(131)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(54),i=r(74),o=r(205)(!1),a=r(135)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),c=0,u=[];for(r in s)r!=a&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~o(u,r)||u.push(r));return u}},function(e,t,r){var n=r(22).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(54),i=r(75),o=r(135)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(22),i=r(54),o=r(41),a=r(21),s=r(133),c=r(94).KEY,u=r(53),l=r(136),f=r(93),d=r(106),p=r(27),h=r(138),v=r(139),g=r(210),_=r(141),y=r(32),b=r(26),m=r(74),k=r(132),T=r(89),S=r(90),w=r(211),x=r(169),C=r(38),O=r(91),E=x.f,P=C.f,I=w.f,A=n.Symbol,R=n.JSON,j=R&&R.stringify,D=p("_hidden"),M=p("toPrimitive"),L={}.propertyIsEnumerable,F=l("symbol-registry"),B=l("symbols"),N=l("op-symbols"),W=Object.prototype,U="function"==typeof A,z=n.QObject,q=!z||!z.prototype||!z.prototype.findChild,Q=o&&u((function(){return 7!=S(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=E(W,t);n&&delete W[t],P(e,t,r),n&&e!==W&&P(W,t,n)}:P,G=function(e){var t=B[e]=S(A.prototype);return t._k=e,t},H=U&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},V=function(e,t,r){return e===W&&V(N,t,r),y(e),t=k(t,!0),y(r),i(B,t)?(r.enumerable?(i(e,D)&&e[D][t]&&(e[D][t]=!1),r=S(r,{enumerable:T(0,!1)})):(i(e,D)||P(e,D,T(1,{})),e[D][t]=!0),Q(e,t,r)):P(e,t,r)},K=function(e,t){y(e);for(var r,n=g(t=m(t)),i=0,o=n.length;o>i;)V(e,r=n[i++],t[r]);return e},Z=function(e){var t=L.call(this,e=k(e,!0));return!(this===W&&i(B,e)&&!i(N,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,D)&&this[D][e])||t)},J=function(e,t){if(e=m(e),t=k(t,!0),e!==W||!i(B,t)||i(N,t)){var r=E(e,t);return!r||!i(B,t)||i(e,D)&&e[D][t]||(r.enumerable=!0),r}},X=function(e){for(var t,r=I(m(e)),n=[],o=0;r.length>o;)i(B,t=r[o++])||t==D||t==c||n.push(t);return n},Y=function(e){for(var t,r=e===W,n=I(r?N:m(e)),o=[],a=0;n.length>a;)!i(B,t=n[a++])||r&&!i(W,t)||o.push(B[t]);return o};U||(s((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===W&&t.call(N,r),i(this,D)&&i(this[D],e)&&(this[D][e]=!1),Q(this,e,T(1,r))};return o&&q&&Q(W,e,{configurable:!0,set:t}),G(e)}).prototype,"toString",(function(){return this._k})),x.f=J,C.f=V,r(168).f=w.f=X,r(107).f=Z,r(140).f=Y,o&&!r(88)&&s(W,"propertyIsEnumerable",Z,!0),h.f=function(e){return G(p(e))}),a(a.G+a.W+a.F*!U,{Symbol:A});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;$.length>ee;)p($[ee++]);for(var te=O(p.store),re=0;te.length>re;)v(te[re++]);a(a.S+a.F*!U,"Symbol",{for:function(e){return i(F,e+="")?F[e]:F[e]=A(e)},keyFor:function(e){if(!H(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),a(a.S+a.F*!U,"Object",{create:function(e,t){return void 0===t?S(e):K(S(e),t)},defineProperty:V,defineProperties:K,getOwnPropertyDescriptor:J,getOwnPropertyNames:X,getOwnPropertySymbols:Y}),R&&a(a.S+a.F*(!U||u((function(){var e=A();return"[null]"!=j([e])||"{}"!=j({a:e})||"{}"!=j(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(b(t)||void 0!==e)&&!H(e))return _(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!H(t))return t}),n[1]=t,j.apply(R,n)}}),A.prototype[M]||r(52)(A.prototype,M,A.prototype.valueOf),f(A,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},function(e,t,r){var n=r(163),i=r(137).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(107),i=r(89),o=r(74),a=r(132),s=r(54),c=r(162),u=Object.getOwnPropertyDescriptor;t.f=r(41)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(21),i=r(11),o=r(53);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o((function(){r(1)})),"Object",a)}},function(e,t,r){"use strict";var n=r(38).f,i=r(90),o=r(108),a=r(48),s=r(109),c=r(76),u=r(130),l=r(166),f=r(174),d=r(41),p=r(94).fastKey,h=r(77),v=d?"_s":"size",g=function(e,t){var r,n=p(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,u){var l=e((function(e,n){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,null!=n&&c(n,r,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=h(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var r=h(this,t),n=g(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[v]--}return!!n},forEach:function(e){h(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(h(this,t),e)}}),d&&n(l.prototype,"size",{get:function(){return h(this,t)[v]}}),l},def:function(e,t,r){var n,i,o=g(e,t);return o?o.v=r:(e._l=o={i:i=p(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:g,setStrong:function(e,t,r){u(e,t,(function(e,r){this._t=h(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))}),r?"entries":"values",!r,!0),f(t)}}},function(e,t,r){var n=r(32);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(73),i=r(27)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){"use strict";var n=r(22),i=r(11),o=r(38),a=r(41),s=r(27)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(110),i=r(226);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(27)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},function(e,t,r){var n=r(32),i=r(68),o=r(27)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[o])?t:i(r)}},function(e,t,r){var n,i,o,a=r(48),s=r(176),c=r(164),u=r(131),l=r(22),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,v=l.Dispatch,g=0,_={},y=function(){var e=+this;if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},b=function(e){y.call(e.data)};d&&p||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return _[++g]=function(){s("function"==typeof e?e:Function(e),t)},n(g),g},p=function(e){delete _[e]},"process"==r(92)(f)?n=function(e){f.nextTick(a(y,e,1))}:v&&v.now?n=function(e){v.now(a(y,e,1))}:h?(o=(i=new h).port2,i.port1.onmessage=b,n=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(n=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):n="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:d,clear:p}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(32),i=r(26),o=r(147);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var n=r(91),i=r(140),o=r(107),a=r(75),s=r(134),c=Object.assign;e.exports=!c||r(53)((function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n}))?function(e,t){for(var r=a(e),c=arguments.length,u=1,l=i.f,f=o.f;c>u;)for(var d,p=s(arguments[u++]),h=l?n(p).concat(l(p)):n(p),v=h.length,g=0;v>g;)f.call(p,d=h[g++])&&(r[d]=p[d]);return r}:c},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3);function i(e){return Object(n.a)(e)}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t(n))return n}}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lookupStringInDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.setLocalizationErrorHandlerForDefaultStringProvider=t.getDefaultStringProvider=void 0;var n=r(2),i=r(151),o={currentLocale:void 0,strings:{},errorHandler:function(e){},loaders:[],stringMapInitialized:!1};function a(){return o}t.getDefaultStringProvider=a,t.setLocalizationErrorHandlerForDefaultStringProvider=function(e){o=i.setLocalizationErrorHandler(e,o)},t.addStringMapForDefaultStringProvider=function(e,t){o=i.addStringMap(e,t,o)},t.addStringMapLoaderForDefaultStringProvider=function(e){o=i.addStringMapLoader(e,o)},t.getCurrentLocaleForDefaultStringProvider=function(){return i.getCurrentLocale(a())},t.setCurrentLocaleForDefaultStringProvider=function(e){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,i.setCurrentLocale(e,o)];case 1:return[2,(o=t.sent()).currentLocale]}}))}))},t.clearStringMapLoadersForDefaultStringProvider=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,i.clearStringMapLoaders(a())];case 1:return o=e.sent(),[2]}}))}))},t.lookupStringInDefaultStringProvider=function(e){return i.lookUpString(e,a())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithOnlyKey=void 0;var n=r(2),i=r(8),o=r(149),a=r(154);function s(e){return(e=i.upperFirst(e.trim()))&&!i.endsWith(e,".")&&(e+="."),e}t.getStringDescriptionWithOnlyKey=function(e){return{key:e,stringToBeLocalized:"",comment:"",placeholderNames:[]}},t.getStringDescriptionWithoutPlaceholders=function(e,t){return{key:e,stringToBeLocalized:t.text,comment:t.comment,placeholderNames:[]}},t.getStringDescriptionWithPlaceholders=function(e,t){for(var r=i.keys(t.placeholders).filter(i.isString).sort(),c={},u=0,l=i.keys(t.placeholders);u<l.length;u++){var f=l[u];c[f]=i.isString(f)?"{"+r.indexOf(f)+"}":a.throwError("Placeholder name "+f+" is not a string")}var d=t.text(c),p=n.__spreadArrays([t.comment],r.map((function(e,r){var n=t.placeholders[e].trim();return n?"{"+r+"} is a placeholder for "+i.lowerFirst(n):null}))),h=o.filterOutNull(p).map(s).filter(Boolean).join(" ");return r.forEach((function(e,t){h=h.replace("{"+e+"}","{"+t+"}")})),{key:e,stringToBeLocalized:d,comment:h,placeholderNames:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.isSupportedLocale=t.supportedLocales=void 0;var n=r(153).stringLiteralArray("af","am","ar","as-in","az-latn-az","be-by","bg","bn-in","bn-bd","bs-latn-ba","ca","ca-es-valencia","cs","cy","da","de","el","en-gb","en-us","es","es-mx","et","eu","fa","fi","fil","fr","fr-ca","ga-ie","gd-gb","gl","gu","ha-latn-ng","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","ky","lb-lu","lo-la","lt","lv","mi-nz","mk","ml","mn-mn","mr","ms","mt-mt","ne-np","nl","nn-no","no","or","pa-in","pl","prs","pt","pt-pt","quz-pe","ro","ru","sd-arab-pk","si-lk","sk","sl","sq","sr","sr-cyrl","sr-cyrl-ba","sv","sw","ta","te","th","tk-tm","tr","tt","ug-cn","uk","ur","uz","vi","zh-hans","zh-hant","zu-za");n[0];function i(e){return t.supportedLocales.indexOf(e)>=0}function o(e){if(0===e.indexOf("es-")&&"es-es"!==e)return"es-mx";if(0===e.indexOf("en-")&&"en-us"!==e)return"en-gb";switch(e){case"zh-hk":case"zh-mo":return"zh-hant";case"zh-rcn":return"zh-hans";case"zh-rhk":case"zh-rtw":case"zh-sg":case"zh-tw":return"zh-hant";case"be":return"nl";case"ga":return"ga-ie";case"in":return"id";case"iw":return"he";case"nb":return"no";default:return}}t.supportedLocales=n,t.isSupportedLocale=i,t.toSupportedLocale=function(e,r){if(e){var n=e.toLowerCase().replace("_","-"),a=o(n);if(a)return a;if(i(n))return n;var s=n.split("-");if(s.length>2){var c=s.slice(0,s.length-1).join("-");if(i(c))return c;var u=o(c);if(u)return u}var l=n.substr(0,2);if(i(l))return l;var f=o(l);if(f)return f;for(var d=0,p=t.supportedLocales;d<p.length;d++){var h=p[d];if(0===h.indexOf(l))return h}}if(r)return r;throw new Error(e+" cannot be mapped to a supported locale")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=r(111),o=r(112),a=r(55),s=r(190),c=r(78),u=r(97),l=r(194),f=r(192),d=r(155),p=r(156),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new d.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,r){void 0===r&&(r=n.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,r)},e.prototype.setContextWithPii=function(e,t,r,i){void 0===i&&(i=n.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,r,i)},e.prototype.setContextWithCustomerContent=function(e,t,r,i){void 0===i&&(i=n.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,r,i)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var r=!0;a.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),r=!1),s.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,r),this._contextProperties)}},e.prototype.logSession=function(t,r){if(l.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,r),o.priority=n.AWTEventPriority.High,t===i.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=a.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==i.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=s.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(s),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=p.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,r,i,o,a){if(t&&r){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,a),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=r,i&&(s.properties["Failure.Category"]=i),o&&(s.properties["Failure.Id"]=o),s.priority=n.AWTEventPriority.High,this.logEvent(s)}},e.prototype.logPageView=function(t,r,n,i,o,a){if(t&&r){var s={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(s,a),s.properties["PageView.Id"]=t,s.properties["PageView.Name"]=r,n&&(s.properties["PageView.Category"]=n),i&&(s.properties["PageView.Uri"]=i),o&&(s.properties["PageView.ReferrerUri"]=o),this.logEvent(s)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=a.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var r in t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(r)&&(e.properties[r]=t.properties[r])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&a.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(a.EventNameDotRegex,"_"),e.type&&a.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",a.EventNameAndTypeRegex.test(e.name)&&a.EventNameAndTypeRegex.test(e.type)?((!a.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",f.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),a.isPriority(e.priority)||(e.priority=n.AWTEventPriority.Normal),this._sendEvent(e)):c.default.eventsRejected([e],n.AWTEventsRejectedReason.InvalidEvent)):c.default.eventsRejected([e],n.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e.properties[r]||(e.properties[r]=t[r]))},e._setDefaultProperty=function(e,t,r){e.properties[t]={value:r,pii:n.AWTPiiKind.NotSet,type:n.AWTPropertyType.String}},e._sendEvent=function(e){u.default.sendEvent(e)},e._getInternalEvent=function(e,t,r){if(e.properties=e.properties||{},r)for(var n in e.properties)e.properties.hasOwnProperty(n)&&(e.properties[n]=a.sanitizeProperty(n,e.properties[n]),null===e.properties[n]&&delete e.properties[n]);var i=e;return i.id=a.newGuid(),i.apiKey=t,i},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(55),i=r(78),o=r(33),a=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,i.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,r){switch(r){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,r){switch(r){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,r){if(this._isInitalized&&r!==n.StatsApiKey){var i=n.getTenantId(r);this._stats[i]||(this._stats[i]={}),this._stats[i][e]?this._stats[i][e]=this._stats[i][e]+t:this._stats[i][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(278),i=r(33),o=r(78),a=r(55),s=function(){function e(){}return e.getPayloadBlob=function(e,t){var r,s=!1,c=new n.IO.MemoryStream,u=new n.CompactBinaryProtocolWriter(c);for(var l in u._WriteFieldBegin(n._BondDataType._BT_MAP,3,null),u._WriteMapContainerBegin(t,n._BondDataType._BT_STRING,n._BondDataType._BT_LIST),e)if(s)r||(r={}),r[l]=e[l],delete e[l];else if(e.hasOwnProperty(l)){u._WriteString(l);var f=e[l];u._WriteContainerBegin(1,n._BondDataType._BT_STRUCT),u._WriteFieldBegin(n._BondDataType._BT_STRING,2,null),u._WriteString("act_default_source"),u._WriteFieldBegin(n._BondDataType._BT_STRING,5,null),u._WriteString(a.newGuid()),u._WriteFieldBegin(n._BondDataType._BT_INT64,6,null),u._WriteInt64(a.numberToBondInt64(Date.now())),u._WriteFieldBegin(n._BondDataType._BT_LIST,8,null);var d=c._GetBuffer().length+1;u._WriteContainerBegin(e[l].length,n._BondDataType._BT_STRUCT);for(var p=c._GetBuffer().length-d,h=0;h<f.length;++h){var v=c._GetBuffer().length;if(this.writeEvent(f[h],u),c._GetBuffer().length-v>2936012)o.default.eventsRejected([f[h]],i.AWTEventsRejectedReason.SizeLimitExceeded),f.splice(h--,1),c._GetBuffer().splice(v),this._addNewDataPackageSize(f.length,c,p,d);else if(c._GetBuffer().length>2936012){c._GetBuffer().splice(v),r||(r={}),e[l]=f.splice(0,h),r[l]=f,this._addNewDataPackageSize(e[l].length,c,p,d),s=!0;break}}u._WriteStructEnd(!1)}return u._WriteStructEnd(!1),{payloadBlob:c._GetBuffer(),remainingRequest:r}},e._addNewDataPackageSize=function(e,t,r,i){for(var o=n._Encoding._Varint_GetBytes(n.Number._ToUInt32(e)),a=0;a<r;++a){if(!(a<o.length)){t._GetBuffer().slice(i+a,r-a);break}t._GetBuffer()[i+a]=o[a]}},e.writeEvent=function(e,t){t._WriteFieldBegin(n._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(n._BondDataType._BT_INT64,3,null),t._WriteInt64(a.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(n._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(n._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var r={},o=0,s={},c=0,u={},l=0,f={},d=0,p={},h=0,v={},g=0,_={},y=0;for(var b in e.properties){if(e.properties.hasOwnProperty(b))if((k=e.properties[b]).cc>0)_[b]=k,y++;else if(k.pii>0)v[b]=k,g++;else switch(k.type){case i.AWTPropertyType.String:r[b]=k.value,o++;break;case i.AWTPropertyType.Int64:s[b]=k.value,c++;break;case i.AWTPropertyType.Double:u[b]=k.value,l++;break;case i.AWTPropertyType.Boolean:f[b]=k.value,d++;break;case i.AWTPropertyType.Date:p[b]=k.value,h++}}if(o)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,n._BondDataType._BT_STRING,n._BondDataType._BT_STRING),r)if(r.hasOwnProperty(b)){var m=r[b];t._WriteString(b),t._WriteString(m.toString())}if(g)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(g,n._BondDataType._BT_STRING,n._BondDataType._BT_STRUCT),v)if(v.hasOwnProperty(b)){var k=v[b];t._WriteString(b),t._WriteFieldBegin(n._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(n._BondDataType._BT_INT32,2,null),t._WriteInt32(k.pii),t._WriteFieldBegin(n._BondDataType._BT_STRING,3,null),t._WriteString(k.value.toString()),t._WriteStructEnd(!1)}if(d)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(d,n._BondDataType._BT_STRING,n._BondDataType._BT_BOOL),f)if(f.hasOwnProperty(b)){m=f[b];t._WriteString(b),t._WriteBool(m)}if(h)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,n._BondDataType._BT_STRING,n._BondDataType._BT_INT64),p)if(p.hasOwnProperty(b)){m=p[b];t._WriteString(b),t._WriteInt64(a.numberToBondInt64(m))}if(c)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(c,n._BondDataType._BT_STRING,n._BondDataType._BT_INT64),s)if(s.hasOwnProperty(b)){m=s[b];t._WriteString(b),t._WriteInt64(a.numberToBondInt64(m))}if(l)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,n._BondDataType._BT_STRING,n._BondDataType._BT_DOUBLE),u)if(u.hasOwnProperty(b)){m=u[b];t._WriteString(b),t._WriteDouble(m)}if(y)for(var b in t._WriteFieldBegin(n._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(y,n._BondDataType._BT_STRING,n._BondDataType._BT_STRUCT),_)if(_.hasOwnProperty(b)){k=_[b];t._WriteString(b),t._WriteFieldBegin(n._BondDataType._BT_INT32,1,null),t._WriteInt32(k.cc),t._WriteFieldBegin(n._BondDataType._BT_STRING,2,null),t._WriteString(k.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return n._Encoding._Base64_GetString(e)},e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.6",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=r(111),o=r(194),a=r(189),s=r(97),c=r(78),u=r(156),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),u.default.addPropertyStorageOverride(this._config.propertyStorageOverride),u.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),s.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(i.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&s.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(i.AWTSessionState.Ended),s.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&s.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&s.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&s.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&s.default.loadTransmitProfiles(e)},e.setContext=function(e,t,r){void 0===r&&(r=n.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,r)},e.setContextWithPii=function(e,t,r,i){void 0===i&&(i=n.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,r,i)},e.setContextWithCustomerContent=function(e,t,r,i){void 0===i&&(i=n.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,r,i)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new a.default(t)),this._loggers[t]},e.addNotificationListener=function(e){c.default.addNotificationListener(e)},e.removeNotificationListener=function(e){c.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(112),i=r(155),o=function(){function e(){}return e.logManagerContext=new n.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new i.default(!0,e.logManagerContext),e}();t.default=o},function(e,t,r){e.exports=r(236)},function(e,t,r){e.exports=r(239)},function(e,t,r){"use strict";t.a=function(){return!1}},function(e,t,r){e.exports=r(268)},,,function(e,t,r){r(67),r(69),e.exports=r(138).f("iterator")},function(e,t,r){var n=r(128),i=r(129);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),c=n(r),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t,r){"use strict";var n=r(90),i=r(89),o=r(93),a={};r(52)(a,r(27)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){var n=r(38),i=r(32),o=r(91);e.exports=r(41)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,c=0;s>c;)n.f(e,r=a[c++],t[r]);return e}},function(e,t,r){var n=r(74),i=r(105),o=r(206);e.exports=function(e){return function(t,r,a){var s,c=n(t),u=i(c.length),l=o(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}}},function(e,t,r){var n=r(128),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t,r){"use strict";var n=r(208),i=r(166),o=r(73),a=r(74);e.exports=r(130)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t,r){r(167),r(95),r(212),r(213),e.exports=r(11).Symbol},function(e,t,r){var n=r(91),i=r(140),o=r(107);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,r){var n=r(74),i=r(168).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(n(e))}},function(e,t,r){r(139)("asyncIterator")},function(e,t,r){r(139)("observable")},function(e,t,r){r(215),e.exports=r(11).Object.getPrototypeOf},function(e,t,r){var n=r(75),i=r(165);r(170)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},function(e,t,r){r(217),e.exports=r(11).Object.setPrototypeOf},function(e,t,r){var n=r(21);n(n.S,"Object",{setPrototypeOf:r(218).set})},function(e,t,r){var n=r(26),i=r(32),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(48)(Function.call,r(169).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},function(e,t,r){r(220);var n=r(11).Object;e.exports=function(e,t){return n.create(e,t)}},function(e,t,r){var n=r(21);n(n.S,"Object",{create:r(90)})},function(e,t,r){r(95),r(67),r(69),r(222),r(225),r(227),r(228),e.exports=r(11).Map},function(e,t,r){"use strict";var n=r(171),i=r(77);e.exports=r(143)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(i(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,r){var n=r(224);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){var n=r(26),i=r(141),o=r(27)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){var n=r(21);n(n.P+n.R,"Map",{toJSON:r(175)("Map")})},function(e,t,r){var n=r(76);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t,r){r(145)("Map")},function(e,t,r){r(146)("Map")},function(e,t,r){r(230),e.exports=r(11).Reflect.construct},function(e,t,r){var n=r(21),i=r(90),o=r(68),a=r(32),s=r(26),c=r(53),u=r(231),l=(r(22).Reflect||{}).construct,f=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),d=!c((function(){l((function(){}))}));n(n.S+n.F*(f||d),"Reflect",{construct:function(e,t){o(e),a(t);var r=arguments.length<3?e:o(arguments[2]);if(d&&!f)return l(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}var c=r.prototype,p=i(s(c)?c:Object.prototype),h=Function.apply.call(e,p,t);return s(h)?h:p}})},function(e,t,r){"use strict";var n=r(68),i=r(26),o=r(176),a=[].slice,s={},c=function(e,t,r){if(!(t in s)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,r)};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),s=function(){var n=r.concat(a.call(arguments));return this instanceof s?c(t,n.length,n):o(t,n,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t,r){r(233);var n=r(11).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(21);n(n.S+n.F*!r(41),"Object",{defineProperty:r(38).f})},function(e,t,r){r(235),e.exports=r(11).Array.isArray},function(e,t,r){var n=r(21);n(n.S,"Array",{isArray:r(141)})},function(e,t,r){r(67),r(237),e.exports=r(11).Array.from},function(e,t,r){"use strict";var n=r(48),i=r(21),o=r(75),a=r(172),s=r(173),c=r(105),u=r(238),l=r(142);i(i.S+i.F*!r(177)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,f,d=o(e),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,g=void 0!==v,_=0,y=l(d);if(g&&(v=n(v,h>2?arguments[2]:void 0,2)),null==y||p==Array&&s(y))for(r=new p(t=c(d.length));t>_;_++)u(r,_,g?v(d[_],_):d[_]);else for(f=y.call(d),r=new p;!(i=f.next()).done;_++)u(r,_,g?a(f,v,[i.value,_],!0):i.value);return r.length=_,r}})},function(e,t,r){"use strict";var n=r(38),i=r(89);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},function(e,t,r){r(69),r(67),e.exports=r(240)},function(e,t,r){var n=r(110),i=r(27)("iterator"),o=r(73);e.exports=r(11).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||o.hasOwnProperty(n(t))}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),a=new S(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=m(a,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,a),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function f(){}function d(){}function p(){}var h={};h[i]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(w([])));g&&g!==t&&r.call(g,i)&&(h=g);var _=p.prototype=f.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(i,o){function a(){return new t((function(n,a){!function n(i,o,a,s){var c=u(e[i],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(i,o,n,a)}))}return n=n?n.then(a,a):a()}}function m(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,m(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function w(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return d.prototype=_.constructor=p,p.constructor=d,d.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(b.prototype),b.prototype[o]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new b(c(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),s(_,a,"Generator"),_[i]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=w,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:w(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){r(95),r(67),r(69),r(243),r(246),r(247),e.exports=r(11).Promise},function(e,t,r){"use strict";var n,i,o,a,s=r(88),c=r(22),u=r(48),l=r(110),f=r(21),d=r(26),p=r(68),h=r(109),v=r(76),g=r(178),_=r(179).set,y=r(244)(),b=r(147),m=r(180),k=r(245),T=r(181),S=c.TypeError,w=c.process,x=w&&w.versions,C=x&&x.v8||"",O=c.Promise,E="process"==l(w),P=function(){},I=i=b.f,A=!!function(){try{var e=O.resolve(1),t=(e.constructor={})[r(27)("species")]=function(e){e(P,P)};return(E||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t&&0!==C.indexOf("6.6")&&-1===k.indexOf("Chrome/66")}catch(e){}}(),R=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},j=function(e,t){if(!e._n){e._n=!0;var r=e._c;y((function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&L(e),e._h=1),!0===s?r=n:(l&&l.enter(),r=s(n),l&&(l.exit(),a=!0)),r===t.promise?u(S("Promise-chain cycle")):(o=R(r))?o.call(r,c,u):c(r)):u(n)}catch(e){l&&!a&&l.exit(),u(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){_.call(c,(function(){var t,r,n,i=e._v,o=M(e);if(o&&(t=m((function(){E?w.emit("unhandledRejection",i,e):(r=c.onunhandledrejection)?r({promise:e,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=E||M(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},M=function(e){return 1!==e._h&&0===(e._a||e._c).length},L=function(e){_.call(c,(function(){var t;E?w.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),j(t,!0))},B=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw S("Promise can't be resolved itself");(t=R(e))?y((function(){var n={_w:r,_d:!1};try{t.call(e,u(B,n,1),u(F,n,1))}catch(e){F.call(n,e)}})):(r._v=e,r._s=1,j(r,!1))}catch(e){F.call({_w:r,_d:!1},e)}}};A||(O=function(e){h(this,O,"Promise","_h"),p(e),n.call(this);try{e(u(B,this,1),u(F,this,1))}catch(e){F.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(108)(O.prototype,{then:function(e,t){var r=I(g(this,O));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=E?w.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&j(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=u(B,e,1),this.reject=u(F,e,1)},b.f=I=function(e){return e===O||e===a?new o(e):i(e)}),f(f.G+f.W+f.F*!A,{Promise:O}),r(93)(O,"Promise"),r(174)("Promise"),a=r(11).Promise,f(f.S+f.F*!A,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!A),"Promise",{resolve:function(e){return T(s&&this===a?O:this,e)}}),f(f.S+f.F*!(A&&r(177)((function(e){O.all(e).catch(P)}))),"Promise",{all:function(e){var t=this,r=I(t),n=r.resolve,i=r.reject,o=m((function(){var r=[],o=0,a=1;v(e,!1,(function(e){var s=o++,c=!1;r.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,r[s]=e,--a||n(r))}),i)})),--a||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=I(t),n=r.reject,i=m((function(){v(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},function(e,t,r){var n=r(22),i=r(179).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c="process"==r(92)(a);e.exports=function(){var e,t,r,u=function(){var n,i;for(c&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){a.nextTick(u)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);r=function(){l.then(u)}}else r=function(){i.call(n,u)};else{var f=!0,d=document.createTextNode("");new o(u).observe(d,{characterData:!0}),r=function(){d.data=f=!f}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){var n=r(22).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){"use strict";var n=r(21),i=r(11),o=r(22),a=r(178),s=r(181);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then((function(){return r}))}:e,r?function(r){return s(t,e()).then((function(){throw r}))}:e)}})},function(e,t,r){"use strict";var n=r(21),i=r(147),o=r(180);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){r(69),r(67),e.exports=r(250)},function(e,t,r){var n=r(32),i=r(142);e.exports=r(11).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},function(e,t,r){r(252),e.exports=r(11).Object.keys},function(e,t,r){var n=r(75),i=r(91);r(170)("keys",(function(){return function(e){return i(n(e))}}))},function(e,t,r){r(95),r(69),r(254),r(256),r(257),e.exports=r(11).WeakMap},function(e,t,r){"use strict";var n,i=r(22),o=r(144)(0),a=r(133),s=r(94),c=r(182),u=r(255),l=r(26),f=r(77),d=r(77),p=!i.ActiveXObject&&"ActiveXObject"in i,h=s.getWeak,v=Object.isExtensible,g=u.ufstore,_=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(l(e)){var t=h(e);return!0===t?g(f(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(f(this,"WeakMap"),e,t)}},b=e.exports=r(143)("WeakMap",_,y,u,!0,!0);d&&p&&(c((n=u.getConstructor(_,"WeakMap")).prototype,y),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=b.prototype,r=t[e];a(t,e,(function(t,i){if(l(t)&&!v(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)}))})))},function(e,t,r){"use strict";var n=r(108),i=r(94).getWeak,o=r(32),a=r(26),s=r(109),c=r(76),u=r(144),l=r(54),f=r(77),d=u(5),p=u(6),h=0,v=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},_=function(e,t){return d(e.a,(function(e){return e[0]===t}))};g.prototype={get:function(e){var t=_(this,e);if(t)return t[1]},has:function(e){return!!_(this,e)},set:function(e,t){var r=_(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var u=e((function(e,n){s(e,u,t,"_i"),e._t=t,e._i=h++,e._l=void 0,null!=n&&c(n,r,e[o],e)}));return n(u.prototype,{delete:function(e){if(!a(e))return!1;var r=i(e);return!0===r?v(f(this,t)).delete(e):r&&l(r,this._i)&&delete r[this._i]},has:function(e){if(!a(e))return!1;var r=i(e);return!0===r?v(f(this,t)).has(e):r&&l(r,this._i)}}),u},def:function(e,t,r){var n=i(o(t),!0);return!0===n?v(e).set(t,r):n[e._i]=r,e},ufstore:v}},function(e,t,r){r(145)("WeakMap")},function(e,t,r){r(146)("WeakMap")},function(e,t,r){r(259),e.exports=r(11).Object.assign},function(e,t,r){var n=r(21);n(n.S+n.F,"Object",{assign:r(182)})},function(e,t,r){var n=r(11),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,r){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,c=a(e),u=1;u<arguments.length;u++){for(var l in r=Object(arguments[u]))i.call(r,l)&&(c[l]=r[l]);if(n){s=n(r);for(var f=0;f<s.length;f++)o.call(r,s[f])&&(c[s[f]]=r[s[f]])}}return c}},function(e,t,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function a(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=o(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=i.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=a(r[0]);n!==r[0]&&(t[r[0]]=n)}r=i.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),s=0;s<o.length;s++){var c=o[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.declareStringWithPlaceholders=t.declareString=t.lookupStringInStringProvider=void 0;var n=r(56),i=r(150),o=r(185),a=r(152),s=r(186),c=r(266),u=r(151),l=/\\{\\d+\\}/g,f=i.memoizeFunction((function(e){return new RegExp("\\{"+e+"\\}","g")}));function d(e,t,r){try{return a.isDevLocalization()&&t?a.doPseudoLocalization()?function(e){var t={},r={};(e.match(/({.+?})/g)||[]).forEach((function(e,n){var i="0.7059175321136157_"+n;t[e]=i,r[i]=e}));var n=Object.keys(t).reduce((function(e,r){return e.replace(r,t[r])}),v(e)),i=c.pseudoLocalize(n);return Object.keys(r).reduce((function(e,t){return e.replace(t,r[t])}),g(i))}(t.text):t.text:!u.stringExists(e,r)&&t?t.text:u.lookUpString(e,r)}catch(e){return u.handleLocalizationError(e,r),""}}var p=function(e,t){return function(r){try{return e(r)}catch(e){return u.handleLocalizationError(e,t),""}}};function h(e,t,r){try{return a.isDevLocalization()&&t&&t.text?p((function(e){return a.doPseudoLocalization()?function(e,t){var r={},i={};n.keys(t).forEach((function(e,n){var o="0.7059175321136157_"+n;r[e]=o,i[o]=t[e]}));var o=c.pseudoLocalize(v(e.text(r)));return n.keys(i).reduce((function(e,t){return e.replace(t,i[t])}),g(o))}(t,e):t.text(e)}),r):!u.stringExists(e,r)&&t&&t.text?p(t.text,r):p((function(t){return n.keys(t).sort().reduce((function(e,r,n){var i=t[r],o=("string"==typeof i&&i||i&&i.toString&&i.toString()||"").replace(l,"");return(e||"").replace(f(n),o)}),u.lookUpString(e,r))}),r)}catch(e){return u.handleLocalizationError(e,r),function(){return""}}}t.lookupStringInStringProvider=function(e){return function(t){return function(r){return r?h(t,void 0,e)(r):d(t,void 0,e)}}},t.declareString=function(e,t){var r=function(r){return void 0===r&&(r=o.getDefaultStringProvider()),d(e,t,r)};return r.toString=r,r.key=e,r},t.declareStringWithPlaceholders=function(e,t){var r=function(r,n){return void 0===n&&(n=o.getDefaultStringProvider()),h(e,t,n)(r)};return r.toString=function(r){return void 0===r&&(r=o.getDefaultStringProvider()),a.isDevLocalization()&&t||!u.stringExists(e,r)&&t?s.getStringDescriptionWithPlaceholders(e,t).stringToBeLocalized:u.lookUpString(e,r)},r.key=e,r};function v(e){return e.replace(new RegExp("->INF::","g"),"0.7059175321136157_-1")}function g(e){return e.replace(new RegExp("0.7059175321136157_-1","g"),"->INF::")}},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalize=void 0;var n={a:"ȧ",A:"Ȧ",b:"ƀ",B:"Ɓ",c:"ƈ",C:"Ƈ",d:"ḓ",D:"Ḓ",e:"ḗ",E:"Ḗ",f:"ƒ",F:"Ƒ",g:"ɠ",G:"Ɠ",h:"ħ",H:"Ħ",i:"ī",I:"Ī",j:"ĵ",J:"Ĵ",k:"ķ",K:"Ķ",l:"ŀ",L:"Ŀ",m:"ḿ",M:"Ḿ",n:"ƞ",N:"Ƞ",o:"ǿ",O:"Ǿ",p:"ƥ",P:"Ƥ",q:"ɋ",Q:"Ɋ",r:"ř",R:"Ř",s:"ş",S:"Ş",t:"ŧ",T:"Ŧ",v:"ṽ",V:"Ṽ",u:"ŭ",U:"Ŭ",w:"ẇ",W:"Ẇ",x:"ẋ",X:"Ẋ",y:"ẏ",Y:"Ẏ",z:"ẑ",Z:"Ẑ"};t.pseudoLocalize=function(e){return e.split("").reduce((function(e,t){var r=n[t]||t;return e+(r+(function(e){return"aeiou".indexOf(e.toLowerCase())>=0}(t)?r:""))}),"")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetStringMapLoader=void 0;var n=r(187);t.makeGetStringMapLoader=function(e){return function(t){var r=function(t){return e(n.toSupportedLocale(t,"en-us"))};return t?e(n.toSupportedLocale(t,"en-us")).catch((function(){})).then((function(){return r})):Promise.resolve(r)}}},function(e,t,r){r(95),r(67),r(69),r(269),r(270),r(271),r(272),e.exports=r(11).Set},function(e,t,r){"use strict";var n=r(171),i=r(77);e.exports=r(143)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){var n=r(21);n(n.P+n.R,"Set",{toJSON:r(175)("Set")})},function(e,t,r){r(145)("Set")},function(e,t,r){r(146)("Set")},function(e,t,r){r(167),e.exports=r(11).Object.getOwnPropertySymbols},function(e,t,r){r(275),e.exports=r(11).Date.now},function(e,t,r){var n=r(21);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=r(277),o=r(97),a=r(287),s=r(78),c=r(55),u=function(){function e(e,t,r,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[n.AWTEventPriority.High]=[],this._inboundQueues[n.AWTEventPriority.Normal]=[],this._inboundQueues[n.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new a.default(this._outboundQueue,500),this._httpManager=new i.default(this._outboundQueue,e,this,r,o)}return e.prototype.addEvent=function(e){c.isPriority(e.priority)||(e.priority=n.AWTEventPriority.Normal),e.priority===n.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):s.default.eventsDropped([e],n.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[n.AWTEventPriority.High][0].length>0||this._inboundQueues[n.AWTEventPriority.Normal][0].length>0||this._inboundQueues[n.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var r=0;r<e[t].length;++r)e[t][r].sendAttempt<6?this.addEvent(e[t][r]):s.default.eventsDropped([e[t][r]],n.AWTEventsDroppedReason.MaxRetryLimit);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(n.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[n.AWTEventPriority.High][0].length+this._inboundQueues[n.AWTEventPriority.Normal][0].length+this._inboundQueues[n.AWTEventPriority.Low][0].length,this._inboundQueues[n.AWTEventPriority.High][0]=[],this._inboundQueues[n.AWTEventPriority.Normal][0]=[],this._inboundQueues[n.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[n.AWTEventPriority.High].shift(),this._inboundQueues[n.AWTEventPriority.Normal].shift(),this._inboundQueues[n.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[n.AWTEventPriority.High].push([]),this._inboundQueues[n.AWTEventPriority.Normal].push([]),this._inboundQueues[n.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=n.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return s.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],n.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=n.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var r=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(r)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(n.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=r(191),o=r(284),a=r(285),s=r(286),c=r(192),u=r(55),l=r(78),f=r(97),d=function(){function e(e,t,r,n,i){var o=this;this._requestQueue=e,this._queueManager=r,this._httpInterface=n,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+c.FullVersionString,this._killSwitch=new a.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new s.default(i),u.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!u.isReactNative(),this._httpInterface={sendPOST:function(e,t,r,n,i,a){try{if(u.useFetchRequest())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,r){t[r]=e})),i(e.status,t)})).catch((function(e){n(0,{})}));else if(u.useXDomainRequest()){var s=new XDomainRequest;s.open("POST",e),s.onload=function(){i(200,null)},s.onerror=function(){n(400,null)},s.ontimeout=function(){r(500,null)},s.send(t)}else{var c=new XMLHttpRequest;c.open("POST",e,!a),c.onload=function(){i(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.onerror=function(){n(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.ontimeout=function(){r(c.status,o._convertAllHeadersToMap(c.getAllResponseHeaders()))},c.send(t)}}catch(e){n(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&f.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=n.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,r,o){var a=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var s=0,c="";for(var f in e)e.hasOwnProperty(f)&&(this._killSwitch.isTenantKilled(f)?(l.default.eventsRejected(e[f],n.AWTEventsRejectedReason.KillSwitch),delete e[f]):(c.length>0&&(c+=","),c+=f,s++));if(s>0){var d=i.default.getPayloadBlob(e,s);d.remainingRequest&&this._requestQueue.push(d.remainingRequest);var p=this._urlString+"&x-apikey="+c+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(p=p+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var f in h=u.isUint8ArrayAvailable()?new Uint8Array(d.payloadBlob):i.default.base64Encode(d.payloadBlob),e)if(e.hasOwnProperty(f))for(var v=0;v<e[f].length;++v)e[f][v].sendAttempt>0?e[f][v].sendAttempt++:e[f][v].sendAttempt=1;if(this._useBeacons&&r&&u.isBeaconsSupported()&&navigator.sendBeacon(p,h))return;this._httpInterface.sendPOST(p,h,(function(n,i){a._retryRequestIfNeeded(n,i,e,s,c,t,r,o)}),(function(n,i){a._retryRequestIfNeeded(n,i,e,s,c,t,r,o)}),(function(n,i){a._retryRequestIfNeeded(n,i,e,s,c,t,r,o)}),r||o)}else r||this._handleRequestFinished(!1,{},r,o)}catch(e){this._handleRequestFinished(!1,{},r,o)}},e.prototype._retryRequestIfNeeded=function(e,t,r,i,a,s,c,u){var d=this,p=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var v=0;v<h.length;++v)l.default.eventsRejected(r[h[v]],n.AWTEventsRejectedReason.KillSwitch),delete r[h[v]],i--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,r,c,u);(!o.default.shouldRetryForStatus(e)||i<=0)&&(p=!1)}if(p)if(u)this._activeConnections--,r[a][0].priority=n.AWTEventPriority.High,this._queueManager.addBackRequest(r);else if(s<1){for(var g in r)r.hasOwnProperty(g)&&l.default.eventsRetrying(r[g]);setTimeout((function(){return d._sendRequest(r,s+1,!1)}),o.default.getMillisToBackoffForRetry(s))}else this._activeConnections--,f.default.backOffTransmission(),this._queueManager.addBackRequest(r);else this._handleRequestFinished(!1,r,c,u)},e.prototype._handleRequestFinished=function(e,t,r,i){for(var o in e&&f.default.clearBackOff(),t)t.hasOwnProperty(o)&&(e?l.default.eventsSent(t[o]):l.default.eventsDropped(t[o],n.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,i||r||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var r=e.split("\n"),n=0;n<r.length;++n){var i=r[n].split(": ");t[i[0]]=i[1]}return t},e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(279);t._BondDataType=n._BondDataType;var i=r(280);t._Encoding=i;var o=r(283);t.IO=o;var a=r(113);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,r){this._WriteUInt8(t),this._WriteUInt8(r),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=i._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,r){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=i._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(i._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=i._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?n._BondDataType._BT_STOP_BASE:n._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=i._Varint_GetBytes(a.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=i._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(a.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(113),i=r(281),o=r(282);t._Utf8_GetBytes=function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return t},t._Base64_GetString=function(e){for(var t,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=e.length%3,o=0,a=e.length-i;o<a;o+=3){var s=(e[o]<<16)+(e[o+1]<<8)+e[o+2];n.push([r.charAt((t=s)>>18&63),r.charAt(t>>12&63),r.charAt(t>>6&63),r.charAt(63&t)].join(""))}switch(i){case 1:s=e[e.length-1];n.push(r.charAt(s>>2)),n.push(r.charAt(s<<4&63)),n.push("==");break;case 2:var c=(e[e.length-2]<<8)+e[e.length-1];n.push(r.charAt(c>>10)),n.push(r.charAt(c>>4&63)),n.push(r.charAt(c<<2&63)),n.push("=")}return n.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,r=e.high,n=[];r||4294967168&t;)n.push(127&t|128),t=(127&r)<<25|t>>>7,r>>>=7;return n.push(127&t),n},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var r=[],n=0;n<8;++n)r.push(t.getUint8(n));return r}return i.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=n.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,r=e.high,i=r<<1|t>>>31,o=t<<1;2147483648&r&&(i=~i,o=~o);var a=new n.UInt64("0");return a.low=o,a.high=i,a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var r=t?52:23,n=(1<<(t?11:8)-1)-1,i=1-n,o=n,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),c=e-s,u=2*(n+2)+r,l=new Array(u),f=0;f<u;)l[f++]=0;for(f=n+2;f&&s;)l[--f]=s%2,s=Math.floor(s/2);for(f=n+1;f<u-1&&c>0;)(c*=2)>=1?(l[++f]=1,--c):l[++f]=0;for(var d=0;d<u&&!l[d];)d++;var p=n+1-d,h=d+r;if(l[h+1]){for(f=h;f>d&&(l[f]=1-l[f],!l);--f);f===d&&++p}if(p>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(p<i)return t?this._doubleZero:this._floatZero;if(t){var v=0;for(f=0;f<20;++f)v=v<<1|l[++d];for(var g=0;f<52;++f)g=g<<1|l[++d];return[255&g,g>>8&255,g>>16&255,g>>>24,255&(v=a<<31|2147483647&(v|=p+n<<20)),v>>8&255,v>>16&255,v>>>24]}var _=0;for(f=0;f<23;++f)_=_<<1|l[++d];return[255&(_=a<<31|2147483647&(_|=p+n<<23)),_>>8&255,_>>16&255,_>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(113),i=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(n.Number._ToByte(e))},e.prototype._Write=function(e,t,r){for(;r--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*r,Math.min(t,12e4)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=e.split(",");if("this-request-only"===t)return r;for(var n=1e3*parseInt(t,10),i=0;i<r.length;++i)this._killedTokenDictionary[r[i]]=Date.now()+n}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(33),i=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===n.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(97),i=function(){function e(){}return e.setEventsHandler=function(e){n.default.setEventsHandler(e)},e.getEventsHandler=function(){return n.default.getEventsHandler()},e.scheduleTimer=function(){n.default.scheduleTimer()},e}();t.default=i},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,"default",(function(){return Rh}));var i=r(23);function o(e,t){return!t||"object"!==Object(i.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var a=r(157),s=r.n(a),c=r(116),u=r.n(c);function l(e){return(l=u.a?s.a:function(e){return e.__proto__||s()(e)})(e)}var f=r(117),d=r.n(f);function p(e,t){return(p=u.a||function(e,t){return e.__proto__=t,e})(e,t)}var h=r(71),v=r.n(h);var g=r(99),_=r.n(g);function y(){if("undefined"==typeof Reflect||!_.a)return!1;if(_.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(_()(Date,[],(function(){}))),!0}catch(e){return!1}}function b(e,t,r){return(b=y()?_.a:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&p(i,r.prototype),i}).apply(null,arguments)}function m(e){var t="function"==typeof v.a?new v.a:void 0;return(m=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return b(e,arguments,l(this).constructor)}return n.prototype=d()(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,e)})(e)}var k=r(30),T=r.n(k);function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),T()(e,n.key,n)}}function w(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),e}var x=function(){function e(t){n(this,e),this.webWorker=t}return w(e,[{key:"subscribe",value:function(e){this.webWorker.addEventListener("message",e)}},{key:"unsubscribe",value:function(e){this.webWorker.removeEventListener("message",e)}},{key:"send",value:function(e){this.webWorker.postMessage(e)}},{key:"destroy",value:function(){}},{key:"getTargetOrigin",value:function(){return null}}]),e}(),C=r(31),O=r.n(C);var E=r(195),P=r.n(E),I=r(196),A=r.n(I);function R(e){return function(e){if(O()(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(A()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return P()(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var j=r(0),D=r.n(j),M=r(1),L=r.n(M);var F=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o},B=r(13),N=r(24),W=r(14);var U=function(e){return"symbol"==typeof e||Object(W.a)(e)&&"[object Symbol]"==Object(N.a)(e)},z=/^\s+|\s+$/g,q=/^[-+]0x[0-9a-f]+$/i,Q=/^0b[01]+$/i,G=/^0o[0-7]+$/i,H=parseInt;var V=function(e){if("number"==typeof e)return e;if(U(e))return NaN;if(Object(B.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(B.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(z,"");var r=Q.test(e);return r||G.test(e)?H(e.slice(2),r?2:8):q.test(e)?NaN:+e};var K=function(e){return e?(e=V(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Z=function(e){var t=K(e),r=t%1;return t==t?r?t-r:t:0};var J=function(e,t,r){return e&&e.length?(t=r||void 0===t?1:Z(t),F(e,0,t<0?0:t)):[]};var X=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},Y=r(45),$=r(83);var ee=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=r[i])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var f=new Y.a;if(n)var d=n(u,l,c,e,t,f);if(!(void 0===d?Object($.a)(l,u,3,n,f):d))return!1}}return!0};var te=function(e){return e==e&&!Object(B.a)(e)},re=r(19);var ne=function(e){for(var t=Object(re.a)(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,te(i)]}return t};var ie=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}};var oe=function(e){var t=ne(e);return 1==t.length&&t[0][2]?ie(t[0][0],t[0][1]):function(r){return r===e||ee(r,e,t)}},ae=r(4),se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ce=/^\w*$/;var ue=function(e,t){if(Object(ae.a)(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!U(e))||(ce.test(e)||!se.test(e)||null!=t&&e in Object(t))},le=r(72);function fe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(fe.Cache||le.a),r}fe.Cache=le.a;var de=fe;var pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,he=/\\(\\)?/g,ve=function(e){var t=de(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(pe,(function(e,r,n,i){t.push(n?i.replace(he,"$1"):r||e)})),t})),ge=r(16),_e=ge.a?ge.a.prototype:void 0,ye=_e?_e.toString:void 0;var be=function e(t){if("string"==typeof t)return t;if(Object(ae.a)(t))return X(t,e)+"";if(U(t))return ye?ye.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r};var me=function(e){return null==e?"":be(e)};var ke=function(e,t){return Object(ae.a)(e)?e:ue(e,t)?[e]:ve(me(e))};var Te=function(e){if("string"==typeof e||U(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var Se=function(e,t){for(var r=0,n=(t=ke(t,e)).length;null!=e&&r<n;)e=e[Te(t[r++])];return r&&r==n?e:void 0};var we=function(e,t,r){var n=null==e?void 0:Se(e,t);return void 0===n?r:n};var xe=function(e,t){return null!=e&&t in Object(e)},Ce=r(40),Oe=r(57),Ee=r(80);var Pe=function(e,t,r){for(var n=-1,i=(t=ke(t,e)).length,o=!1;++n<i;){var a=Te(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&Object(Ee.a)(i)&&Object(Oe.a)(a,i)&&(Object(ae.a)(e)||Object(Ce.a)(e))};var Ie=function(e,t){return null!=e&&Pe(e,t,xe)};var Ae=function(e,t){return ue(e)&&te(t)?ie(Te(e),t):function(r){var n=we(r,e);return void 0===n&&n===t?Ie(r,e):Object($.a)(t,n,3)}},Re=r(42);var je=function(e){return function(t){return null==t?void 0:t[e]}};var De=function(e){return function(t){return Se(t,e)}};var Me=function(e){return ue(e)?je(Te(e)):De(e)};var Le=function(e){return"function"==typeof e?e:null==e?Re.a:"object"==typeof e?Object(ae.a)(e)?Ae(e[0],e[1]):oe(e):Me(e)};var Fe=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===r(o[c],c,o))break}return t}}();var Be=function(e,t){return e&&Fe(e,t,re.a)},Ne=r(12);var We=function(e,t){return function(r,n){if(null==r)return r;if(!Object(Ne.a)(r))return e(r,n);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==n(a[o],o,a););return r}}(Be);var Ue=function(e,t){var r=-1,n=Object(Ne.a)(e)?Array(e.length):[];return We(e,(function(e,i,o){n[++r]=t(e,i,o)})),n};var ze=function(e,t){return(Object(ae.a)(e)?X:Ue)(e,Le(t,3))},qe=r(62);var Qe=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var Ge=function(e){return e!=e};var He=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var Ve=function(e,t,r){return t==t?He(e,t,r):Qe(e,Ge,r)};var Ke=function(e,t){return!!(null==e?0:e.length)&&Ve(e,t,0)>-1};var Ze=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},Je=r(25),Xe=r(50);var Ye=function(e,t,r,n){var i=-1,o=Ke,a=!0,s=e.length,c=[],u=t.length;if(!s)return c;r&&(t=X(t,Object(Je.a)(r))),n?(o=Ze,a=!1):t.length>=200&&(o=Xe.a,a=!1,t=new qe.a(t));e:for(;++i<s;){var l=e[i],f=null==r?l:r(l);if(l=n||0!==l?l:0,a&&f==f){for(var d=u;d--;)if(t[d]===f)continue e;c.push(l)}else o(t,f,n)||c.push(l)}return c},$e=r(60),et=ge.a?ge.a.isConcatSpreadable:void 0;var tt=function(e){return Object(ae.a)(e)||Object(Ce.a)(e)||!!(et&&e&&e[et])};var rt=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=tt),o||(o=[]);++a<s;){var c=t[a];r>0&&n(c)?r>1?e(c,r-1,n,i,o):Object($e.a)(o,c):i||(o[o.length]=c)}return o},nt=r(36);var it=function(e){return Object(W.a)(e)&&Object(Ne.a)(e)};var ot=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},at=Object(nt.a)((function(e,t){var r=ot(t);return it(r)&&(r=void 0),it(e)?Ye(e,rt(t,1,it,!0),void 0,r):[]})),st=r(96),ct=r(10),ut={log:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},warn:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]}};function lt(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];ut.log(e,t)}var ft=r(5),dt=r.n(ft),pt=r(15),ht=r.n(pt),vt=r(9),gt=r.n(vt),_t=r(7),yt=r.n(_t),bt=r(121);var mt=function(e,t){var r;return We(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r},kt=r(49);var Tt=function(e,t,r){var n=Object(ae.a)(e)?bt.a:mt;return r&&Object(kt.a)(e,t,r)&&(t=void 0),n(e,Le(t,3))},St=r(3);var wt=function(e){return"string"==typeof e||!Object(ae.a)(e)&&Object(W.a)(e)&&"[object String]"==Object(N.a)(e)};var xt=function(e,t){return X(t,(function(t){return e[t]}))};var Ct=function(e){return null==e?[]:xt(e,Object(re.a)(e))},Ot=Math.max;var Et=function(e,t,r,n){e=Object(Ne.a)(e)?e:Ct(e),r=r&&!n?Z(r):0;var i=e.length;return r<0&&(r=Ot(i+r,0)),wt(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Ve(e,t,r)>-1},Pt=r(6),It=r(35),At=r.n(It),Rt=(r(184),r(100));function jt(e,t,r){var n=Object(Rt.stringify)(t),i=e&&e.split("?"),o=i.length>1&&i[1]?"&":1===i.length&&i[0]?"?":"";return""+(e+=n?o:"")+n+(r?"#"+r:"")}var Dt,Mt=r(70);!function(e){e[e.TIMEOUT=0]="TIMEOUT",e[e.CANCELLED=1]="CANCELLED",e[e.FAILED=2]="FAILED"}(Dt||(Dt={}));function Lt(e){return{family:"xml-http-request-executor",code:e}}function Ft(e,t){if(e&&t&&0!==t)return Math.ceil(t-e)}var Bt=/\?/;function Nt(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_"+t,statusCode:e.status,responseText:e.responseText,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:Wt(e.getAllResponseHeaders()),midgardError:Lt(Dt.FAILED)}}function Wt(e){if(e){var t={};return e.split("\r\n").forEach((function(e){var r=e.indexOf(": ");t[e.substr(0,r).toLowerCase()]=e.substr(r+2)})),t}return{}}var Ut=function(){function e(e,t,r,n,i,o){if(this.url=e,this.verb=t,this.timeout=r,this.body=i,this.withCredentials=o,this.isConvertGetPostRequest=!1,this.headers={},n&&"GET"===this.verb){this.isConvertGetPostRequest=!0,this.verb="POST";var a=Bt.test(this.url);this.url=this.url+(a?"&":"?")+"ConvertGetPost=true"}}return e.prototype.setHeader=function(e,t){this.headers[e]=t},e.prototype.setTimeout=function(e){this.timeout=e},e.prototype.go=function(e){var t,r=this;return void 0===e&&(e="REST"),new Promise((function(n,i){var o=new XMLHttpRequest;if(o.open(r.verb,r.url),o.timeout=r.timeout,o.withCredentials=r.withCredentials||!1,r.isConvertGetPostRequest)r.body=JSON.stringify(r.headers);else for(var a in r.headers)r.headers.hasOwnProperty(a)&&o.setRequestHeader(a,r.headers[a]);o.onload=function(a){if(o.status>=200&&o.status<300){var s=Ft(t,a.timeStamp);n(r.getResponseObjectFromRequest(o,s))}else i(Nt(o,e))},o.onerror=function(){i(Nt(o,e))},o.ontimeout=function(){i({statusCode:o.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:Lt(Dt.TIMEOUT)})},o.onabort=function(){i({statusCode:o.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:Lt(Dt.CANCELLED)})},t=function(){try{if("function"==typeof CustomEvent)return new CustomEvent("Event").timeStamp;if("undefined"!=typeof document)return document.createEvent("Event").timeStamp}catch(e){}}(),o.send(r.body)}))},e.prototype.getResponseObjectFromRequest=function(e,t){return{Body:e.responseText,StatusCode:e.status,Headers:Wt(e.getAllResponseHeaders()),ResponseUrl:e.responseURL,RequestDurationFromEvents:t}},e}();var zt=function(){return(zt=yt.a||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},qt=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Qt=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Gt=["/v3/search"],Ht=["floorplan/data","tenant/logo","tenant/my/settings","employee/subscription/all"],Vt=function(){function e(e,t,r,n,i,o){this.environment=e,this.variants=t,this.getAccessToken=r,this.requestExecutorBuilder=n,this.forceHeaderAuth=i,this.conversationId=o,this.isMsbAuthCookieSet=!1}return e.prototype.makeRequest=function(e,t,r,n){return qt(this,void 0,void 0,(function(){var i,o,a,s,c;return Qt(this,(function(u){switch(u.label){case 0:return i=this.shouldAuthInBody(t,e),[4,this.buildRequestExecutor(e,t,i,r,n)];case 1:o=u.sent(),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.go()];case 3:return a=u.sent(),s=JSON.parse(a.Body),i&&(this.isMsbAuthCookieSet=!0),[2,zt(zt({},s),{headers:a.Headers})];case 4:throw c=u.sent(),401===c.statusCode&&(this.isMsbAuthCookieSet=!1),c;case 5:return[2]}}))}))},e.prototype.shouldAuthInBody=function(e,t){return"POST"===e&&!this.forceHeaderAuth&&Tt(Gt,(function(e){var r=function(e){return e.split("?")[0].split("#")[0]}(t);return Et(r,e,r.length-e.length)}))},e.prototype.buildRequestExecutor=function(e,t,r,n,i){return void 0===i&&(i=1e4),qt(this,void 0,void 0,(function(){var o,a,s,c,u,l,f;return Qt(this,(function(d){switch(d.label){case 0:return o=n,a=!0,this.isMsbAuthCookieSet||!this.getAccessToken?[3,2]:[4,this.getAccessToken()];case 1:(c=d.sent())&&(r?o=Object(Pt.a)({Authentication:c},n):(s="Bearer "+c,a=!1)),d.label=2;case 2:return u=o&&dt()(o),this.requestExecutorBuilder?[4,this.requestExecutorBuilder(e,t,r,u)]:[3,4];case 3:return f=d.sent(),[3,5];case 4:f=new Ut(e,t,i,!1,u,a),d.label=5;case 5:return l=f,s&&l.setHeader("Authorization",s),function(){if("undefined"==typeof window||!window.navigator)return!1;return Et(window.navigator.userAgent,"PhantomJS")}()&&"POST"===t&&l.setHeader("Content-Type","text/plain;charset=UTF-8"),[2,l]}}))}))},e.prototype.createRequestUrl=function(e,t,r){void 0===t&&(t="v3");var n=function(e){switch(e){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return"https://business.bing.com/api";case"prod_generic":return"https://business.bing.com/work/api";case"prod_gcc":return"https://usgov.business.bing.com/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return Object(Mt.a)(e)}}(this.environment)+"/"+t+"/"+e,i=r||{};return this.variants&&!Object(St.a)(this.variants)&&(i.variants=this.variants.join(",")),this.conversationId&&!Et(Ht,e)&&(i.cvid=this.conversationId),jt(n,i)},e}();var Kt=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Zt=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Jt(e,t){return Kt(this,void 0,void 0,(function(){var r;return Zt(this,(function(n){switch(n.label){case 0:return r=e.createRequestUrl("suggestions"),[4,e.makeRequest(r,"POST",t)];case 1:return[2,n.sent()]}}))}))}var Xt=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Yt=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},$t={};function er(e){return Xt(this,void 0,void 0,(function(){var t;return Yt(this,(function(r){switch(r.label){case 0:return t=e.createRequestUrl("user/info"),[4,e.makeRequest(t,"GET")];case 1:return[2,r.sent()]}}))}))}function tr(e){return Xt(this,void 0,void 0,(function(){return Yt(this,(function(t){return[2,ir(e,"Loki")]}))}))}function rr(e){return Xt(this,void 0,void 0,(function(){return Yt(this,(function(t){return[2,ir(e,"MicrosoftGraph")]}))}))}function nr(e){return Xt(this,void 0,void 0,(function(){return Yt(this,(function(t){return[2,ir(e,"Substrate")]}))}))}function ir(e,t){var r;return Xt(this,void 0,void 0,(function(){var n,i,o,a;return Yt(this,(function(s){switch(s.label){case 0:return(null===(r=$t[t])||void 0===r?void 0:r.isFetching)?[4,$t[t].lastPromise]:[3,2];case 1:return[2,s.sent()];case 2:n=e.createRequestUrl("user/token/"+t),i=e.makeRequest(n,"GET"),$t[t]={isFetching:!0,lastPromise:i},s.label=3;case 3:return s.trys.push([3,5,,6]),[4,i];case 4:return o=s.sent(),$t[t].isFetching=!1,[2,o];case 5:throw a=s.sent(),$t[t].isFetching=!1,a;case 6:return[2]}}))}))}var or=["msbqfprunetri","msbqfnoprune"],ar=r(115),sr=void 0,cr=void 0;function ur(e){return fr(e,sr)}function lr(e){return fr(e,cr)}var fr=Object(ar.a)((function(e,t){return Tt(t,(function(t){return t===e}))})),dr=r(2);function pr(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}function hr(){for(var e=pr(),t=0,r="",n=0;n<36;n++)switch(n){case 8:case 13:case 18:case 23:t+=1,r+="-";break;case 14:t+=1,r+="4";break;case 19:r+=(e[n-t]%4+8).toString(16);break;default:r+=(e[n-t]%16).toString(16)}return r}var vr=new RegExp(/[^/]query(?:\"?)(?: ?)([:=])/i),gr=new RegExp(/name(?:\"?)(?: ?)([:=])/i),_r=new RegExp(/user(?:\"?)(?: ?)([:=])/i),yr=new RegExp(/((userprincipalname)|(upn))(?:\"?)(?: ?)([:=])/i),br=[{key:"Email",regex:new RegExp(/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/)},{key:"Query",regex:vr},{key:"Name",regex:gr},{key:"User",regex:_r},{key:"UPN",regex:yr}];var mr,kr=["boolean","undefined","MidgardError","number"];function Tr(e,t,r){var n="",i={};e.properties&&(Object.keys(e.properties).forEach((function(t){if(e.properties){var o,a,s,c=null;if(-1===kr.indexOf(typeof e.properties[t])){var u=r(e.featureName,t);try{var l="string"==typeof e.properties[t]?e.properties[t]:JSON.stringify(e.properties[t]);o=l,a=u,s=[],br.forEach((function(e){a&&-1!==a.indexOf(e.key)||e.regex.test(o)&&s.push(e.key)})),c=s.join()}catch(e){}}c?(n+=c+" detected in "+t+";",i[t]="PII Detected: "+c):i[t]=e.properties[t]}})),n&&t(n));return Object(dr.__assign)(Object(dr.__assign)({},e),{properties:i})}function Sr(e,t){var r=function(e){switch(e){case"MicrosoftSearchClickEvent":case"MicrosoftSearchClickEntityEvent":return"clicked_events";case"MicrosoftSearchDiagnosticsEvent":return"diag_events";case"MicrosoftSearchPerformanceEvent":return"perf_events";case"MicrosoftSearchQueryEvent":return"query_events";case"MicrosoftSearchRankingEvent":return"ranking_events";case"MicrosoftSearchRoundTripTimeEvent":return"rtt_events";case"MicrosoftSearchImpressionEvent":return"shown_events";case"MicrosoftSearchSignInEvent":return"signedin_events";case"MicrosoftSearchSignOutEvent":return"signedout_events";case"MicrosoftSearchValueEvent":return"value_events";case"MicrosoftSearchQfValueEvent":return"qf_values";case"MicrosoftSearchAnswerResultsRenderedEvent":return"answer_rendering_events";case"MicrosoftSearchResourcePerformanceEvent":return"resource_events";case"MicrosoftSearchPerformanceTimingsEvent":return"perftiming_events";case"MicrosoftSearchVariantEvent":return"variant_events";case"MicrosoftSearchQfVariantEvent":return"qf_variants";case"MicrosoftSearchPrivacyEvent":return"privacy_events";case"MicrosoftSearchLatencyEvent":return"latency_events";case"MicrosoftSearchMissingInstEvent":return"missing_events";case"MicrosoftSearchValidateEvent":return"validation_events";case"MicrosoftSearchClientLayoutEvent":case"MicrosoftSearchClientDataSourceEvent":case"MicrosoftSearchResultsRenderedEvent":case"MicrosoftSearchFeedbackEvent":case"MicrosoftSearchCounterFactualInformationEvent":case"MicrosoftSearchCachedContentRenderedEvent":return;default:return Object(Mt.b)(e,void 0)}}(e);if(r)return{name:r,properties:t}}function wr(e){var t=e.environment,r=e.impressionGuid,n=e.logicalSearchId,i=e.tenantName,o=e.tenantId,a=e.aadUserId,s=e.sessionId,c=e.muid,u=e.puid,l=e.hasMsa,f=e.formCode,d=e.partnerCode,p=e.dataCenter,h=e.deviceType,v=e.market,g=e.component,_=e.canvas,y=e.page,b=e.isHero,m=e.pageNumber,k=e.serviceGroup,T=e.clientId,S=e.tid,w=e.deploymentRing,x=e.snrVersion,C=e.msbCode,O={};return t&&(O.ENV=t),r&&(O.IG=r),i&&(O.TN=i),o&&(O.TNID=o),a&&(O.UID=a),s&&(O.SID=s),c&&(O.MUID=c),u&&(O.PUID=u),l&&(O.MSA=l),f&&(O.F=f),d&&(O.partnerCode=d),p&&(O.dataCenter=p),h&&(O.deviceType=h),v&&(O.MKT=v),g&&(O.component=g),_&&(O.canvas=_),y&&(O.page=y),b&&(O.isHero=b),m&&(O.pageNumber=m),n&&(O.logicalSearchId=n),k&&(O.serviceGroup=k),T&&(O.clientId=T),S&&(O.TID=S),w&&(O.deploymentRing=w),x&&(O.snrVersion=x),C&&(O.msbCode=C),O}function xr(e){switch(e){case"AnswerRoot":return mr.BingAtWork;case"Ribbon":return mr.Gleam;case"Feedback":return mr.Feedback;case"SkypePresence":return mr.SkypeClient;case"Person":return mr.Person;case"File":return mr.Document;case"Bookmark":return mr.Bookmark;case"LocationBuilding":return mr.Building;case"LocationFloorPlan":return mr.FloorPlan;case"OrgChart":return mr.OrgChart;case"Group":return mr.Group;case"Qna":return mr.RefQna;case"BookmarkSuggest":return mr.BookmarkSuggest;case"Carousel":return mr.Carousel;case"PowerApps":return mr.PowerApps;case"Conversation":return mr.Conversation;case"Message":return mr.Message;case"UserNotification":return mr.UserNotification;case"SuggestedQueries":return mr.SuggestedQueries;case"Site":return mr.Site;case"Diagnostics":return mr.Diagnostics;case"Calendar":return mr.Calendar;case"PowerBi":return mr.PowerBi;case"Acronym":return mr.Acronym;case"IndustryNews":return mr.IndustryNews;case"Flight":return mr.Flight;case"Turing":return mr.Turing;case"VerticalScroll":return mr.VerticalScroll;case"Doormat":return mr.Doormat;case"Topic":return mr.Topic;case"External":return mr.External;case"Connectors":return mr.Connectors;case"Mainline":return mr.Mainline;case"Page":return mr.Page;case"OutsideMSB":return mr.OutsideMSB;case"All":return mr.All;case"EmployeeOffer":return mr.EmployeeOffer;case"Tour":return mr.Tour;case"CompanyNews":return mr.CompanyNews;case"FederatedSearchDomain":return mr.FederatedSearchDomain;case"Logo":return mr.Logo;case"NewsSetting":return mr.NewsSetting;case"Link":return mr.Link;case"SharePoint":return mr.SharePoint;case"FilesAndSites":return mr.FilesAndSites;case"PersonalizedQuerySuggestions":return mr.PersonalizedQuerySuggestions;case"TeamsNearByFloorplan":return mr.TeamsNearByFloorplan;case"OutlookFloorplan":return mr.OutlookFloorplan;case"PersonOffice":return mr.PersonOffice;case"Refiner":return mr.Refiner;case"RelatedSearches":return mr.RelatedSearches;case"TuringQnA":return mr.TuringQnA;case"AsyncAdaptiveAnswer":return mr.AsyncAdaptiveAnswer;case"EducationAssignment":return mr.EducationAssignment;case"EducationClass":return mr.EducationClass;case"QueryFormulation":return mr.QueryFormulation;case"EnterpriseSubscription":return mr.EnterpriseSubscription;case"EnterpriseSuggestion":return mr.EnterpriseSuggestion;case"ExampleQueries":return mr.ExampleQueries;case"ZeroQuery":return mr.ZeroQuery;case"SearchTip":return mr.SearchTip;default:return Object(Mt.a)(e)}}function Cr(e,t){if("Large"===t){if("Hero"===e)return"ANSML";if("Scope"===e)return"CRSLDIS"}else if("Small"===t)return"ANSIL"}!function(e){e[e.OutsideMSB=-1]="OutsideMSB",e[e.BingAtWork=0]="BingAtWork",e[e.Gleam=2]="Gleam",e[e.Feedback=4]="Feedback",e[e.SkypeClient=6]="SkypeClient",e[e.Person=7]="Person",e[e.Document=8]="Document",e[e.Bookmark=9]="Bookmark",e[e.Building=10]="Building",e[e.FloorPlan=11]="FloorPlan",e[e.OrgChart=12]="OrgChart",e[e.Group=13]="Group",e[e.RefQna=14]="RefQna",e[e.PowerBi=15]="PowerBi",e[e.BookmarkSuggest=16]="BookmarkSuggest",e[e.Carousel=18]="Carousel",e[e.WebResult=19]="WebResult",e[e.PowerApps=20]="PowerApps",e[e.Conversation=21]="Conversation",e[e.Message=22]="Message",e[e.UserNotification=23]="UserNotification",e[e.SuggestedQueries=24]="SuggestedQueries",e[e.Site=25]="Site",e[e.Calendar=27]="Calendar",e[e.Acronym=28]="Acronym",e[e.IndustryNews=29]="IndustryNews",e[e.Flight=30]="Flight",e[e.Doormat=31]="Doormat",e[e.Turing=32]="Turing",e[e.VerticalScroll=33]="VerticalScroll",e[e.Topic=35]="Topic",e[e.Connectors=36]="Connectors",e[e.Mainline=37]="Mainline",e[e.Page=38]="Page",e[e.All=39]="All",e[e.External=40]="External",e[e.Tour=41]="Tour",e[e.CompanyNews=42]="CompanyNews",e[e.BingAtWorkHomepage=43]="BingAtWorkHomepage",e[e.BingAtWorkChromeNewTab=44]="BingAtWorkChromeNewTab",e[e.EmployeeOffer=46]="EmployeeOffer",e[e.Logo=47]="Logo",e[e.NewsSetting=51]="NewsSetting",e[e.FederatedSearchDomain=52]="FederatedSearchDomain",e[e.SharePoint=53]="SharePoint",e[e.FilesAndSites=54]="FilesAndSites",e[e.PersonalizedQuerySuggestions=55]="PersonalizedQuerySuggestions",e[e.Link=56]="Link",e[e.OutlookFloorplan=57]="OutlookFloorplan",e[e.TeamsNearByFloorplan=58]="TeamsNearByFloorplan",e[e.PersonOffice=59]="PersonOffice",e[e.QueryFormulation=61]="QueryFormulation",e[e.RelatedSearches=62]="RelatedSearches",e[e.AsyncAdaptiveAnswer=63]="AsyncAdaptiveAnswer",e[e.TuringQnA=64]="TuringQnA",e[e.EducationAssignment=65]="EducationAssignment",e[e.Refiner=66]="Refiner",e[e.EnterpriseSubscription=67]="EnterpriseSubscription",e[e.EducationClass=68]="EducationClass",e[e.EnterpriseSuggestion=69]="EnterpriseSuggestion",e[e.ExampleQueries=70]="ExampleQueries",e[e.ZeroQuery=71]="ZeroQuery",e[e.SearchTip=72]="SearchTip",e[e.Diagnostics=999]="Diagnostics"}(mr||(mr={}));var Or=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var Er=function(e){return"function"==typeof e?e:Re.a};var Pr=function(e,t){return(Object(ae.a)(e)?Or:We)(e,Er(t))};var Ir=function(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1};var Ar=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},Rr=Array.prototype.splice;var jr=function(e,t,r,n){var i=n?Ir:Ve,o=-1,a=t.length,s=e;for(e===t&&(t=Ar(t)),r&&(s=X(e,Object(Je.a)(r)));++o<a;)for(var c=0,u=t[o],l=r?r(u):u;(c=i(s,l,c,n))>-1;)s!==e&&Rr.call(s,c,1),Rr.call(e,c,1);return e};var Dr=function(e,t){return e&&e.length&&t&&t.length?jr(e,t):e},Mr=Object(nt.a)(Dr);var Lr=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},Fr=r(58);var Br=function(e,t,r,n){if(!Object(B.a)(e))return e;for(var i=-1,o=(t=ke(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var c=Te(t[i]),u=r;if(i!=a){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=Object(B.a)(l)?l:Object(Oe.a)(t[i+1])?[]:{})}Object(Fr.a)(s,c,u),s=s[c]}return e};var Nr=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=Se(e,a);r(s,a)&&Br(o,ke(a,e),s)}return o},Wr=r(123),Ur=r(120),zr=Object(Ur.a)(Object.getPrototypeOf,Object),qr=r(82),Qr=r(124),Gr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Object($e.a)(t,Object(qr.a)(e)),e=zr(e);return t}:Qr.a,Hr=r(127),Vr=r(44);var Kr=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Zr=Object.prototype.hasOwnProperty;var Jr=function(e){if(!Object(B.a)(e))return Kr(e);var t=Object(Vr.a)(e),r=[];for(var n in e)("constructor"!=n||!t&&Zr.call(e,n))&&r.push(n);return r};var Xr=function(e){return Object(Ne.a)(e)?Object(Hr.a)(e,!0):Jr(e)};var Yr=function(e){return Object(Wr.a)(e,Xr,Gr)};var $r=function(e,t){if(null==e)return{};var r=X(Yr(e),(function(e){return[e]}));return t=Le(t),Nr(e,r,(function(e,r){return t(e,r[0])}))};var en=function(e,t){return $r(e,Lr(Le(t)))},tn=r(34);var rn=function(e,t){return e&&Object(tn.a)(t,Object(re.a)(t),e)};var nn=function(e,t){return e&&Object(tn.a)(t,Xr(t),e)},on=r(126);var an=function(e,t){return Object(tn.a)(e,Object(qr.a)(e),t)};var sn=function(e,t){return Object(tn.a)(e,Gr(e),t)},cn=r(98),un=r(28),ln=Object.prototype.hasOwnProperty;var fn=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&ln.call(e,"index")&&(r.index=e.index,r.input=e.input),r},dn=r(86);var pn=function(e){var t=new e.constructor(e.byteLength);return new dn.a(t).set(new dn.a(e)),t};var hn=function(e,t){var r=t?pn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},vn=/\w*$/;var gn=function(e){var t=new e.constructor(e.source,vn.exec(e));return t.lastIndex=e.lastIndex,t},_n=ge.a?ge.a.prototype:void 0,yn=_n?_n.valueOf:void 0;var bn=function(e){return yn?Object(yn.call(e)):{}};var mn=function(e,t){var r=t?pn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var kn=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return pn(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return hn(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return mn(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return gn(e);case"[object Set]":return new n;case"[object Symbol]":return bn(e)}},Tn=Object.create,Sn=function(){function e(){}return function(t){if(!Object(B.a)(t))return{};if(Tn)return Tn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var wn=function(e){return"function"!=typeof e.constructor||Object(Vr.a)(e)?{}:Sn(zr(e))},xn=r(39);var Cn=function(e){return Object(W.a)(e)&&"[object Map]"==Object(un.a)(e)},On=r(37),En=On.a&&On.a.isMap,Pn=En?Object(Je.a)(En):Cn;var In=function(e){return Object(W.a)(e)&&"[object Set]"==Object(un.a)(e)},An=On.a&&On.a.isSet,Rn=An?Object(Je.a)(An):In,jn={};jn["[object Arguments]"]=jn["[object Array]"]=jn["[object ArrayBuffer]"]=jn["[object DataView]"]=jn["[object Boolean]"]=jn["[object Date]"]=jn["[object Float32Array]"]=jn["[object Float64Array]"]=jn["[object Int8Array]"]=jn["[object Int16Array]"]=jn["[object Int32Array]"]=jn["[object Map]"]=jn["[object Number]"]=jn["[object Object]"]=jn["[object RegExp]"]=jn["[object Set]"]=jn["[object String]"]=jn["[object Symbol]"]=jn["[object Uint8Array]"]=jn["[object Uint8ClampedArray]"]=jn["[object Uint16Array]"]=jn["[object Uint32Array]"]=!0,jn["[object Error]"]=jn["[object Function]"]=jn["[object WeakMap]"]=!1;var Dn=function e(t,r,n,i,o,a){var s,c=1&r,u=2&r,l=4&r;if(n&&(s=o?n(t,i,o,a):n(t)),void 0!==s)return s;if(!Object(B.a)(t))return t;var f=Object(ae.a)(t);if(f){if(s=fn(t),!c)return Ar(t,s)}else{var d=Object(un.a)(t),p="[object Function]"==d||"[object GeneratorFunction]"==d;if(Object(xn.a)(t))return Object(on.a)(t,c);if("[object Object]"==d||"[object Arguments]"==d||p&&!o){if(s=u||p?{}:wn(t),!c)return u?sn(t,nn(s,t)):an(t,rn(s,t))}else{if(!jn[d])return o?t:{};s=kn(t,d,c)}}a||(a=new Y.a);var h=a.get(t);if(h)return h;a.set(t,s),Rn(t)?t.forEach((function(i){s.add(e(i,r,n,i,t,a))})):Pn(t)&&t.forEach((function(i,o){s.set(o,e(i,r,n,o,t,a))}));var v=l?u?Yr:cn.a:u?keysIn:re.a,g=f?void 0:v(t);return Or(g||t,(function(i,o){g&&(i=t[o=i]),Object(Fr.a)(s,o,e(i,r,n,o,t,a))})),s};var Mn=function(e){return Dn(e,4)};function Ln(){({}),{},!1}var Fn=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var Bn=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,o=U(e),a=void 0!==t,s=null===t,c=t==t,u=U(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||n&&a&&c||!r&&c||!i)return 1;if(!n&&!o&&!u&&e<t||u&&r&&i&&!n&&!o||s&&r&&i||!a&&i||!c)return-1}return 0};var Nn=function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,a=i.length,s=r.length;++n<a;){var c=Bn(i[n],o[n]);if(c)return n>=s?c:c*("desc"==r[n]?-1:1)}return e.index-t.index};var Wn=function(e,t,r){var n=-1;t=X(t.length?t:[Re.a],Object(Je.a)(Le));var i=Ue(e,(function(e,r,i){return{criteria:X(t,(function(t){return t(e)})),index:++n,value:e}}));return Fn(i,(function(e,t){return Nn(e,t,r)}))};var Un=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return Object($e.a)(Object(ae.a)(r)?Ar(r):[r],rt(t,1))},zn=r(84),qn=je("length"),Qn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Gn=function(e){return Qn.test(e)},Hn="[\\ud800-\\udfff]",Vn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Kn="\\ud83c[\\udffb-\\udfff]",Zn="[^\\ud800-\\udfff]",Jn="(?:\\ud83c[\\udde6-\\uddff]){2}",Xn="[\\ud800-\\udbff][\\udc00-\\udfff]",Yn="(?:"+Vn+"|"+Kn+")"+"?",$n="[\\ufe0e\\ufe0f]?"+Yn+("(?:\\u200d(?:"+[Zn,Jn,Xn].join("|")+")[\\ufe0e\\ufe0f]?"+Yn+")*"),ei="(?:"+[Zn+Vn+"?",Vn,Jn,Xn,Hn].join("|")+")",ti=RegExp(Kn+"(?="+Kn+")|"+ei+$n,"g");var ri=function(e){for(var t=ti.lastIndex=0;ti.test(e);)++t;return t};var ni=function(e){return Gn(e)?ri(e):qn(e)};var ii=function(e){if(null==e)return 0;if(Object(Ne.a)(e))return wt(e)?ni(e):e.length;var t=Object(un.a)(e);return"[object Map]"==t||"[object Set]"==t?e.size:Object(zn.a)(e).length},oi=Math.max;var ai=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Z(r);return i<0&&(i=oi(n+i,0)),Ve(e,t,i)};r(122);var si=r(59);var ci=function(e){return e.split("")},ui="[\\ud800-\\udfff]",li="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",fi="[^\\ud800-\\udfff]",di="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",hi="(?:"+li+"|\\ud83c[\\udffb-\\udfff])"+"?",vi="[\\ufe0e\\ufe0f]?"+hi+("(?:\\u200d(?:"+[fi,di,pi].join("|")+")[\\ufe0e\\ufe0f]?"+hi+")*"),gi="(?:"+[fi+li+"?",li,di,pi,ui].join("|")+")",_i=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+gi+vi,"g");var yi=function(e){return e.match(_i)||[]};var bi=function(e){return Gn(e)?yi(e):ci(e)};ge.a&&ge.a.iterator;var mi=r(125);var ki=function(e,t){var r=[];return We(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r};var Ti=function(e,t){return(Object(ae.a)(e)?mi.a:ki)(e,Le(t,3))};var Si=function(e){return function(t,r,n){var i=Object(t);if(!Object(Ne.a)(t)){var o=Le(r,3);t=Object(re.a)(t),r=function(e){return o(i[e],e,i)}}var a=e(t,r,n);return a>-1?i[o?t[a]:a]:void 0}},wi=Math.max;var xi=Si((function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:Z(r);return i<0&&(i=wi(n+i,0)),Qe(e,Le(t,3),i)}));function Ci(){({}),void 0,[],[],1,void 0}var Oi=Math.min;var Ei=function(e,t,r){for(var n=r?Ze:Ke,i=e[0].length,o=e.length,a=o,s=Array(o),c=1/0,u=[];a--;){var l=e[a];a&&t&&(l=X(l,Object(Je.a)(t))),c=Oi(l.length,c),s[a]=!r&&(t||i>=120&&l.length>=120)?new qe.a(a&&l):void 0}l=e[0];var f=-1,d=s[0];e:for(;++f<i&&u.length<c;){var p=l[f],h=t?t(p):p;if(p=r||0!==p?p:0,!(d?Object(Xe.a)(d,h):n(u,h,r))){for(a=o;--a;){var v=s[a];if(!(v?Object(Xe.a)(v,h):n(e[a],h,r)))continue e}d&&d.push(h),u.push(p)}}return u};var Pi=function(e){return it(e)?e:[]};Object(nt.a)((function(e){var t=ot(e),r=X(e,Pi);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?Ei(r,void 0,t):[]})),"undefined"!=typeof window&&!!window&&(window._pageTimings||(window._pageTimings={}));function Ii(){if(self.performance&&performance.now)return performance.now()}var Ai,Ri;function ji(e,t){var r,n=t.userAadObjectId;(null===(r=e.properties)||void 0===r?void 0:r.aadUserId)!==n&&n&&n.indexOf("-")>-1&&(e.properties=yt()(yt()({},e.properties),{aadUserId:n}))}function Di(e,t){switch(e){case"SubstrateAsyncSearch_RoundTripTime":case"SubstrateSearch_RoundTripTime":case"SubstrateUnifiedSearch_RoundTripTime":case"SubstratePowerBi_RoundTripTime":case"SubstrateSearchFiles_RoundTripTime":case"SubstrateSearchSites_RoundTripTime":case"SubstrateSearchFilesAndSites_RoundTripTime":case"SubstrateSearchAll_RoundTripTime":case"SubstrateSharePoint_RoundTripTime":case"SubstrateSearchPersons_RoundTripTime":case"SubstrateConnector_RoundTripTime":case"SubstrateSearchMessages_RoundTripTime":return"ClientDataSource"!==t;case"Productivity_Files_RoundTripTime":case"Productivity_MeetingList_RoundTripTime":case"Productivity_MeetingDetails_RoundTripTime":case"Search_RoundTripTime":case"Files_RoundTripTime":case"ExperimentalFiles_RoundTripTime":case"Sites_RoundTripTime":case"ExperimentalSites_RoundTripTime":case"FilesAndSites_RoundTripTime":case"ExperimentalFilesAndSites_RoundTripTime":case"Conversations_RoundTripTime":case"Person_Groups_RoundTripTime":case"Person_Files_RoundTripTime":case"Person_ExperimentalFiles_RoundTripTime":case"Person_LokiOrgChart_RoundTripTime":case"Person_OrgChart_RoundTripTime":case"Person_Calendar_RoundTripTime":case"Person_ListDetails_RoundTripTime":case"Person_Classes_RoundTripTime":case"FloorPlan_Room_RoundTripTime":case"FloorPlan_VenueMapDataByEmail_RoundTripTime":case"FloorPlan_MeetingRoomsDataByEmail_RoundTripTime":case"Calendar_MeetingDetails_RoundTripTime":case"FloorPlan_SchedulesOfMeetingRooms_RoundTripTime":case"QueryFormulation_Client_RoundTripTime":case"QueryFormulation_Server_RoundTripTime":case"Calendar_MeetingList_RoundTripTime":case"FederatedSearch_RoundTripTime":case"RelatedSearches_RoundTripTime":return"isSubstrate"!==t;case"BookmarkUserSuggestion_RoundTripTime":case"Calendar_MeetingLocation_RoundTripTime":case"Calendar_PersonAvailability_RoundTripTime":case"FloorPlan_RoundTripTime":case"FloorPlan_VenueMap_RoundTripTime":case"SubstrateWarmup_RoundTripTime":case"SubstrateToken_RoundTripTime":case"FetchTenantSettings_RoundTripTime":case"FederatedSearchSettings_RoundTripTime":case"GetUserConfigs_RoundTripTime":case"Calendar_EventCreationData_RoundTripTime":case"Graph_PreviewUrl_RoundTripTime":case"Graph_ProfilePhoto_RoundTripTime":case"Graph_UserProperties_RoundTripTime":case"Group_GroupMembers_RoundTripTime":case"Group_GroupPhoto_RoundTripTime":case"EmployeeOffer_OfferImage_RoundTripTime":case"Person_Photo_RoundTripTime":case"Turing_RoundTripTime":case"UserToken_RoundTripTime":case"Topic_PostFeedback_RoundTripTime":case"Topic_LokiPostFeedback_RoundTripTime":case"Topic_QuestionPrimer_RoundTripTime":case"Topic_LokiQuestionPrimer_RoundTripTime":case"Topic_QuestionId_RoundTripTime":case"Topic_ProcessFeedback_RoundTripTime":case"Notification_RoundTripTime":case"AutoSuggestion_RoundTripTime":case"NewsOptions_RoundTripTime":case"NewsIndustry_RoundTripTime":case"NewsUserInfo_GetNews_RoundTripTime":case"NewsUserInfo_Profile_RoundTripTime":case"NewsUserInfo_Newsletter_RoundTripTime":case"VerticalConfig_RoundTripTime":case"PowerAppToken_RoundTripTime":case"TenantFeedbackToken_RoundTripTime":case"BfbAccessToken_RoundTripTime":case"GetLokiUserToken_RoundTripTime":case"UpdateNotification_RoundTripTime":case"IndustryNews_RoundTripTime":case"Productivity_TopBookmarks_RoundTripTime":case"Productivity_CompanyNews_RoundTripTime":case"Productivity_Notification_RoundTripTime":case"Productivity_TopQueries_RoundTripTime":case"Productivity_CompanyNewsImage_RoundTripTime":case"LoadLastUserInfo_RoundTripTime":case"FetchUserInfo_RoundTripTime":case"LokiConnector_RoundTripTime":case"EnterpriseSubscription_RoundTripTime":case"EnterpriseSuggestion_RoundTripTime":case"EduAssignmentSubmission_RoundTripTime":return!1;default:Object(Mt.a)(e)}}function Mi(e,t){var r={eventId:t,scenario:e.eventScope,domain:e.domain,cardType:e.cardType,isHero:e.isHero,index:e.index,environment:e.environment,hasMsa:e.hasMsa,formCode:e.formCode,canvas:e.canvas,muid:e.muid,dataCenter:e.dataCenter,sessionId:e.sessionId,deviceType:e.deviceType,interpretation:e.interpretation,browserName:Li(),browserVersion:Fi()};return r.isHero||"Hero"!==r.cardType||(r.isHero=!0),r.cardType||(Et(t,"Hero")||Et(t,"Expand")?(r.cardType="Hero",r.isHero=!0):Et(t,"ResultListItem")?r.cardType="ResultListItem":Et(t,"ScopeCard")?r.cardType="Scope":Et(t,"Insight")&&(r.cardType="ListItem")),r}function Li(){if(!Ai){var e=Ni();Ai=Et(e,"OPR/")?"Opera":Et(e,"PhantomJS")?"PhantomJS":Et(e,"Edg")?"Edge":Et(e,"Electron")?"Electron":Et(e,"Chrome")?"Chrome":Et(e,"Trident")?"MSIE":Et(e,"Firefox")?"Firefox":Et(e,"Safari")?"Safari":Et(e,"SkypeShell")?"SkypeShell":"Unknown"}return Ai}function Fi(){if(!Ri){var e=Ni(),t=Li();if("MSIE"===t)Ri=function(e){var t=e.match(new RegExp("MSIE ([\\d,.]+)"));if(t)return t[1];var r=e.match(new RegExp("rv:([\\d,.]+)"));return r?r[1]:"Unknown"}(e);else if("Edge"===t){var r=Bi(e,t);Ri="Unknown"===r?Bi(e,"Edg"):r}else Ri=Bi(e,t)}return Ri}function Bi(e,t){"Safari"===t&&(t="Version");var r=e.match(new RegExp(t+"/([\\d,.]+)"));return r?r[1]:"Unknown"}function Ni(){return window.navigator.userAgent}var Wi=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};r(183);function Ui(e){return!e||!e.trim()}function zi(e,t){var r="(";return t.forEach((function(n,i){r+=e+":"+n,r+=i!==t.length-1?" OR ":")"})),r}var qi=["ai","bmp","gif","heic","ico","jpeg","jpg","png","svg","tiff","tif","webp"],Qi=qi.concat(["dib","eps","odg","rle","psd","wmf","wpd"]),Gi=["ai","webp"];qi.filter((function(e){return Gi.indexOf(e)<0}));var Hi={docx:["doc","docx","docm","dot","dotx"],xlsx:["xls","xlsx","xlsm","xlsb","xltm","xlam"],pptx:["ppt","pptx","pptm"],video:["wmv","avi","mpg","asf","mp4","ogg","ogv","webm","mov"],photo:Qi,pdf:["pdf"],one:["one"],html:["aspx"]},Vi="0x010100F3754F12A9B6490D9622A01FE9D8F012",Ki=["aspx","htm","html","mhtml"];var Zi,Ji,Xi=["0x0120*"],Yi=[Vi,"0x0120D520A808*"];zi("Title",["OneNote_DeletedPages","OneNote_RecycleBin"]),zi("ContentClass",["STS_List_544","STS_ListItem_544"]),zi("filetype",Ki),zi("ContentTypeId",Yi),zi("SecondaryFileExtension",Hi.video),zi("FileType",Hi.photo),zi("ContentTypeId",Xi),zi("ContentClass",["STS_ListItem_GenericList","STS_ListItem_Events","STS_ListItem_Contacts","STS_ListItem_851","STS_ListItem_Categories"]);function $i(e,t,r){return e||(function(e){switch(e){case"BingForBusinessWeb":case"msb.ux.webserp":case"msb.ux.workserp":case"Wsb.MiniSerp":case"Wsb.PreviewPane":return!0;default:return!1}}(t)&&!r?t:t+(r?"Echo":""))}(Zi={})["aad:accesstoken_bingatwork_started"]="aad:accesstoken_bingatwork",Zi.bfbCommandStarted="bfbCommand",Zi.bfbAsync_File_Started="bfbAsync_File",Zi.bfbAsync_Site_Started="bfbAsync_Site",Zi.bfbAsync_FileAndSite_Started="bfbAsync_FileAndSite",Zi.bfbAsync_Conversation_Started="bfbAsync_Conversation",Zi.bfbSubstrateTokenStarted="bfbSubstrateToken",Zi.bfbSubstrateSearchStarted="bfbSubstrateSearch",Zi.bfbSubstrateAsync_External_Started="bfbSubstrateAsync_External",Zi.bfbSubstrateAsync_File_Started="bfbSubstrateAsync_File",Zi.bfbSubstrateAsync_Site_Started="bfbSubstrateAsync_Site",Zi.bfbSubstrateAsync_FileAndSite_Started="bfbSubstrateAsync_FileAndSite",Zi.bfbSubstrateAsync_All_Started="bfbSubstrateAsync_All",Zi.bfbSubstrateUnifiedSearchStarted="bfbSubstrateUnifiedSearch",Zi.bfbSubstrateWarmupStarted="bfbSubstrateWarmup",Zi.bfbTenantSettingsStarted="bfbTenantSettings",Zi.bfbUserConfigsStarted="bfbUserConfigs",Zi.bfbPowerAppTokenStarted="bfbPowerAppToken",Zi.bfbTenantFeedbackTokenStarted="bfbTenantFeedbackToken",Zi.bfbLokiTokenStarted="bfbLokiToken",Zi.bfbVerticalConfigStarted="bfbVerticalConfig",Zi.bfbUpdateNotifications_Started="bfbUpdateNotifications",Zi.bfbVenueMapStarted="bfbVenueMap",Zi.bfbVenueMapByEmailStarted="bfbVenueMapByEmail",(Ji={})["aad:accesstoken_bingatwork_failed"]="aad:accesstoken_bingatwork",Ji.bfbCommandFailed="bfbCommand",Ji.bfbAsync_File_Failed="bfbAsync_File",Ji.bfbAsync_Site_Failed="bfbAsync_Site",Ji.bfbAsync_FileAndSite_Failed="bfbAsync_FileAndSite",Ji.bfbAsync_Conversation_Failed="bfbAsync_Conversation",Ji.bfbSubstrateTokenFailed="bfbSubstrateToken",Ji.bfbSubstrateSearchFailed="bfbSubstrateSearch",Ji.bfbSubstrateAsync_External_Failed="bfbSubstrateAsync_External",Ji.bfbSubstrateAsync_File_Failed="bfbSubstrateAsync_File",Ji.bfbSubstrateAsync_Site_Failed="bfbSubstrateAsync_Site",Ji.bfbSubstrateAsync_FileAndSite_Failed="bfbSubstrateAsync_FileAndSite",Ji.bfbSubstrateAsync_All_Failed="bfbSubstrateAsync_All",Ji.bfbSubstrateUnifiedSearchFailed="bfbSubstrateUnifiedSearch",Ji.bfbSubstrateWarmupFailed="bfbSubstrateWarmup",Ji.bfbTenantSettingsFailed="bfbTenantSettings",Ji.bfbUserConfigsFailed="bfbUserConfigs",Ji.bfbPowerAppTokenFailed="bfbPowerAppToken",Ji.bfbTenantFeedbackTokenFailed="bfbTenantFeedbackToken",Ji.bfbLokiTokenFailed="bfbLokiToken",Ji.bfbVerticalConfigFailed="bfbVerticalConfig",Ji.bfbUpdateNotifications_Failed="bfbUpdateNotifications",Ji.bfbVenueMapFailed="bfbVenueMap",Ji.bfbVenueMapByEmailFailed="bfbVenueMapByEmail";var eo=[];function to(e,t,r){return Object(dr.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(dr.__generator)(this,(function(o){switch(o.label){case 0:return n=Ii(),[4,t()];case 1:return i=o.sent(),function(e,t,r,n){if(!r||!n)return;var i={startTime:r.toFixed(2),duration:(n-r).toFixed(2)};!function(e,t){var r=t.eventId,n=t.properties,i=e.logger,o=e.pendingRoundTripTimeParams;i?ko(i,r,n,"MicrosoftSearchRoundTripTimeEvent"):o.push(t)}(e,{eventId:t,properties:i})}(e,r,n,Ii()),[2,i]}}))}))}var ro;var no={MicrosoftSearchClientLayoutEvent:{resultsView:["Name"]}};function io(e,t){return no[e]&&no[e][t]}var oo,ao=!1,so=[],co=[];function uo(e,t){ko(e,t.eventId,t.properties,"MicrosoftSearchClickEvent"),mo()}function lo(e,t,r){ko(e,t.eventId,t.properties,r?"MicrosoftSearchQfVariantEvent":"MicrosoftSearchVariantEvent")}function fo(e,t){var r=t.eventId,n=t.properties,i=e.logger,o=e.pendingValueParams;i?ko(i,r,n,"MicrosoftSearchQfValueEvent"):o.push(t)}function po(e,t){var r={eventId:t.eventId,properties:t.properties,featureName:"Exception"},n=e.logger,i=e.pendingErrorParams;n?n.logError(r):i.push(t)}function ho(e){switch(e){case"dev":case"dev_bing":return"DEV";case"test":case"staging_bing":return"TEST";case"prod":case"prod_generic":case"prod_gcc":return"PROD";default:return Object(Mt.a)(e)}}function vo(e,t){go(e,{aadUserId:t.user.id,tenantId:t.tenant.id})}function go(e,t){var r=e.getStaticProperties()(),n=Object(Pt.a)(r,t);e.setStaticProperties((function(){return n}))}function _o(e){var t=e.logger,r=e.pendingErrorParams,n=e.pendingValueParams,i=e.pendingRoundTripTimeParams;if(!t)throw new Error("Logger must be initialized before flushing pending log events");Pr(r,(function(e){var r={eventId:e.eventId,properties:e.properties,featureName:"Exception"};t.logError(r)})),Pr(n,(function(e){var r=e.eventId,n=e.properties;ko(t,r,n,"MicrosoftSearchQfValueEvent")})),Pr(i,(function(e){var r=e.eventId,n=e.properties;ko(t,r,n,"MicrosoftSearchRoundTripTimeEvent")}))}function yo(e,t){if(e&&Mr(so,e),Object(St.a)(so))for(var r=co.shift();r;){var n=r.eventInfo,i=r.logger,o=Object(dr.__assign)(Object(dr.__assign)({},n.properties),t);n.properties=o,i.logEvent(n),r=co.shift()}else Pr(co,(function(e){var r=Object(dr.__assign)(Object(dr.__assign)({},e.eventInfo.properties),t);e.eventInfo.properties=r}))}function bo(e){return en(e.getStaticProperties()(),(function(e){return null==e||""===e}))}function mo(){var e=(new Date).getTime();oo&&e-oo<=100&&(oo=void 0)}function ko(e,t,r,n){var i={eventId:t,properties:Object(dr.__assign)(Object(dr.__assign)({},bo(e)),r),featureName:n};if(ao){i=Tr(i,(function(r){var i={eventId:"PrivacyLeakSuspected",featureName:"MicrosoftSearchPrivacyEvent",properties:{infectedFeature:n,infectedEventId:t,violation:r}};e.logEvent(i)}),io)}Object(St.a)(so)?e.logEvent(i):co.push({logger:e,eventInfo:i})}function To(e){if(!Object(B.a)(e))return me(e);var t={};return Object.getOwnPropertyNames(e).forEach((function(r){if(-1===(r=r.toLowerCase()).indexOf("response")){var n=e[r].toLowerCase();r.indexOf("stack")>-1&&(n=n.replace(/ *\([^)]*\) */g,"").replace(/(?:https?|ftp):\/\/[\S]+/g,"(url removed)")),t[r]=n}})),JSON.stringify(t)}function So(e,t){Co(e,t,"ReloadTrieData failed. Unable to build trie. Error Name: "+t.name+", Error Message: "+t.message,"QF3sMigrationError")}function wo(e,t){Co(e,t,"User initialization failed. Attempting to continue with server only feature: "+t.name+": "+t.message,"UserInfoLoadError")}function xo(e){po(e,{eventId:"SavedTrieReloadError",properties:{message:"Reloading saved trie failed",codeLocation:"",error:"Saved trie reload error"}})}function Co(e,t,r,n){po(e,{eventId:n,properties:{message:r,codeLocation:"",error:To(t)}})}var Oo=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r};var Eo=function(e,t,r,n,i){return i(e,(function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)})),r};var Po=function(e,t,r){var n=Object(ae.a)(e)?Oo:Eo,i=arguments.length<3;return n(e,Le(t,4),r,i,We)};function Io(e,t,r,n){r&&n&&fo(e,{eventId:t,properties:{name:"PageLoadTime",value:(n.getTime()-r.getTime()).toString()}})}function Ao(e,t,r){Io(e,"TrieReloaded",t,r)}function Ro(e,t){fo(e,{eventId:"Trie3sMigData",properties:{name:"PageLoadTime",value:t}})}function jo(e,t,r){var n={querylength:t.length,suggestionslength:null==r?void 0:r.length,domains:null==r?void 0:r.map((function(e){return e.domain})).join(","),ids:null==r?void 0:r.map((function(e){return e.id})).join(",")};fo(e,{eventId:"TrieServerRanking",properties:{name:"TrieServerRanking",value:""+Po(n,(function(e,t,r){return t&&e.push(r+"="+t),e}),[]).join("&")}})}function Do(e,t){var r,n,i,o={querylength:null===(r=t.QueryLen)||void 0===r?void 0:r.toString(),qryEmpty:t.isQueryEmpty,UndfnedSrchRes:t.isSearchResultUndefined,CacheMiss:t.CacheMiss,CacheHit:t.CacheHit,ClntSuggCount:null===(n=t.ClntSuggCount)||void 0===n?void 0:n.toString(),ExtSuggCount:null===(i=t.ServerSuggCount)||void 0===i?void 0:i.toString()};fo(e,{eventId:"Suggestion",properties:{name:"Suggestion",value:""+Po(o,(function(e,t,r){return t&&e.push(r+"="+t),e}),[]).join("&")}})}function Mo(e,t,r){fo(e,{eventId:"IndexDB",properties:{name:"IndexDB",value:""+Po({refreshdata:t,deletedata:r},(function(e,t,r){return t&&e.push(r+"="+t),e}),[]).join("&")}})}function Lo(e){return!!e&&(!e.tokenExpiry||e.tokenExpiry>=(new Date).getTime())}var Fo=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Bo=function(){function e(t){n(this,e),this.msbRestProvider=t}return w(e,[{key:"makeRequest",value:function(e,t,r,n,i,o,a,s){return Fo(this,void 0,void 0,D.a.mark((function c(){var u,l;return D.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.getDomain();case 2:return u=c.sent,l="/"===u.substring(u.length-1)?"".concat(u).concat(t.substring(1)):"".concat(u).concat(t),c.next=6,this.makeRequestWithUrl(e,l,r,n,i,o,a,s);case 6:return c.abrupt("return",c.sent);case 7:case"end":return c.stop()}}),c,this)})))}},{key:"makeRequestWithUrl",value:function(e,t,r,n,i,o,a,s){return Fo(this,void 0,void 0,D.a.mark((function c(){var u,l,f,d;return D.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n.RootCorrelationId=i,n.CorrelationId=i,o&&(n.ClientCorrelationId=o),c.next=5,this.getLokiToken();case 5:return u=c.sent,r["X-ClientType"]="Bing",r["X-ClientFeature"]="Search",r["X-ClientScenario"]="",r["X-LPCVersion"]="1.20210728.1.0",r["X-HostAppVersion"]="1.20210728.1.0",r.authorization="Bearer ".concat(u),a&&(r["X-HostAppRing"]=a),l=jt(t,n),f=this.buildRequestExecutor(l,e,r,s),c.next=17,f.go();case 17:return d=c.sent,c.abrupt("return",JSON.parse(d.Body));case 19:case"end":return c.stop()}}),c,this)})))}},{key:"buildRequestExecutor",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4,a=new Ut(e,t,o,!1,n&&dt()(n));return At()(r).forEach((function(e){a.setHeader(e,r[e]||"")})),"object"===Object(i.a)(n)&&"Buffer"!==n.constructor.name&&a.setHeader("Content-Type","application/json"),a}},{key:"getLokiToken",value:function(){return Fo(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Lo(this.lokiToken)){e.next=7;break}return lt("fetching loki token"),e.next=4,tr(this.msbRestProvider);case 4:if(this.lokiToken=e.sent,this.lokiToken){e.next=7;break}throw new Error("lokiToken fetch failed");case 7:return e.abrupt("return",this.lokiToken.token);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getDomain",value:function(){return Fo(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.lokiDomain){e.next=7;break}return lt("getting loki domain url"),e.next=4,this.getDomainUrlFromLoki();case 4:if(this.lokiDomain=e.sent,this.lokiDomain){e.next=7;break}throw new Error("loki domain url fetch failed");case 7:return e.abrupt("return",this.lokiDomain);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getDomainUrlFromLoki",value:function(){return Fo(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},(r={}).Accept="application/json",r["Content-Type"]="",t.cultureName="en-US","/api/v2/configuration",n="".concat("https://loki.delve.office.com").concat("/api/v2/configuration"),lt("Fetching loki config"),e.next=10,this.makeRequestWithUrl("GET",n,r,t,hr());case 10:return i=e.sent,e.abrupt("return",i.LokiUrl);case 12:case"end":return e.stop()}}),e,this)})))}}]),e}(),No=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Wo=function(){function e(t){n(this,e),this.getAccessToken=t}return w(e,[{key:"makeRequest",value:function(e,t,r){return No(this,void 0,void 0,D.a.mark((function n(){var i,o;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.buildRequestExecutor(e,t,r);case 2:return i=n.sent,n.next=5,i.go();case 5:return o=n.sent,n.abrupt("return",JSON.parse(o.Body));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"createRequestUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"v1.0",r=arguments.length>2?arguments[2]:void 0,n="https://graph.microsoft.com",i="".concat(n,"/").concat(t,"/").concat(e),o=r||{};return jt(i,o)}},{key:"buildRequestExecutor",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;return No(this,void 0,void 0,D.a.mark((function i(){var o,a,s;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.getAccessToken){i.next=5;break}return i.next=3,this.getAccessToken();case 3:(a=i.sent)&&(o="Bearer ".concat(a));case 5:return s=new Ut(e,t,n,!1,r&&dt()(r)),o&&s.setHeader("Authorization",o),i.abrupt("return",s);case 8:case"end":return i.stop()}}),i,this)})))}}]),e}();function Uo(e){return e||[]}function zo(e){return"Wsb"===e.clientType}function qo(e){return ur("msbqfprunetri")||"Wsb"===e.clientType&&!ur("msbqfnoprune")}function Qo(){return lr("MicrosoftInternal")&&!ur("bfbqf3soff")}var Go=r(20),Ho=r.n(Go);function Vo(e,t){return function(e){if(O()(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(e);!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ko=r(198),Zo=r.n(Ko);var Jo=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:F(e,t,r)};var Xo=function(e){return Object(W.a)(e)&&"[object RegExp]"==Object(N.a)(e)},Yo=On.a&&On.a.isRegExp,$o=Yo?Object(Je.a)(Yo):Xo;var ea,ta=function(e,t,r){return r&&"number"!=typeof r&&Object(kt.a)(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=me(e))&&("string"==typeof t||null!=t&&!$o(t))&&!(t=be(t))&&Gn(e)?Jo(bi(e),0,r):e.split(t,r):[]};function ra(e,t){var r=e.hqfCfg;return!r||!(null==r?void 0:r.isEnabled)||(null==r?void 0:r.isEnabled)&&(null==r?void 0:r.enabledEntities)&&(null==r?void 0:r.enabledEntities[t])&&(null==r?void 0:r.enabledEntities[t].isEnabled)}function na(e,t,r){var n=e.hqfCfg;return n&&(null==n?void 0:n.enabledEntities)&&n.enabledEntities[t]&&n.enabledEntities[t].maxCount>0?n.isMaxCountPercentageEnabled?Math.round(n.enabledEntities[t].maxCount*n.entityMaxCountPercentage/100).toString():n.isMaxCountEnabled?n.enabledEntities[t].maxCount.toString():r:r}!function(e){e[e.None=0]="None",e[e.HqfPeople=1]="HqfPeople",e[e.HqfFile=2]="HqfFile",e[e.HqfGroup=3]="HqfGroup",e[e.HqfBookmark=4]="HqfBookmark",e[e.HqfQna=5]="HqfQna",e[e.HqfBuilding=6]="HqfBuilding",e[e.HqfEducationAssignment=7]="HqfEducationAssignment",e[e.HqfTopBookmark=8]="HqfTopBookmark"}(ea||(ea={}));var ia=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function oa(e,t,r){return ia(this,void 0,void 0,D.a.mark((function n(){var i,o;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={$top:na(r,ea.HqfPeople,"1500"),$select:"id,displayName,jobTitle,userPrincipalName,scoredEmailAddresses",$filter:"personType/class eq 'Person' and personType/subclass eq 'OrganizationUser'"},o=e.createRequestUrl("me/people","v1.0",i),n.prev=2,n.next=5,e.makeRequest(o,"GET",t);case 5:return n.abrupt("return",n.sent);case 8:if(n.prev=8,n.t0=n.catch(2),404!==n.t0.statusCode){n.next=13;break}return n.abrupt("return",{});case 13:throw n.t0;case 14:case"end":return n.stop()}}),n,null,[[2,8]])})))}function aa(e){return ia(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,null==e?void 0:e.then((function(e){e.EntityResults.filter((function(e){return"People"===e.EntityType}))[0].Entities.forEach((function(e){var t={displayName:"",id:"",jobTitle:"",userPrincipalName:""};t.displayName=void 0===e.DisplayName?"":e.DisplayName,t.id=void 0===e.GlobalId?"":ya(e.GlobalId),t.jobTitle=void 0===e.JobTitle?"":e.JobTitle,t.userPrincipalName=void 0===e.UPN?"":e.UPN,r.push(t)}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}var sa=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ca(e,t,r,n){return sa(this,void 0,void 0,D.a.mark((function i(){var o,a;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o={},(a={}).Accept="application/json",a["Content-Type"]="",o.AadObjectId=t,"/api/v1/organization",i.next=8,e.makeRequest("GET","/api/v1/organization",a,o,hr(),r,n);case 8:return i.abrupt("return",i.sent);case 9:case"end":return i.stop()}}),i)})))}var ua=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function la(e,t){var r=new Zo.a;e.forEach((function(e){return r.add(e.id)}));var n=0;return t.forEach((function(t){!r.has(t.id)&&n<500&&(r.add(t.id),n++,e.push(t))})),e}function fa(e,t,r){return ua(this,void 0,void 0,D.a.mark((function n(){var i,o;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=[],n.next=3,oa(e,t,r);case 3:return o=n.sent,lt("Fetched people from graph"),o.value&&(i=o.value),n.abrupt("return",i);case 7:case"end":return n.stop()}}),n)})))}function da(e,t,r,n){return ua(this,void 0,void 0,D.a.mark((function i(){var o,a;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=[],i.next=3,ca(e,t,r,n);case 3:return(a=i.sent).directs&&ga(o,a.directs),i.abrupt("return",o);case 6:case"end":return i.stop()}}),i)})))}function pa(e,t,r,n){return ua(this,void 0,void 0,D.a.mark((function i(){var o;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.managers&&0!==n.managers.length&&n.managers[n.managers.length-1].aadObjectId){i.next=2;break}return i.abrupt("return",[]);case 2:return o=n.managers[n.managers.length-1].aadObjectId,i.next=5,da(e,o,t,r);case 5:return i.abrupt("return",i.sent);case 6:case"end":return i.stop()}}),i)})))}function ha(e,t,r,n){return ua(this,void 0,void 0,D.a.mark((function i(){var o;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n.managers&&!(n.managers.length<2)&&n.managers[0].aadObjectId){i.next=2;break}return i.abrupt("return",[]);case 2:return o=n.managers[0].aadObjectId,i.next=5,da(e,o,t,r);case 5:return i.abrupt("return",i.sent);case 6:case"end":return i.stop()}}),i)})))}function va(e,t,r,n){return ua(this,void 0,void 0,D.a.mark((function i(){var o,a,s,c,u,l,f,d,p;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=[],a=[],i.next=4,ca(e,t,r,n);case 4:return s=i.sent,lt("Fetched orgchart"),s.managers&&ga(o,s.managers),s.directs&&ga(a,s.directs),c=ha(e,r,n,s),u=pa(e,r,n,s),i.next=12,L.a.all([c,u]);case 12:return l=i.sent,f=Vo(l,2),d=f[0],p=f[1],lt("All people fetched from Loki"),i.abrupt("return",o.concat(a,d,p));case 18:case"end":return i.stop()}}),i)})))}function ga(e,t){t.forEach((function(t){var r=function(e){var t=e.aadObjectId,r=e.displayName,n=e.smtp,i=e.jobTitle,o=e.userPrincipalName;if(t&&i&&r){var a={id:t,displayName:r,jobTitle:i};return o&&(a.userPrincipalName=o),n&&(a.scoredEmailAddresses=[{address:n,relevanceScore:1}]),a}}(t);r&&e.push(r)}))}function _a(e,t,r,n,i,o,a){return ua(this,void 0,void 0,D.a.mark((function s(){var c,u,l,f,d,p,h;return D.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return lt("Fetching people"),c=fa(e,n,a),u=va(t,r,i,o),s.next=5,L.a.all([c,u]);case 5:return l=s.sent,f=Vo(l,2),d=f[0],p=f[1],lt("Fetched people from graph and loki"),h=la(d,p),s.abrupt("return",{value:h});case 12:case"end":return s.stop()}}),s)})))}function ya(e){return e?ta(e,"@")[0]:""}var ba=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ma(e,t,r,n,i,o){return ba(this,void 0,void 0,D.a.mark((function a(){var s,c,u,l,f,d,p,h,v;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={Name:"bingforbusiness.qf"},c={},u={},l=[],f=[],d=!o||0===o.length,ur("bfb3sqffile")&&(d||o&&o.indexOf("File")>=0)&&l.push(ka("File",t,r)),(ur("bfb3sqfppl")||Qo())&&(d||o&&o.indexOf("Person")>=0)&&(p={And:[{Term:{PeopleType:"Person"}},{Term:{PeopleSubType:"OrganizationUser"}}]},l.push(ka("People",t,r,void 0,p))),(ur("bfb3sqfbkmk")||Qo())&&(d||o&&o.indexOf("Bookmark")>=0)&&l.push(ka("Bookmark",t,r,i)),(ur("bfb3sqfqna")||Qo())&&(d||o&&o.indexOf("Qna")>=0)&&l.push(ka("EditorialQnA",t,r,i)),(ur("bfb3sqfbldg")||Qo())&&(d||o&&o.indexOf("Building")>=0)&&l.push(ka("Building",t,r)),(ur("bfb3sbackfill")||Qo())&&f.push.apply(f,["EnableUserBookmarkES","EnableUserQnaES","EnableUserLocationES","DisableBookmarksGroupsAcl"]),f.length>0&&(f.push("MsbEditorialEntitiesFromES"),c.setflight=f.join(",")),h={EntityRequests:l,Scenario:s,TimeZone:"UTC",Cvid:n},a.next=16,e.makeRequest("POST","/api/v1/suggestions",u,c,"","Suggestion",n,h);case 16:return v=a.sent,a.abrupt("return",JSON.parse(v.Response));case 18:case"end":return a.stop()}}),a)})))}var ka=function(e,t,r,n,i){var o={EntityType:e,Query:{QueryString:t},Size:r};return n&&(o.Context={Culture:n}),i&&(o.Filter=i),o},Ta=function(e){var t=[];return Pr(e,(function(e){Pr(e.Suggestions,(function(r){t.push(Sa(e.Type,r))}))})),t},Sa=function(e,t){var r=t.Rank?t.Rank:0;switch(e){case"People":var n=t;return{id:n.Id?ya(n.Id):"",rank:r,query:n.DisplayName,title:n.JobTitle,identifiers:{uniqueName:n.UserPrincipalName},domain:"Person"};case"File":var i=t;return{id:i.Id,rank:r,query:i.Text,title:i.Title,identifiers:{url:i.AccessUrl},domain:"File"};case"Bookmark":var o=t;return{id:o.Id,rank:r,query:o.Title,title:o.Title,identifiers:{url:o.Url},domain:"Bookmark"};case"EditorialQnA":var a=t;return{id:a.Id,rank:r,query:a.Question,title:a.Question,identifiers:{uniqueName:a.Question},domain:"Qna"};case"Building":var s=t;return{id:s.Id,rank:r,query:s.Name,title:s.Name,identifiers:{uniqueName:s.Name},domain:"Building"};default:return{id:t.Id,rank:r,query:"",title:""}}},wa=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},xa=function(){function e(t){n(this,e),this.msbRestProvider=t}return w(e,[{key:"makeRequest",value:function(e,t,r,n,i,o,a,s){return wa(this,void 0,void 0,D.a.mark((function c(){var u;return D.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return u="".concat("https://substrate.office.com/search").concat(t),c.next=3,this.makeRequestWithUrl(e,u,r,n,i,o,a,s);case 3:return c.abrupt("return",c.sent);case 4:case"end":return c.stop()}}),c,this)})))}},{key:"makeRequestWithUrl",value:function(e,t,r,n,i,o,a,s){return wa(this,void 0,void 0,D.a.mark((function c(){var u,l;return D.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n.RootCorrelationId=i,n.CorrelationId=i,a&&(n.ClientCorrelationId=a),c.next=5,this.getSubstrateToken();case 5:return u=c.sent,r.authorization="Bearer ".concat(u),l=jt(t,n),c.next=10,this.makeSubstrateApiCall(e,l,1e4,r,o,s);case 10:return c.abrupt("return",c.sent);case 11:case"end":return c.stop()}}),c,this)})))}},{key:"getSubstrateToken",value:function(){return wa(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Lo(this.substareToken)){e.next=7;break}return lt("fetching substrate token"),e.next=4,nr(this.msbRestProvider);case 4:if(this.substareToken=e.sent,this.substareToken){e.next=7;break}throw new Error("substrateToken fetch failed");case 7:return e.abrupt("return",this.substareToken.token);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"makeSubstrateApiCall",value:function(e,t,r,n,o,a){var s=this;return new L.a((function(c,u){var l,f,d=new XMLHttpRequest;d.open(e,t),d.timeout=r,At()(n).forEach((function(e){d.setRequestHeader(e,n[e]||"")})),"object"===Object(i.a)(a)&&"Buffer"!==a.constructor.name&&d.setRequestHeader("Content-Type","application/json"),d.onload=function(){d.status>=200&&d.status<300?(f=Ft(l,(new Date).getTime()),c(s.getResponseObjectFromRequest(d,"Success",f,o))):u(s.getResponseObjectFromRequest(d,"Failed",f,o))},d.onerror=function(){u(s.getResponseObjectFromRequest(d,"Error",f,o))},d.ontimeout=function(){u(s.getResponseObjectFromRequest(d,"RequestTimeout",f,o))},d.onabort=function(){u(s.getResponseObjectFromRequest(d,"Cancelled",f,o))},l=(new Date).getTime(),d.send(a&&dt()(a))}))}},{key:"getResponseObjectFromRequest",value:function(e,t,r,n){var i;try{var o=void 0===e.responseText||""===e.responseText;"EntityServe"===n&&(o=o||-1===e.responseText.search("find_person.SELECT.Person")&&-1===e.responseText.search("FindDocuments.SELECT.Documents")),i={StatusCode:e.status,IsEmptyResults:o,RestCallStatus:t,Latency:r,Response:e.response}}catch(r){i={RestCallStatus:t,StatusCode:e.status}}return i}}]),e}();function Ca(e){return"object"==typeof e&&!!e&&Object(st.e)(e,"family")&&Object(st.e)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}var Oa="ClientTimeStamp",Ea="QoSTransactionId",Pa="SourceCorrelationId",Ia="Success",Aa="ExpectedFailure",Ra="UnexpectedFailure",ja="MonitorInInvalidState",Da=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus"],Ma=["Stikkontakt","DataLoadStartAction","NoLogging","None"];function La(e){return Da.indexOf(e)>-1}function Fa(e){return-1===Ma.indexOf(e)}var Ba,Na,Wa,Ua=function(){return(Ua=yt.a||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},za=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},qa=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Qa=function(){function e(e,t,r,n,i,o,a){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=r,this.featureName=n,this.staticProperties=i,this.lookupError=o,this.isVerboseLoggingEnabled=a,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=ja,this.transactionId=hr(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then((function(e){return e.broadcastFlush()}))},e.prototype.success=function(e,t){this.endEvent(e,Ia,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,Aa,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,Ra,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,ja):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,r){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=ja,this.lastTag=e,this.lastProperties=r,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,r){return za(this,void 0,void 0,(function(){var n,i,o,a,s,c;return qa(this,(function(u){switch(u.label){case 0:return!Fa(this.featureName)||La(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(n=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return i=u.sent(),a=(o=i).broadcastEvent,c={eventId:n,version:this.monitoringData.version?this.monitoringData.version:"Unknown",type:"QoS"},r&&Ca(r.midgardError)?[4,this.lookupError(r.midgardError)]:[3,3];case 2:return s=u.sent(),[3,4];case 3:s=void 0,u.label=4;case 4:a.apply(o,[(c.midgardError=s,c.source=this.monitoringData.source,c.featureName=this.featureName,c.clientCorrelationid=this.monitoringData.clientCorrelationId,c.qosScenarioName=this.scenarioName,c.qosEventType=t,c.qosTagId=null===e?void 0:e,c.duration=this.duration,c.properties=this.getProperties(r),c)]),u.label=5;case 5:return[2]}}))}))},e.prototype.getProperties=function(e){var t;return Ua(Ua(Ua(Ua({},e),((t={})[Oa]=(new Date).getTime().toString(),t[Ea]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}(),Ga=function(){return(Ga=yt.a||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ha=function(){function e(e,t,r,n){var i=this;this.eventHubPromise=e,this.monitoringData=t,this.logVerbose=r,this.staticProperties=n,this.errorMap={},this.registerErrors=function(e,t){i.errorMap[e]=Ga({},t)},this.logEUPL=function(e,t,r,n){var o=Ia,a=e+"_"+o;i.eventHubPromise.then((function(s){return s.broadcastEvent({eventId:a,version:i.monitoringData.version?i.monitoringData.version:"Unknown",type:"EUPL",source:i.monitoringData.source,featureName:t,clientCorrelationid:i.monitoringData.clientCorrelationId,qosScenarioName:e,qosEventType:o,qosTagId:void 0,duration:r,properties:i.getProperties(n)})}))},this.logQoS=function(e,t,r,n,o,a,s,c){if(Fa(n)&&(!La(n)||i.logVerbose())){var u=a?e+"_"+t+"_"+a:e+"_"+t;i.eventHubPromise.then((function(l){return l.broadcastEvent({eventId:u,version:i.monitoringData.version?i.monitoringData.version:"Unknown",type:"QoS",midgardError:c&&Ca(c.midgardError)?i.lookupError(c.midgardError):void 0,source:i.monitoringData.source,featureName:n,clientCorrelationid:i.monitoringData.clientCorrelationId,qosScenarioName:e,qosEventType:t,qosTagId:null===a?void 0:a,duration:o,properties:i.getProperties(Ga(Ga({},c),{result:r,RequestId:s}))})}))}}}return e.prototype.startMonitor=function(e,t){var r=this;return new Qa(this.eventHubPromise,this.monitoringData,e,t,(function(){return r.staticProperties()}),(function(e){return L.a.resolve(r.lookupError(e))}),this.logVerbose())},e.prototype.logEvent=function(e){this.log(e,"Event")},e.prototype.logUserInteractionEvent=function(e){var t={exportType:"UserInteraction",exportName:e.eventId};e=Ga({exportOptions:t},e),this.log(e,"Event")},e.prototype.logError=function(e){this.log(e,"Error")},e.prototype.logTrace=function(e){this.log(e,"Trace")},e.prototype.flush=function(){return this.eventHubPromise.then((function(e){return e.broadcastFlush()}))},e.prototype.destroy=function(){return this.eventHubPromise.then((function(e){return e.broadcastDestroy()}))},e.prototype.setEventHub=function(e){this.eventHubPromise=L.a.resolve(e)},e.prototype.getEventHub=function(){return this.eventHubPromise},e.prototype.getStaticProperties=function(){return this.staticProperties},e.prototype.setStaticProperties=function(e){this.staticProperties=e},e.prototype.lookupError=function(e){if(!Ca(e))return"Invalid midgardError";var t=this.errorMap[e.family];if(!t)return"Unknown family "+e.family+": "+e.code;var r=t[e.code];return r?e.family+": "+r:"Unknown code: "+e.family+": "+e.code},e.prototype.log=function(e,t){!Fa(e.featureName)||La(e.featureName)&&!this.logVerbose()||this.broadcastEvent(e.eventId,e.featureName,t,e.exportOptions,e.properties)},e.prototype.broadcastEvent=function(e,t,r,n,i){var o=this;e&&this.monitoringData.source&&this.monitoringData.clientCorrelationId&&this.eventHubPromise.then((function(a){return a.broadcastEvent({eventId:e,version:o.monitoringData.version?o.monitoringData.version:"Unknown",type:r,midgardError:i&&Ca(i.midgardError)?o.lookupError(i.midgardError):void 0,source:o.monitoringData.source,featureName:t,clientCorrelationid:o.monitoringData.clientCorrelationId,qosScenarioName:void 0,qosEventType:void 0,qosTagId:void 0,duration:void 0,exportOptions:n,properties:o.getProperties(i)})}))},e.prototype.getProperties=function(e){var t;return Ga(Ga(Ga(((t={})[Oa]=(new Date).getTime().toString(),t),this.monitoringData.properties),this.staticProperties()),e)},e}(),Va=function(){function e(e,t,r,n){this._source=e,this._version=t,this._properties=n||{},this._clientCorrelationId=r&&r.trim()||"",(this._clientCorrelationId.length<32||this._clientCorrelationId.length>100)&&(this._clientCorrelationId=hr(),r&&(this._properties[Pa]=r))}return T()(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),T()(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),T()(e.prototype,"clientCorrelationId",{get:function(){return this._clientCorrelationId},enumerable:!1,configurable:!0}),T()(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),e}(),Ka=function(){function e(e){this.consumers=e||[]}return e.prototype.broadcastEvent=function(e){e&&this.consumers.forEach((function(t){t.canConsumeEvent(e)&&t.consume(e)}))},e.prototype.broadcastFlush=function(){return L.a.all(this.consumers.map((function(e){return e.flush()}))).then()},e.prototype.broadcastDestroy=function(){this.consumers.forEach((function(e){e.destroy()}))},e.prototype.registerConsumer=function(e){this.consumers.push(e)},e}();function Za(e){return"exportOptions"in e&&Boolean(e.exportOptions&&"UserInteraction"===e.exportOptions.exportType)}!function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(Ba||(Ba={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.RequiredDiagnosticData=10]="RequiredDiagnosticData",e[e.OptionalDiagnosticData=100]="OptionalDiagnosticData",e[e.RequiredServiceData=110]="RequiredServiceData",e[e.AlwaysOnRequiredServiceData=120]="AlwaysOnRequiredServiceData"}(Na||(Na={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(Wa||(Wa={}));var Ja=function(){function e(e,t,r,n,i){void 0===t&&(t="NO_USER"),void 0===r&&(r="NO_USER"),void 0===n&&(n="NO_TENANT"),void 0===i&&(i="NO_REGION"),this.eventMapper=e,this._userAadObjectId=t,this._userPuid=r,this._tenantAadObjectId=n,this._lokiRegion=i}return e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:Za(e),isConsoleLogger:!0}},e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){if(e){var t=this.getCommonProperties(e),r=this.eventMapper({event:e,additionalProperties:t});r&&(O()(r)||(r=[r]),r.forEach((function(e){var t;null===(t=e.awtEventData.properties)||void 0===t||t.eventId;try{var r=e.awtEventData.properties.properties&&JSON.parse(e.awtEventData.properties.properties);r&&(e.awtEventData.properties.properties=r)}catch(e){}})))}},e.prototype.flush=function(){return L.a.resolve()},e.prototype.destroy=function(){},e}(),Xa=function(){function e(e){this.callback=e}return e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){e&&this.callback(e)},e.prototype.flush=function(){return L.a.resolve()},e.prototype.destroy=function(){},e}(),Ya=r(66),$a={Generic:"",GDPR:""},es={Prod:{Generic:"33d70a864599496b982a39f036f71122-2064703e-3a9d-4d90-8362-eec08dffe8e8-7176",GDPR:""},Dev:{Generic:"ceb930c7c5d041e899b6de945bc4c6ee-e9ee0db4-0fa5-437b-966d-e8b2950f8d7d-7290",GDPR:""},Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a},ts={LivePeopleCards:{Prod:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-9277d376-40b1-48ec-92f5-b2ee3f44345b-7212",GDPR:"f615f561ec88437db01f752caf151695-7cf4617b-dcbd-4b5b-a5eb-0079c1ba008a-6975"},Dev:$a,Blackforest:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-eb71f759-e748-47d9-922a-96d2522430e4-7094",GDPR:"f615f561ec88437db01f752caf151695-18332f16-126d-42b9-a2f4-2dd55a1ec030-6918"},GccHigh:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-5bace7e6-5357-46f3-88e0-449f4eaacb40-7215",GDPR:"f615f561ec88437db01f752caf151695-d48bf8b4-e399-433b-bb04-f0d344722fe4-7383"},DoD:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-7e485978-0dca-4684-abdd-5bcebedd8f2f-7631",GDPR:"f615f561ec88437db01f752caf151695-e653e3c7-d1be-444c-832d-d3707d03bbcd-6862"},Gallatin:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-99d02291-5114-42b3-aa94-ddd964108c06-7145",GDPR:"f615f561ec88437db01f752caf151695-9728472d-c6e2-4067-a597-f0a9e261a858-6852"},AG08:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-e74e132e-f357-44eb-a0b7-941458772fc3-6908",GDPR:"f615f561ec88437db01f752caf151695-c0a58d75-92c7-4136-ac9f-a689166bf700-6735"},AG09:$a},LivePersonaPicker:{Prod:{Generic:"67199ce661b3472494bbec0bf2e06c27-c34071ab-96bc-40d9-9162-7a83b521b4dd-7282",GDPR:"30b97846c6c640ed90e3b4e06d98a986-b6251ed6-9d7f-4e24-8ace-044e9613d08b-7662"},Dev:$a,Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a},OfficeFeed:{Prod:{Generic:"60dd0301e6c846e9b0699cbbe259efb6-c35f87eb-1000-4625-8cab-d2dd316a0ea6-7539",GDPR:"dc2f4eb67f454d4187656e6aa9063e83-ed148abb-5cbb-42bd-9cfc-298b1dd8c444-7942"},Dev:$a,Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a},LivePersonaEditor:{Prod:{Generic:"77af0c0ae9af49e684693d42352c0cf7-9d604ea0-ea41-4c75-8897-d7dbb0c7f7e9-7006",GDPR:"d2aac9418005423daf110f7008485383-d48b2953-983d-4b8b-857a-9f724d685b97-7218"},Dev:$a,Blackforest:{Generic:"77af0c0ae9af49e684693d42352c0cf7-2c4a13e2-2fef-4ba6-a12a-a369ed907ff9-7140",GDPR:"d2aac9418005423daf110f7008485383-b85d1253-d229-42c8-9cf6-b8ae20c4b61b-7439"},GccHigh:{Generic:"77af0c0ae9af49e684693d42352c0cf7-8b12b5b0-234b-4f96-a57b-dcf09a10401e-7221",GDPR:"d2aac9418005423daf110f7008485383-ee34f80b-d66c-4c0a-9a75-bd32d151a28d-7184"},DoD:{Generic:"77af0c0ae9af49e684693d42352c0cf7-48932264-dbbc-45fe-9173-0ace4b216b7a-7229",GDPR:"d2aac9418005423daf110f7008485383-5cb0db99-dc8f-4b1e-9076-43821ee4622f-7316"},Gallatin:{Generic:"77af0c0ae9af49e684693d42352c0cf7-531738b2-25b2-424a-b4a8-20fbdae1eed8-7390",GDPR:"d2aac9418005423daf110f7008485383-583a5fc4-1880-4f24-afe4-96ebcba895d1-7235"},AG08:$a,AG09:$a},MicrosoftSearch:es,MicrosoftSearch3S:es,OrgExplorer:{Prod:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""},Dev:$a,Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a},NamePronunciation:{Prod:{Generic:"cdba0d01d3c24f188e55845778e5505d-a9c8b79c-ea70-49e9-9352-507b2a8df76f-6790",GDPR:""},Dev:{Generic:"c47a2f5cb4e24f409e35cef5e23ac962-73b83934-404c-41d4-b3f1-2296bb746aa1-7252",GDPR:""},Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a},CortexTopics:{Prod:{Generic:"8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552",GDPR:""},Dev:$a,Blackforest:$a,GccHigh:$a,DoD:$a,Gallatin:$a,AG08:$a,AG09:$a}},rs=function(){function e(e,t,r,n,i,o,a){var s=this;if(this._userAadObjectId=e,this._userPuid=t,this._tenantAadObjectId=r,this._lokiRegion=n,this.eventMapper=i,this.options=o,this.propertyMap={},this.memoryPropertyStorageOverride={setProperty:function(e,t){s.propertyMap[e]=t},getProperty:function(e){return s.propertyMap[e]||""}},!o.forceIntegratedLogger&&a){var c=a;o.isGDPRIntegratedLoggerDisabled||(c=this.initializeAriaSDKAndGetLogFunction(ts[o.tenant][o.environment].GDPR,o.environment)),this.loggers={logRegularEvent:a,logGDPREvent:c}}else this.initializeAriaSDK(ts[o.tenant][o.environment].Generic,o.environment),this.loggers={logRegularEvent:this.logToAria,logGDPREvent:this.logToAria}}return e.prototype.getCommonProperties=function(e){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:Za(e)}},e.prototype.logToAria=function(e,t){Ya.AWTLogManager.getLogger(t).logEvent(e.awtEventData)},e.prototype.logWith=function(e,t,r){O()(t)?t.forEach((function(t){return e(t,r)})):e(t,r)},e.prototype.initializeAriaSDK=function(e,t){var r=void 0;switch(t){case"Blackforest":r=Ya.AWT_COLLECTOR_URL_GERMANY;break;case"GccHigh":r=Ya.AWT_COLLECTOR_URL_USGOV_DOJ;break;case"DoD":r=Ya.AWT_COLLECTOR_URL_USGOV_DOD;break;case"AG08":r="https://collector.azure.eaglex.ic.gov/Collector/3.0/";break;case"AG09":r="";break;case"Dev":case"Gallatin":case"Prod":break;default:Object(Mt.a)(t)}return Ya.AWTLogManager.initialize(e,{collectorUri:r,enableAutoUserSession:Boolean(this.options.enableAutoUserSession),disableCookiesUsage:!0,propertyStorageOverride:this.memoryPropertyStorageOverride})},e.prototype.initializeAriaSDKAndGetLogFunction=function(e,t){return this.initializeAriaSDK(e,t),this.logToAria},e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e){var t=this.options,r=t.environment,n=t.tenant,i=this.getCommonProperties(e);if(Za(e)){var o=this.eventMapper&&this.eventMapper({event:e,additionalProperties:i,eventNameOverride:e.exportOptions.exportName});if(!o)return;this.logWith(this.loggers.logGDPREvent,o,ts[n][r].GDPR)}var a=this.eventMapper&&this.eventMapper({event:e,additionalProperties:i});a&&this.logWith(this.loggers.logRegularEvent,a,ts[n][r].Generic)},e.prototype.flush=function(){return new L.a((function(e){Ya.AWTLogManager.flush((function(){e()}))}))},e.prototype.destroy=function(){Ya.AWTLogManager.flushAndTeardown()},T()(e.prototype,"userAadObjectId",{set:function(e){""!==e&&(this._userAadObjectId=e)},enumerable:!1,configurable:!0}),T()(e.prototype,"userPuid",{set:function(e){""!==e&&(this._userPuid=e)},enumerable:!1,configurable:!0}),T()(e.prototype,"tenantAadObjectId",{set:function(e){""!==e&&(this._tenantAadObjectId=e)},enumerable:!1,configurable:!0}),T()(e.prototype,"lokiRegion",{set:function(e){""!==e&&(this._lokiRegion=e)},enumerable:!1,configurable:!0}),e}(),ns=r(111);function is(e){return"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"===e}function os(e,t){var r=e[t];return O()(r)||"object"===Object(i.a)(r)?dt()(r):!1===r||0===r?r:r||""}function as(e){e.properties=en(e.properties,(function(e){return null==e||""===e}))}function ss(e){return cs(e,!0)}function cs(e,t){var r=-e.getTimezoneOffset(),n=r>=0?"+":"-";return e.getFullYear()+"-"+us(e.getMonth()+1)+"-"+us(e.getDate())+"T"+us(e.getHours())+":"+us(e.getMinutes())+":"+us(e.getSeconds())+(t?"."+us(e.getMilliseconds()):"")+n+us(r/60)+":"+us(r%60)}function us(e){var t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}function ls(e,t,r,n){if(e)return r?{name:e,properties:n?yt()(yt()({},t),{metadata:dt()(n)}):t}:{Name:e,Attributes:n?yt()(yt()({},t),{metadata:dt()(n)}):t}}function fs(e){var t=e;switch(t){case"MicrosoftSearchClickEvent":case"MicrosoftSearchClickEntityEvent":case"MicrosoftSearchClientDataSourceEvent":case"MicrosoftSearchClientLayoutEvent":case"MicrosoftSearchRoundTripTimeEvent":case"MicrosoftSearchResultsRenderedEvent":case"MicrosoftSearchCachedContentRenderedEvent":case"MicrosoftSearchFeedbackEvent":case"MicrosoftSearchCounterFactualInformationEvent":return!0;case"MicrosoftSearchDiagnosticsEvent":case"MicrosoftSearchPerformanceEvent":case"MicrosoftSearchValidateEvent":case"MicrosoftSearchQueryEvent":case"MicrosoftSearchRankingEvent":case"MicrosoftSearchImpressionEvent":case"MicrosoftSearchAnswerResultsRenderedEvent":case"MicrosoftSearchSignInEvent":case"MicrosoftSearchSignOutEvent":case"MicrosoftSearchValueEvent":case"MicrosoftSearchQfValueEvent":case"MicrosoftSearchResourcePerformanceEvent":case"MicrosoftSearchPerformanceTimingsEvent":case"MicrosoftSearchVariantEvent":case"MicrosoftSearchQfVariantEvent":case"MicrosoftSearchPrivacyEvent":case"MicrosoftSearchLatencyEvent":case"MicrosoftSearchMissingInstEvent":return!1;default:return Object(Mt.b)(t,!1)}}function ds(e,t){var r=e.tenantId;return{UserId:e.puid||"",TenantId:r||"",TraceId:t||"",LogicalId:e.logicalSearchId||"",Version:"2",LocalTime:ss(new Date)}}function ps(e){var t=e.tenantId;return{UserId:e.puid||"",TenantId:t||"",LogicalId:e.logicalSearchId||"",Version:"2",LocalTime:ss(new Date)}}function hs(e,t){return{TraceId:t||"",Version:"2",LogicalId:e.logicalSearchId||""}}function vs(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.properties,n=gs(r);return ls("CachedContentRendered",n,t)}function gs(e){var t=e.newLogicalId,r={ConversationId:e.conversationId||"",NewLogicalId:t||""},n=ps(e);return Object(Pt.a)(r,n)}var _s=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e};var ys=function(e,t,r){return e=me(e),r=null==r?0:_s(Z(r),0,e.length),t=be(t),e.slice(r,r+t.length)==t};var bs=function(e,t,r){e=me(e),t=be(t);var n=e.length,i=r=void 0===r?n:_s(Z(r),0,n);return(r-=t.length)>=0&&e.slice(r,i)==t};function ms(e){return e?"SearchEntityActions":"SearchActions"}function ks(e,t){switch(e){case"Bookmark_Click":case"File_Click":case"Link_Answer_Click":case"PowerBi_Click":case"Acronym_Insight_Click":case"Bookmark_Insight_Click":case"Connectors_Insight_Click":case"Conversation_Teams_Insight_Click":case"Conversation_Yammer_Insight_Click":case"Conversation_Exchange_Insight_Click":case"EducationAssignment_Insight_Click":case"File_Insight_Click":case"Group_Insight_Click":case"Location_Insight_Click":case"Person_Insight_Click":case"Site_Insight_Click":case"FilesAndSites_Insight_Click":case"Qna_Insight_Click":case"PowerBi_Insight_Click":case"Turing_Insight_Click":case"Connectors_AutoExpanded_Insight_Click":case"Conversation_AutoExpanded_Teams_Insight_Click":case"Conversation_AutoExpanded_Yammer_Insight_Click":case"Conversation_AutoExpanded_Exchange_Insight_Click":case"Site_AutoExpanded_Insight_Click":case"FilesAndSites_AutoExpanded_Insight_Click":case"Turing_AutoExpanded_Insight_Click":case"File_AutoExpanded_Insight_Click":case"PowerBi_AutoExpanded_Insight_Click":case"EducationAssignment_AutoExpanded_Insight_Click":case"Offer_Insight_Click":case"Tile_Carousel_Card_Click":case"Conversation_All_ResultCluster_ResultListItem_Click":case"Conversation_All_ResultListItem_Click":case"Conversation_All_Hero_ResultListItem_Click":case"File_ResultListItem_Click":case"File_Hero_ResultListItem_Click":case"FilesAndSites_ResultListItem_Click":case"Acronym_ResultListItem_Click":case"Bookmark_ResultListItem_Click":case"Connectors_ResultListItem_Click":case"Connectors_All_ResultCluster_ResultListItem_Click":case"PowerBi_Hero_ResultListItem_Click":case"PowerBi_ResultListItem_Click":case"Site_ResultListItem_Click":case"Site_Hero_ResultListItem_Click":case"Group_ResultListItem_Click":case"Person_Entity_Click":case"Person_ResultListItem_Click":case"Qna_ResultListItem_Click":case"Location_ResultListItem_Click":case"FederatedSearch_ResultListItem_Click":case"Location_FloorPlan_ResultListItem_Click":case"Offer_ResultListItem_Click":case"SharePoint_ResultListItem_Click":case"EducationAssignment_ResultListItem_Click":case"EducationAssignment_Hero_ResultListItem_Click":case"Offer_ResultGridItem_Click":case"CalendarEvent_Event_Click":case"Flight_Card_Click":case"RelatedSearches_Click":case"TuringQnA_Entity_Click":case"Topic_Click":case"Topic_Link_Click":case"Topic_Title_Click":case"QueryFormulation_Click":case"Async_Adaptive_Answer_Click":case"Mainline_RichPill_Click":case"Ribbon_RichPill_Click":case"Page_RichPill_Click":return"EntityClicked";case"Meeting_Deeplink_Click":case"File_Thumbnail_Click":case"File_FolderBreadcrumb_Click":case"File_Author_Profile_Click":case"File_Modifier_Profile_Click":case"File_Sender_Profile_Click":case"Person_IntentTab_Click":case"Group_IntentTab_Click":case"Link_Sender_Profile_Click":case"CalendarEvent_Organizer_Profile_Click":case"Productivity_Meeting_DeepLink_Click":case"Productivity_CompanyNewsLink_Click":case"Topic_Person_Hover_Click":case"Topic_Person_Click":case"Topic_Resource_Click":case"Topic_Person_Mined_Resource_Click":case"Topic_Definition_Source_Click":case"Topic_Definition_License_Click":case"Topic_Feedback_Click":case"Topic_Answer_Give_Feedback_Email_Click":case"Topic_Person_Header_Click":case"Topic_Resource_Header_Click":case"CalendarEvent_RelatedAttachment_Click":return"RelatedEntityClicked";case"Group_Member_Click":case"Person_About_OrgChart_Click":case"Person_About_Availability_Click":case"Person_Badge_Click":case"Person_Groups_Group_Click":case"Person_OrgChart_Persona_Click":case"Person_OrgChart_PersonCard_Click":case"Person_OrgChartCompact_Persona_Click":case"Person_OrgChartCompact_PersonCard_Click":case"Person_RelatedSearches_Click":case"Person_Classes_Class_Click":case"FindMeetingRoom_StartTimeDropdown_Click":case"FindMeetingRoom_EndTimeDropdown_Click":case"FindMeetingRoom_ViewBooking_Button_Click":case"Person_RelatedPerson_Click":case"RequeryEntityLink_Click":return"EntityRefinerClicked";case"Bookmark_Link_Copy_Action_Click_Success":case"Bookmark_Link_Copy_Action_Click_Failure":case"Person_About_Alias_Click":case"Person_About_Email_Click":case"Person_About_File_Click":case"Person_About_OfficeLocation_Click":case"Person_About_Phone_Click":case"Person_Files_File_Click":case"Person_ResultListItem_Alias_Click":case"Person_ResultListItem_Email_Click":case"Person_ResultListItem_Phone_Click":case"Person_ResultListItem_OfficeLocation_Click":case"Person_SeeProfile_Click":case"Person_SeeTeamsChat_Click":case"Group_Email_Click":case"Group_SeeProfile_Click":case"Group_SeeAllMembers_Click":case"Attendee_SeeProfile_Click":case"File_CopyLink_Click":case"File_Download_Click":case"File_OpenInApp_Click":case"File_OpenInBrowser_Click":case"File_Share_Click":case"File_Source_Click":case"FindMeetingRoom_BookMeetingRoom_Button_Click":case"FindMeetingRoom_DatePicker_Click":case"Qna_Link_Click":case"FindMeetingRoom_OpenInOutlook_Click":case"Location_GetDirections_Click":case"Flight_Hops_Click":case"Acronym_Attribution_Click":case"Acronym_Expand_Text_Click":case"Link_MailSource_Click":case"Link_TeamsSource_Click":case"CalendarEvent_Edit_Click":case"CalendarEvent_Reply_Click":case"CalendarEvent_ReplyAll_Click":case"CalendarEvent_Forward_Click":case"CalendarEvent_RSVPItem_Click":case"CalendarEvent_ProposeNewTime_Click":case"CalendarEvent_Join_Teams_Click":case"CalendarEvent_Conflicts_Expand_Click":case"CalendarEvent_ScheduleNextMeeting_Click":case"Flight_View_Reservation_Click":case"Flight_Share_Click":case"Offer_LocateStore_Click":case"Productivity_Attendee_SeeProfile_Click":case"Productivity_More_Attendee_Click":return"EntityActionTaken";case"Bookmark_Expand_Click":case"Bookmark_PowerApp_Expand_Click":case"Bookmark_PowerBiApp_Expand_Click":case"Location_Expand_Click":case"LocationFloorPlan_Expand_Click":case"Person_Calendar_Expand_Click":case"Person_Files_Expand_Click":case"Person_Groups_Expand_Click":case"Person_OfficeLocation_Expand_Click":case"Person_OrgChart_Expand_Click":case"Person_OrgChart_ManagerExpand_Click":case"Person_Classes_Expand_Click":case"Qna_Expand_Click":case"Meeting_Expand_Click":case"MultipleFlights_Expand_Click":case"SingleFlight_Expand_Click":return t.isExpanded?"PreviewOpen":"PreviewClose";case"Flight_View_Email_Click_Expanded":case"Flight_Web_CheckIn_Click_Expanded":case"Person_OrgChart_SeeMorePeer_Click":return"PreviewOpen";case"Flight_Web_CheckIn_Click_Collapsed":case"Flight_View_Email_Click_Collapsed":return"PreviewClose";default:return Object(Mt.a)(e)}}function Ts(e){switch(e){case"OutsideMSB_Click":case"Bookmark_ScopeCard_Click":case"Conversation_All_ScopeCard_Click":case"Conversation_Teams_ScopeCard_Click":case"Conversation_Yammer_ScopeCard_Click":case"Conversation_Exchange_ScopeCard_Click":case"Message_Teams_ScopeCard_Click":case"Message_Exchange_ScopeCard_Click":case"File_ScopeCard_Click":case"Offer_ScopeCard_Click":case"PowerBi_ScopeCard_Click":case"Group_ScopeCard_Click":case"Location_ScopeCard_Click":case"Qna_ScopeCard_Click":case"Site_ScopeCard_Click":case"FilesAndSites_ScopeCard_Click":case"Connectors_ScopeCard_Click":case"Connectors_AutoExpanded_ScopeCard_Click":case"Acronym_ScopeCard_Click":case"Turing_ScopeCard_Click":case"Conversation_AutoExpanded_All_ScopeCard_Click":case"Conversation_AutoExpanded_Teams_ScopeCard_Click":case"Conversation_AutoExpanded_Yammer_ScopeCard_Click":case"Conversation_AutoExpanded_Exchange_ScopeCard_Click":case"EducationAssignment_ScopeCard_Click":case"EducationClass_ScopeCard_Click":case"Federated_Search_Default_User_Input_Change_Click":case"Federated_Search_Default_User_Input_SearchButton_Click":case"Federated_Search_User_Input_Filter_Change_Click":case"File_AutoExpanded_ScopeCard_Click":case"PowerBi_AutoExpanded_ScopeCard_Click":case"Site_AutoExpanded_ScopeCard_Click":case"FilesAndSites_AutoExpanded_ScopeCard_Click":case"Turing_AutoExpanded_ScopeCard_Click":case"EducationAssignment_AutoExpanded_ScopeCard_Click":case"Page_Menu_Click":case"Learn_More_Click":case"WorkScopeItem_Click":case"Mainline_Low_Confidence_Why_Seeing_Click":case"FRE_Low_Confidence_Why_Seeing_Click":case"Mainline_Sign_Out_Click":case"WebRecourse_Link_Click":case"SpellSuggestion_Link_Click":case"Ribbon_Privacy_Click":case"Productivity_Privacy_Click":case"Notification_Engagement_Click":case"Tour_Card_Requery_Click":case"ExampleQueries_Requery_Click":case"Personalized_Query_Suggestions_Engagement_Click":case"Mainline_Scope_List_Title_Click":case"Federated_Search_Auth_Click":case"Location_DisabledMap_Learn_More_Click":case"Location_FloorPlan_DisabledMap_Learn_More_Click":case"Person_About_OfficeLocation_DisabledMap_Learn_More_Click":case"Person_OfficeLocation_DisabledMap_Learn_More_Click":case"Teams_NearBy_Room_Click":case"Teams_NearBy_Floor_Change_Click":case"Feedback_Menu_Click":case"Feedback_Menu_Email_Click":case"Feedback_Link_Click":case"Productivity_Feedback_Link_Click":case"Productivity_RefreshPage_Click":case"Productivity_CreateExcelSheet_Click":case"Productivity_CreateWordDoc_Click":case"Productivity_CreatePowerpointPresentation_Click":case"RequeryLink_Click":case"Productivity_DoormatCard_Bookmark_Click":case"Productivity_DoormatCard_FREQuery_Click":case"Productivity_DoormatCard_TopSearch_Click":case"Productivity_FindARoom_Click":case"Productivity_SetupAMeeting_Click":case"Async_Adaptive_Answer_Click":case"SearchBox_X_Click":case"SearchTip_Button_Click":case"SearchTip_Bubble_Dismiss_Click":case"SearchTip_Tab_Dismiss_Click":case"Tour_Bubble_Dismiss_Click":case"Tour_Bubble_Previous_Click":case"Tour_Bubble_Next_Click":case"Tour_Bubble_Done_Click":return"VerticalClicked";case"Refiner_Click":return"FilterPaneClicked";case"Refiner_RemoveRefinerPill_Click":case"Refiner_ApplyRefiner_Click":return"FilterModified";case"Refiner_ClearAllButton_Click":case"NoResults_ClearAllRefiners_Click":return"ClearFilters";case"Page_Pagination_Click":return"PaginationClicked";case"File_SeeMoreFiles_Click":case"Productivity_SeeMorePersonFiles_Click":case"FRE_Low_Confidence_See_Results_Click":case"High_Intent_Answer_Footer_Click":case"High_Intent_Answer_Header_Click":case"IndustryNews_Carousel_NewsCard_Click":case"Mainline_High_Confidence_See_Results_Click":case"Mainline_Medium_Confidence_See_Results_Click":case"Mainline_Low_Confidence_See_Results_Click":case"Mainline_See_Results_Click":case"Person_RelatedSeeMore_Click":case"PowerBi_SeeMorePowerBi_Click":case"Productivity_CompanyNewsSeeMoreLink_Click":case"Productivity_MyFilesPill_Click":case"ResultCluster_Title_Click":case"ResultCluster_Footer_Click":case"LearnMore_En_Click":case"LearnMore_NonEn_Click":case"ResultList_SeeMore_Click":case"Ribbon_See_Results_Click":case"ScopeCard_SeeMore_Click":case"Calendar_SeeMore_Click":case"Notification_Dismiss_Click":case"Tour_Panel_Dismiss_Click":case"Feedback_BookmarkUserSuggestion_Click":case"Feedback_BookmarkUserSuggestion_Close_Click":case"Feedback_Close_Click":case"Productivity_Feedback_Close_Click":case"Acronym_Expand_Click":case"Acronym_Carousel_Next_Click":case"Acronym_Carousel_Previous_Click":case"Acronym_Carousel_Page_Click":case"FindMeetingRoom_Expand_Click":case"Mainline_Pill_Click":case"Page_Pill_Click":case"Ribbon_Pill_Click":case"SeeAll_Pill_Click":return"ExpandLinkClicked";case"Carousel_Arrow_Click":case"Tile_Carousel_Arrow_Click":case"IndustryNews_Carousel_LeftArrow_Click":case"IndustryNews_Carousel_RightArrow_Click":case"TourCarousel_LeftArrow_Click":case"TourCarousel_RightArrow_Click":return"ScrollBarMoved";case"Mainline_Profile_Picture_Click":case"Ribbon_Hide_Click":case"VerticalNavigationToggle_Enabled":case"VerticalNavigationToggle_Disabled":case"EducationAssignment_SubmissionStatus_Click":case"Algo_Decoration_Popup_GetAccessClick":case"Algo_Decoration_Url_Click":case"Algo_Decoration_Popup_Open_Hover":case"Algo_Decoration_Popup_Open_BannerClick":case"Algo_Decoration_Popup_Close_Hover":case"Algo_Decoration_Popup_Close_BannerClick":case"Algo_Decoration_Popup_Close_ExternalClick":case"Algo_Decoration_Popup_Close_CloseButtonClick":return"ExpandHiddenItems";case"Search_Web_Qf_Click":return"ExitSearch";case"Answer_DismissButton_Click":return"DismissClicked";case"QueryFormulation_Click":case"SearchDone":return"SearchDone";case"SearchBox_Focus":return"SearchBoxFocus";case"CrossEntryPoint_Work_Navigation":return"CrossEntryPointNavigationDone";case"Acronym_PrivacyIcon_Click":return"PrivacyInformationClicked";default:return Object(Mt.a)(e)}}function Ss(e,t,r,n){var i=Mi(t,e),o=t.eventScope;switch(n&&(i.entityAttributes=n),r){case"EntityClicked":"File"===o?i.EntityClickDetails="NewTabOpen":bs(e,"Topic_Title_Click")?i.EntityClickDetails="TopicTitleClick":bs(e,"Topic_Link_Click")?i.EntityClickDetails="TopicLinkClick":i.EntityClickDetails="OpenInClient";break;case"RelatedEntityClicked":bs(e,"Privacy_Click")||bs(e,"Deeplink_Click")?i.RelatedEntityType="DeepLink":bs(e,"File_FolderBreadcrumb_Click")?i.RelatedEntityType="BreadcrumbItemClick":bs(e,"Organizer_Profile_Click")?i.RelatedEntityType="Organizer":bs(e,"Author_Profile_Click")?i.RelatedEntityType="Author":bs(e,"Sender_Profile_Click")?i.RelatedEntityType="Sender":bs(e,"Modifier_Profile_Click")?i.RelatedEntityType="Modifier":bs(e,"Topic_Definition_Source_Click")?i.RelatedEntityType="TopicDefinitionSourceClick":bs(e,"Topic_Definition_License_Click")?i.RelatedEntityType="TopicDefinitionLicenseClick":bs(e,"Topic_Person_Click")?i.RelatedEntityType="TopicPersonClick":bs(e,"Topic_Person_Hover_Click")?i.RelatedEntityType="TopicPersonHoverClick":bs(e,"Topic_Person_Mined_Resource_Click")?i.RelatedEntityType="TopicPersonMinedResourceClick":bs(e,"Topic_Feedback_Click")?i.RelatedEntityType="TopicFeedbackClick":bs(e,"Topic_Answer_Give_Feedback_Email_Click")?i.RelatedEntityType="TopicAnswerGiveFeedbackEmailClick":bs(e,"Topic_Resource_Click")?i.RelatedEntityType="TopicResourceClick":bs(e,"Topic_Person_Header_Click")?i.RelatedEntityType="TopicPersonHeaderClick":bs(e,"Topic_Resource_Header_Click")&&(i.RelatedEntityType="TopicResourceHeaderClick");break;case"EntityRefinerClicked":"Person_About_Availability_Click"===e?i.EntityRefinerType="Calendar":"Person_Groups_Group_Click"===e?i.EntityRefinerType="Groups":"Person_About_OfficeLocation_Click"===e?i.EntityRefinerType="Office":ys(e,"FindMeetingRoom")?i.EntityRefinerType="Calendar":Et(e,"OrgChart")&&(i.EntityRefinerType="Organization");break;case"EntityActionTaken":Et(e,"Link_Copy")||Et(e,"CopyLink")?i.EntityActionTakenType="CopyLink":bs(e,"Email_Click")?i.EntityActionTakenType="EmailClick":bs(e,"Phone_Click")?i.EntityActionTakenType="WorkPhoneClick":bs(e,"Link_Click")||bs(e,"File_Click")||bs(e,"Learn_More_Click")?i.EntityActionTakenType="LinkClicked":bs(e,"Download_Click")?i.EntityActionTakenType="Download":bs(e,"SeeProfile_Click")?i.EntityActionTakenType="OpenContactCard":bs(e,"Share_Click")?i.EntityActionTakenType="Share":bs(e,"Reply_Click")?i.EntityActionTakenType="Reply":bs(e,"ReplyAll_Click")?i.EntityActionTakenType="ReplyAll":bs(e,"Forward_Click")?i.EntityActionTakenType="Forward":bs(e,"Edit_Click")?i.EntityActionTakenType="Edit":bs(e,"RSVPItem_Click")?i.EntityActionTakenType="RSVP":bs(e,"ScheduleNextMeeting_Click")?i.EntityActionTakenType="ScheduleMeeting":bs(e,"ProposeNewTime_Click")?i.EntityActionTakenType="ProposeNewTime":bs(e,"Join_Teams_Click")?i.EntityActionTakenType="JoinTeams":bs(e,"View_Reservation_Click")?i.EntityActionTakenType="FlightReservation":bs(e,"Flight_Hops_Click")&&(i.EntityActionTakenType="FlightHops");break;case"VerticalClicked":if("Page_Menu_Click"===e){var a=t.page;"All"===a?i.VerticalType="all":"Person"===a?i.VerticalType="people":"Site"===a?i.VerticalType="sites":"File"===a?i.VerticalType="files":"Conversation"===a?i.VerticalType="conversation":"Message"===a?i.VerticalType="message":"PowerBi"===a?i.VerticalType="powerbi":a&&(i.VerticalType="custom",i.VerticalId=a)}else"OutsideMSB_Click"===e?(i.VerticalType="custom",i.VerticalId="External"):"WorkScopeItem_Click"===e?(i.VerticalType="custom",i.VerticalId="WorkScopeItem"):bs(e,"ScopeCard_Click")?(i.VerticalType="custom",i.verticalId=e.slice(0,-"_ScopeCard_Click".length)):(i.VerticalType="custom",i.VerticalId=o);break;case"PaginationClicked":var s=t.pageNumber;s&&(i.PageId=s);break;case"ExpandLinkClicked":i.GroupId=o,Et(e,"_SeeMore")||bs(e,"See_Results_Click")?i.ExpansionType="Vertical":(bs(e,"SeeAllMembers_Click")||ys(e,"Person_"))&&(i.ExpansionType="People");break;case"DismissClicked":t.groupReferenceId&&(i.GroupId=t.groupReferenceId);break;case"PreviewOpen":case"PreviewClose":case"MouseHover":case"SearchBoxFocus":case"SearchDone":case"ExitSearch":case"UpScopeSearch":case"FilterPaneClicked":case"FilterModified":case"ClearFilters":case"ScrollBarMoved":case"ExpandHiddenItems":case"PeoplePillRemoved":case"ScopePaneClicked":case"CrossEntryPointNavigationDone":case"PrivacyInformationClicked":break;default:Object(Mt.a)(r)}return i}function ws(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=e.eventId,o=e.properties,a=xs(i,o,n),s=Ss(i,o,a.EventType,null===(t=o)||void 0===t?void 0:t.entityAttributes);return ls(ms(!!n),a,r,s)}function xs(e,t,r){var n=t.traceId,i=r?function(e,t){var r=t.target;return{Id:t.id||"",EventType:ks(e,t),Scope:r||""}}(e,t):function(e,t){var r=t.target;return{EventType:Ts(e),Scope:r||""}}(e,t),o=ds(t,n);return Object(Pt.a)(i,o)}var Cs=function(e,t){return Mi(e,t)},Os=function(e,t){return Mi(e,t)};function Es(e){switch(e){case"Search_RoundTripTime":return"Search";case"Files_RoundTripTime":case"ExperimentalFiles_RoundTripTime":case"Sites_RoundTripTime":case"ExperimentalSites_RoundTripTime":case"FilesAndSites_RoundTripTime":case"ExperimentalFilesAndSites_RoundTripTime":case"Productivity_Files_RoundTripTime":return"SharePoint";case"Conversations_RoundTripTime":return"TeamsYammer";case"SubstrateAsyncSearch_RoundTripTime":case"SubstrateSearch_RoundTripTime":case"SubstrateUnifiedSearch_RoundTripTime":case"SubstrateSearchFiles_RoundTripTime":case"SubstrateSearchSites_RoundTripTime":case"SubstrateSearchFilesAndSites_RoundTripTime":case"SubstrateSearchAll_RoundTripTime":case"SubstrateToken_RoundTripTime":case"SubstrateWarmup_RoundTripTime":case"SubstrateSharePoint_RoundTripTime":case"SubstrateSearchPersons_RoundTripTime":case"SubstrateSearchMessages_RoundTripTime":return"SubstrateSearch";case"FetchTenantSettings_RoundTripTime":return"TenantSettings";case"SubstratePowerBi_RoundTripTime":return"PowerBi";case"Person_Groups_RoundTripTime":return"Person_Groups";case"Person_Files_RoundTripTime":case"Person_ExperimentalFiles_RoundTripTime":return"Person_SharePoint";case"Person_OrgChart_RoundTripTime":case"Person_LokiOrgChart_RoundTripTime":return"Person_OrgChart";case"Person_Calendar_RoundTripTime":return"Person_Calendar";case"Person_ListDetails_RoundTripTime":return"Person_ListDetails";case"Person_Photo_RoundTripTime":return"Person_Photo";case"Person_Classes_RoundTripTime":return"Person_Classes";case"FloorPlan_Room_RoundTripTime":return"FloorPlan_Room";case"FloorPlan_RoundTripTime":return"FloorPlan";case"FloorPlan_VenueMap_RoundTripTime":return"FloorPlan_VenueMap";case"FloorPlan_VenueMapDataByEmail_RoundTripTime":case"FloorPlan_MeetingRoomsDataByEmail_RoundTripTime":return"FloorPlan_VenueMapDataByEmail";case"FloorPlan_SchedulesOfMeetingRooms_RoundTripTime":return"FloorPlan_SchedulesOfMeetingRooms";case"FederatedSearchSettings_RoundTripTime":return"FederatedSearchSettings";case"FederatedSearch_RoundTripTime":return"FederatedSearch";case"GetUserConfigs_RoundTripTime":return"UserConfigs";case"BookmarkUserSuggestion_RoundTripTime":return"BookmarkUserSuggestion";case"Calendar_MeetingList_RoundTripTime":case"Calendar_MeetingDetails_RoundTripTime":case"Calendar_MeetingLocation_RoundTripTime":case"Calendar_PersonAvailability_RoundTripTime":case"Calendar_EventCreationData_RoundTripTime":case"Productivity_MeetingList_RoundTripTime":case"Productivity_MeetingDetails_RoundTripTime":return"Calendar";case"Graph_PreviewUrl_RoundTripTime":case"Graph_ProfilePhoto_RoundTripTime":case"Graph_UserProperties_RoundTripTime":return"Graph";case"Group_GroupMembers_RoundTripTime":case"Group_GroupPhoto_RoundTripTime":return"Group";case"EmployeeOffer_OfferImage_RoundTripTime":return"EmployeeOffer";case"Turing_RoundTripTime":return"Turing";case"UserToken_RoundTripTime":case"BfbAccessToken_RoundTripTime":case"GetLokiUserToken_RoundTripTime":return"UserToken";case"Topic_PostFeedback_RoundTripTime":case"Topic_LokiPostFeedback_RoundTripTime":case"Topic_QuestionPrimer_RoundTripTime":case"Topic_LokiQuestionPrimer_RoundTripTime":case"Topic_QuestionId_RoundTripTime":case"Topic_ProcessFeedback_RoundTripTime":return"Topic";case"Notification_RoundTripTime":case"UpdateNotification_RoundTripTime":case"Productivity_Notification_RoundTripTime":return"Notification";case"AutoSuggestion_RoundTripTime":return"AutoSuggestion";case"IndustryNews_RoundTripTime":return"NewsFeed";case"NewsOptions_RoundTripTime":return"NewsOptions";case"NewsIndustry_RoundTripTime":return"NewsIndustry";case"NewsUserInfo_GetNews_RoundTripTime":case"NewsUserInfo_Profile_RoundTripTime":case"NewsUserInfo_Newsletter_RoundTripTime":return"NewsUserInfo";case"LoadLastUserInfo_RoundTripTime":case"FetchUserInfo_RoundTripTime":return"UserInfo";case"Productivity_CompanyNews_RoundTripTime":case"Productivity_CompanyNewsImage_RoundTripTime":return"CompanyNews";case"Productivity_TopQueries_RoundTripTime":case"Productivity_TopBookmarks_RoundTripTime":return"TopQuery";case"VerticalConfig_RoundTripTime":return"VerticalConfig";case"TenantFeedbackToken_RoundTripTime":return"TenantFeedback";case"PowerAppToken_RoundTripTime":return"PowerApp";case"RelatedSearches_RoundTripTime":return"RelatedSearches";case"SubstrateConnector_RoundTripTime":case"LokiConnector_RoundTripTime":return"Connector";case"EnterpriseSubscription_RoundTripTime":return"EnterpriseSubscription";case"EnterpriseSuggestion_RoundTripTime":return"EnterpriseSuggestion";case"EduAssignmentSubmission_RoundTripTime":return"EduAssignmentSubmission";case"QueryFormulation_Server_RoundTripTime":case"QueryFormulation_Client_RoundTripTime":return"MsbEmptySuggestion";default:return Object(Mt.a)(e)}}function Ps(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.eventId,n=e.properties,i=Is(r,n),o=Cs(n,r);return ls("ClientDataSource",i,t,o)}function Is(e,t){var r=t.impressionType,n=t.scenarioName,i=t.part,o=t.results,a=t.conversationId,s=t.traceId,c=t.tid,u={ConversationId:a||"",ImpressionType:r,ScenarioName:n,ProviderName:Es(e),Part:i,Results:o},l=ds(t,s||c);return Object(Pt.a)(u,l)}var As=function(e){return Mi(e)};function Rs(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.properties,n=js(r),i=As(r);return ls("ClientLayout",n,t,i)}function js(e){var t=e.layoutType,r=e.part,n=e.resultsView,i=e.placeholderId,o={LayoutType:t,VerticalType:e.verticalType,VerticalId:e.verticalId,Part:r,ResultsView:n,PlaceholderId:i,EntityAttributes:e.entityAttributes},a=ps(e);return Object(Pt.a)(o,a)}function Ds(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.properties,n=Ms(r);return ls("CounterFactualInformation",n,t)}function Ms(e){var t=e.TriggerConditions,r={TriggerConditions:dt()(t)},n=function(e){return{LogicalId:e.logicalSearchId||"",Version:"2",LocalTime:ss(new Date)}}(e);return Object(Pt.a)(r,n)}function Ls(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.eventId,n=e.properties,i=Fs(r,n),o=Os(n,r);return ls("ResponseReceived",i,t,o)}function Fs(e,t){var r=t.duration,n=t.status,i=t.traceId,o=t.logicalSearchId,a={ProviderName:Es(e),Latency:r||"0",Status:n||"0"},s=hs(t,i||("200"!==n?o:void 0));return Object(Pt.a)(a,s)}var Bs=function(e,t){return Mi(t,e)};function Ns(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.properties,n=Ws(r),i=Bs(null==r?void 0:r.impressionEventId,r);return ls("ResultsRendered",n,t,i)}function Ws(e){var t=e.E2ELatency,r=e.traceId,n={E2ELatency:t,Page:e.page,StartTime:e.startTime,EndTime:e.endTime,ImpressionEventId:e.impressionEventId,NoResultsPage:e.noResultsPage,PageNumber:e.pageNumber},i=hs(e,r);return Object(Pt.a)(n,i)}function Us(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.properties,n=zs(r);return ls("SearchFeedback",n,t)}function zs(e){var t={Id:e.Id,FeedbackResponse:e.FeedbackResponse},r=function(e){return{LogicalId:e.logicalSearchId||"",Version:"2",LocalTime:ss(new Date)}}(e);return Object(Pt.a)(t,r)}function qs(e){if(fs(e.featureName)){switch(e.featureName){case"MicrosoftSearchClientLayoutEvent":return Rs(e,!1);case"MicrosoftSearchClickEvent":return ws(e,!1);case"MicrosoftSearchClickEntityEvent":return ws(e,!1,!0);case"MicrosoftSearchClientDataSourceEvent":return Ps(e,!1);case"MicrosoftSearchRoundTripTimeEvent":return Di(e.eventId,"ResponseReceived")?Ls(e,!1):void 0;case"MicrosoftSearchResultsRenderedEvent":return Ns(e,!1);case"MicrosoftSearchFeedbackEvent":return Us(e,!1);case"MicrosoftSearchCounterFactualInformationEvent":return Ds(e,!1);case"MicrosoftSearchCachedContentRenderedEvent":return vs(e,!1);default:return}}}var Qs=r(159),Gs=r.n(Qs),Hs=r(81),Vs=r(43);var Ks=function(e,t,r){(void 0!==r&&!Object(Vs.a)(e[t],r)||void 0===r&&!(t in e))&&Object(Hs.a)(e,t,r)},Zs=r(79),Js=Function.prototype,Xs=Object.prototype,Ys=Js.toString,$s=Xs.hasOwnProperty,ec=Ys.call(Object);var tc=function(e){if(!Object(W.a)(e)||"[object Object]"!=Object(N.a)(e))return!1;var t=zr(e);if(null===t)return!0;var r=$s.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ys.call(r)==ec},rc=r(63);var nc=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var ic=function(e){return Object(tn.a)(e,Xr(e))};var oc=function(e,t,r,n,i,o,a){var s=nc(e,r),c=nc(t,r),u=a.get(c);if(u)Ks(e,r,u);else{var l=o?o(s,c,r+"",e,t,a):void 0,f=void 0===l;if(f){var d=Object(ae.a)(c),p=!d&&Object(xn.a)(c),h=!d&&!p&&Object(rc.a)(c);l=c,d||p||h?Object(ae.a)(s)?l=s:it(s)?l=Ar(s):p?(f=!1,l=Object(on.a)(c,!0)):h?(f=!1,l=mn(c,!0)):l=[]:tc(c)||Object(Ce.a)(c)?(l=s,Object(Ce.a)(s)?l=ic(s):Object(B.a)(s)&&!Object(Zs.a)(s)||(l=wn(c))):f=!1}f&&(a.set(c,l),i(l,c,n,o,a),a.delete(c)),Ks(e,r,l)}};var ac=function e(t,r,n,i,o){t!==r&&Fe(r,(function(a,s){if(o||(o=new Y.a),Object(B.a)(a))oc(t,r,s,n,e,i,o);else{var c=i?i(nc(t,s),a,s+"",t,r,o):void 0;void 0===c&&(c=a),Ks(t,s,c)}}),Xr)},sc=r(118),cc=Object(sc.a)((function(e,t,r){ac(e,t,r)}));var uc=function(){return(uc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},lc=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},fc=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function dc(e,t,r,n,i,o){void 0===r&&(r=e);var a,s,c,u,l,f=!1,d=!1;function p(e){return e.then((function(e){return h(),e}),(function(e){throw h(),e}))}function h(){if(i&&a){var e=s||pc(a,!1,"soft timeout; retry succeeded");i(e,u,l)}}function v(){return lc(this,void 0,void 0,(function(){var t,p,h;return fc(this,(function(v){switch(v.label){case 0:a={startTime:new Date},v.label=1;case 1:return v.trys.push([1,3,,8]),[4,e()];case 2:return p=v.sent(),f=!0,i&&(s=pc(a,!0)),[2,p];case 3:if(t=v.sent(),i&&(s=pc(a,!1,t)),o||n&&t&&n(t))return d=!0,[2,Promise.reject(t)];if(d)return[2,Promise.reject("Another retry has already been attempted.")];d=!0,c={startTime:new Date,isDelayedRetry:!1},v.label=4;case 4:return v.trys.push([4,6,,7]),[4,r()];case 5:return p=v.sent(),l=!f,f=!0,i&&(u=pc(c,!0)),[2,p];case 6:return h=v.sent(),i&&(u=pc(c,!1,h)),[2,Promise.reject(h)];case 7:return[3,8];case 8:return[2]}}))}))}if(!t)return p(v());var g,_=new Promise((function(e,n){function o(){if(f||d)return clearInterval(a),clearTimeout(s),n()}var a=setInterval(o,20);o();var s=setTimeout((function(){if(clearInterval(a),f||d)return n();d=!0,c={startTime:new Date,isDelayedRetry:!0},r().then((function(t){i&&c&&(l=!f,u=pc(c,!0)),e(t)}),(function(e){i&&c&&(u=pc(c,!1,e)),n(e)}))}),t)}));return p((g=[v(),_],new Promise((function(e,t){var r,n=0,i=ii(g);0===i&&e(),Pr(g,(function(o){o.then((function(t){return e(t)}),(function(e){if(n++,null!=e&&(r=e),n>=i)return t(r)}))}))}))))}function pc(e,t,r){return uc(uc({},e),{durationInMs:(new Date).getTime()-e.startTime.getTime(),succeeded:t,error:r})}function hc(e,t){var r=vc();return{iframe:r,initialize:function(){return document.body.contains(r)||(r.src=e,r.style.display="none",document.body.appendChild(r)),r},postMessage:function(n,i,o){var a=function(e,n){return gc(r.contentWindow,t,e,n)}(i,o);return r.contentWindow&&r.contentWindow.postMessage(n,e),a}}}var vc=function(){return document.createElement("iframe")},gc=function(e,t,r,n){return new Promise((function(i,o){return _c((function a(s){if(s.source===e&&s.origin===t){var c=void 0,u=!1;try{c=r(s)}catch(e){return yc(a),void o(e)}try{u=n(c,s)}catch(e){return yc(a),void o(e)}u&&(yc(a),i(c))}}))}))},_c=function(e){return addEventListener("message",e,!1)},yc=function(e){return removeEventListener("message",e,!1)};function bc(e,t,r){throw function(e,t,r){var n;return t&&t.safeToLog?(n=new Error(e+" "+t.message)).innerError=t:n=new Error(e),n.safeToLog=!0,n.logProperties=r,Object.freeze(n),n}(e,t,r)}function mc(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://"+e}var kc=function(){return(kc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Tc=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},Sc={},wc={},xc={};function Cc(e){return Sc[e]?Sc[e]:function(e,t,r){if(e){var n=document.getElementById("ms-searchux-3s-proxy"),i=function(e,t){if(e&&e.src===t&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(n,t);Sc[r]=i||Oc(!n,t,r)}else Sc[r]=Oc(!1,t,r);return Sc[r]}((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function Oc(e,t,r){var n=hc(t,r),i=n.initialize(),o=gc(i.contentWindow,r,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(i.id="ms-searchux-3s-proxy",i.postMessage=n.postMessage,i.ready=o),kc(kc({},n),{ready:o})}var Ec=function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=mc(t),xc[t]?Pc(e,t):function(e){return void 0===e&&(e="https://substrate.office.com"),e=mc(e),void 0===wc[e]&&(wc[e]=Cc(e).ready),wc[e].then((function(){return xc[e]=!0,function(t){return Pc(t,e)}}))}(t).then((function(t){return t(e)}))};function Pc(e,t){var r=Wi(),n=e.action,i=e.token,o=e.prefix,a=e.cvid,s=e.additionalInfo,c=e.headers;return Cc(t).postMessage(JSON.stringify({requestId:r,action:n,token:i,prefix:o,cvid:a,additionalInfo:s,headers:c}),Ic,(function(e){return e.requestId===r}))}function Ic(e){try{return JSON.parse(e.data)}catch(e){return bc("Failed to parse substrate API JSON response.")}}var Ac=function(){return(Ac=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Rc=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},jc=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Dc(e,t){return Rc(this,void 0,void 0,(function(){var r,n,i,o,a,s,c,u,l,f,d,p,h,v,g,_,y,b;return jc(this,(function(m){switch(m.label){case 0:if(r=Wi(),n=e.action,i=e.cvid,o=e.prefix,a=e.token,s=e.headers,c=e.additionalInfo,!(u=function(e,t){var r=function(e){switch(e){case"getsuggestions":return{path:"suggestions",version:"v1",webMethodType:"GET"};case"init":return{path:"init",version:"v1",webMethodType:"GET"};case"initv2":return{path:"init",version:"v2",webMethodType:"GET"};case"logevents":return{path:"events",version:"v1",webMethodType:"POST"};case"query":return{path:"query",version:"v1",webMethodType:"POST"};case"queryv2":return{path:"query",version:"v2",webMethodType:"POST"};case"adaptiveactions":return{path:"adaptiveactions",version:"v1",webMethodType:"POST"};case"resolveEntitiesAsync":return{path:"resolveEntitiesAsync",version:"v1",webMethodType:"POST"};case"spoquery":return{path:"sharepoint/spoquery",version:"v1",webMethodType:"POST"};default:return}}(e);if(r){var n=r.path,i=r.version,o=r.webMethodType;return{url:mc(t)+"/search/api/"+i+"/"+n,webMethodType:o}}}(n,t)))throw"No base url found for the given action type";return(l=function(e,t,r){var n={};switch(e){case"init":case"initv2":case"query":t&&(n={cvid:t});break;case"spoquery":t&&(n={correlationId:t});break;case"getsuggestions":t&&(n={cvid:t}),n=Ac(Ac({},n),{query:r||""});break;default:return n}return n}(n,i,o))&&(c=Ac(Ac({},c),l)),(f=c&&"1"===c.diagnostics)&&(c=Ac(Ac({},c),{msgRequestId:r})),d=u.url,p=u.webMethodType,h=function(e,t){if(t)for(var r in t)if(r&&"diagnostics"!==r){var n=e.indexOf("?")>-1?"&":"?";e+=""+n+encodeURIComponent(r)+"="+encodeURIComponent(t[r])}return e}(d,c),[4,function(e,t,r,n,i){var o=new Ut(e,t,0,!1,n,!0);o.setHeader("Authorization","Bearer "+r),o.setHeader("Accept","application/json");var a=!0;if(i)for(var s in i)if(s){var c=s.toUpperCase();c==="Content-Type".toUpperCase()&&(a=!1),c!=="Accept".toUpperCase()&&c!=="Authorization".toUpperCase()&&o.setHeader(s,i[s])}"POST"===t&&a&&o.setHeader("Content-Type","application/json");return o}(h,p,a,o,s).go()];case 1:return v=m.sent(),g={prefix:o||"",qfResponse:v.Body,requestId:r,responseHeaders:JSON.stringify(v.Headers),statusCode:v.StatusCode},f&&performance&&(_=performance.getEntriesByType("resource"),y="msgRequestId="+r,(b=_.filter((function(e){return e.name.substr(-y.length)===y})))&&(g=Ac(Ac({},g),{diagnostics:JSON.stringify(b)}))),[2,g]}}))}))}function Mc(){return""}var Lc={register:Mc,unregister:Mc,dispatch:Mc};function Fc(){return Lc}var Bc=function(e,t,r){try{return(t||Nc)(e)}catch(e){return r}},Nc=function(){return{}};function Wc(e){try{var t=e.parsedBody;return t.error&&t.error.code}catch(e){return null}}function Uc(e,t,r){void 0===r&&(r=!1);var n,i=-1,o="Unknown",a="Unknown",s="Unknown",c="Unknown",u="Unknown",l=null,f=""!==t;try{var d=JSON.parse(e.responseHeaders);i=d["x-end2endlatencyms"]||-2,o=d["x-calculatedbetarget"]||"NotProvided",a=d["request-id"]||"NotProvided",s=d["x-msedge-ref"]||"NotProvided",c=d["x-besku"]||"NotProvided",u=d["x-searchplatform"]||"NotProvided"}catch(e){}try{r&&(l=JSON.stringify(function(e){var t=JSON.parse(e)[0];return t.name,Tc(t,["name"])}(e.diagnostics)))}catch(e){}return n=function(e){try{var t=e.parsedBody;return t.Instrumentation&&t.Instrumentation.TraceId}catch(e){return null}}(e),{status:e.statusCode,serverLatency:i,serverName:o,requestId:n||a,msEdgeReference:s,anchorMailboxSet:f,xBeSku:c,searchPlatform:u,error:Wc(e),diagnostics:l}}function zc(e,t,r,n,i,o,a,s,c,u,l,f,d,p){void 0===f&&(f=!1);var h,v,g,_,y,b,m=Wi(),k=function(e){return function(e,t){var r=t.anchorMailbox,n=t.version,i=t.clientRequestId,o=t.logicalSearchId,a=t.conversationId,s=Uc(e,r,t.logDiagnosticsMetrics);return{traceId:s.requestId||i,version:n,status:e.statusCode,properties:Object(dr.__assign)(Object(dr.__assign)({},s),{logicalSearchId:o,clientRequestId:i,conversationId:a})}}(e,{anchorMailbox:c,logDiagnosticsMetrics:f,clientRequestId:m,conversationId:i,logicalSearchId:o,version:2})};return(v=qc,g=(h={monitorName:t,factoryErrorPropExtractor:function(e){return{version:2,status:0,properties:{promiseFactoryFailed:!0}}},successPropExtractor:k,failurePropExtractor:k}).monitorName,_=h.factoryErrorPropExtractor,y=h.successPropExtractor,b=h.failurePropExtractor,function(e){var t,r=Math.round(performance.now()),n=Fc();function i(e,t){var i=Math.round(performance.now())-r;n.dispatch({eventType:"QOSSTOP",name:"ResponseReceived",result:e,nameDetail:g,startTimestamp:r,totalTime:i,properties:{LogicalId:t.properties&&t.properties.logicalSearchId,ConversationId:t.properties&&t.properties.conversationId,Version:t.version,TraceId:t.traceId,Status:t.status,ProviderName:t.providerName,Latency:i,properties:JSON.stringify(t.properties)}})}n.dispatch({eventType:"QOSSTART",name:"ResponseReceived",nameDetail:g,timestamp:r});try{t=v(e)}catch(e){return i("FAILURE",Bc(e,_,{status:0,properties:{promiseFactoryFailed:!0}})),Promise.reject(e)}return t.then((function(e){return i("SUCCESS",Bc(e,y,{status:0,properties:{successExtractorFailed:!0}})),Promise.resolve(e)}),(function(e){return i("FAILURE",Bc(e,b,{status:0,properties:{failureExtractorFailed:!0}})),Promise.reject(e)}))})({action:e,token:r,query:n,cvid:i,logicalSearchId:o,additionalInfo:Object(dr.__assign)(Object(dr.__assign)({},Gc(f)),a),additionalHeaders:Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)({"Client-Request-Id":m},c&&{"X-AnchorMailbox":c}),u&&{"X-Client-Language":u}),l&&{"X-Client-Flights":l}),Qc()),s),substrateHostName:d,substrateHostNameWithIFrame:p})}function qc(e){var t=e.action,r=e.token,n=e.query,i=e.cvid,o=e.additionalInfo,a=e.substrateHostName,s=e.substrateHostNameWithIFrame,c={action:t,token:r,prefix:n,cvid:i,additionalInfo:o,headers:Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)({},Qc()),e.additionalHeaders),{LogicalId:e.logicalSearchId})};return(a&&!s?Dc(c,a):Ec(c,a)).then((function(e){var t=Object(dr.__assign)({},e);try{t.parsedBody=JSON.parse(t.qfResponse)}catch(e){}if(200!==t.statusCode)throw t;return t}))}function Qc(){return{Accept:"application/json;odata=verbose","Content-Type":"application/json","X-Client-LocalTime":ss(new Date),"X-Client-Version":"1.20210728.1.0"}}function Gc(e){return void 0===e&&(e=!1),{diagnostics:e?"1":"0"}}var Hc=function(){function e(e,t,r,n,i,o){var a,s=this;this._batchTimeout=t,this._getAuthToken=r,this._xAnchorMailbox=n,this.locale=i,this.substrateHostName=o,this._batch={},this._authToken="",this._retriesRemaining=5,this._logBatchAfterTimeout=0,this._timerIsRunning=!1,this._localStorageAvailable=!1,this._localStorageAvailable="undefined"!=typeof localStorage&&!!localStorage,this.getBatchFromLocalStorage(),this._additionalInfo=((a={}).scenario=e,a),r().then((function(e){return s._authToken=e.token}))}return e.prototype.logEvent=function(e,t,r){this.addEvent(t,this.formatEvent(e),r),this._timerIsRunning||(this.resetRetryCounter(),this.startTimer())},e.prototype.flush=function(){clearTimeout(this._logBatchAfterTimeout),this.batchFlush()},e.prototype.getBatch=function(){return this._batch},e.prototype.testLogBatch=function(){return Object(dr.__awaiter)(this,void 0,void 0,(function(){return Object(dr.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.logBatch()];case 1:return e.sent(),[2]}}))}))},e.prototype.testMergeBack=function(){var e=this.getBatchToSend();this.mergeBack(e.batch)},e.prototype.batchFlush=function(){if(!Object(St.a)(this._batch)&&(this.getBatchFromLocalStorage(!1),!Object(St.a)(this._authToken))){var e=this.getBatchToSend(),t=this.substrateHostName?0===this.substrateHostName.toLocaleLowerCase().indexOf("http://")||0===this.substrateHostName.toLocaleLowerCase().indexOf("https://")?this.substrateHostName:"https://"+this.substrateHostName:void 0;!function(e,t,r,n,i,o){var a=Wi(),s=Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)(Object(dr.__assign)({Authorization:"Bearer "+t},{"Client-Request-Id":a}),n&&{"X-AnchorMailbox":n}),i&&{"X-Client-Language":i}),o&&{"X-Client-Flights":o}),Qc()),c=new XMLHttpRequest;c.open("POST",e),Pr(s,(function(e,t){c.setRequestHeader(t,e)})),c.send(r)}("{0}/search/api/v1/events?scenario={1}".replace("{0}",t||"https://substrate.office.com").replace("{1}",this._additionalInfo.scenario),this._authToken,dt()(e.body),this._xAnchorMailbox,this.locale),lt("Event Logged to 3s Events API on Flush:\n",{batchToSend:e.batch,body:e.body},"\nTime: ",Math.floor(Gs()()))}},e.prototype.formatEvent=function(e){return{Name:e.Name,Attributes:ze(en(e.Attributes,(function(e,t){return!e||!t})),(function(e,t){return{Key:t,Value:null==e?void 0:e.toString()}}))}},e.prototype.logBatch=function(){return Object(dr.__awaiter)(this,void 0,void 0,(function(){var e,t,r=this;return Object(dr.__generator)(this,(function(n){switch(n.label){case 0:if(this._timerIsRunning=!1,Object(St.a)(this._batch))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._getAuthToken()];case 2:return e=n.sent(),this._authToken=e.token,[3,4];case 3:return n.sent(),lt("3sEventsAPI: failure getting token"),[2];case 4:return this._authToken?(t=this.getBatchToSend(),dc((function(){return zc("logevents","search-3s-logging",r._authToken,dt()(t.body),void 0,void 0,r._additionalInfo,void 0,r._xAnchorMailbox,r.locale,void 0,!1,r.substrateHostName)})).then((function(e){var r;lt("3sEventsAPI: batch logged successfully with TraceId:\n"+(null===(r=e.parsedBody)||void 0===r?void 0:r.Instrumentation.TraceId)+"\n",{batchToSend:t.batch,body:t.body},"\nTime: ",Math.floor(Gs()()))})).catch((function(e){var n,i,o,a;lt("3sEventsAPI: call failure, with TraceId: "+(null===(i=null===(n=e.parsedBody)||void 0===n?void 0:n.Instrumentation)||void 0===i?void 0:i.TraceId)+". error message: "+(null===(a=null===(o=e.parsedBody)||void 0===o?void 0:o.error)||void 0===a?void 0:a.message)),r.mergeBack(t.batch)})),[2]):(lt("3sEventsAPI:empty substrate auth token. Aborting events API call"),[2])}}))}))},e.prototype.mergeBack=function(e,t){void 0===t&&(t=!0),Object(St.a)(this._batch)?this._batch=e:this._batch=cc(this._batch,e),!this._timerIsRunning&&this._retriesRemaining>0&&t&&(this.decrementRetryCounter(),this.startTimer())},e.prototype.addEvent=function(e,t,r){void 0===r&&(r=hr()),this._batch[e]||(this._batch[e]={}),this._batch[e][r]=t},e.prototype.resetRetryCounter=function(){this._retriesRemaining=5},e.prototype.decrementRetryCounter=function(){this._retriesRemaining--},e.prototype.startTimer=function(){var e=this;this._timerIsRunning=!0,this._logBatchAfterTimeout=setTimeout((function(){return e.logBatch()}),this._batchTimeout)},e.prototype.getBatchFromLocalStorage=function(e){if(void 0===e&&(e=!0),this._localStorageAvailable){var t=localStorage.getItem("Search3sLoggingBeforeUnload");if(t&&t.length>0){var r=JSON.parse(t);1===r.LocalStorageVersion&&this.mergeBack(r.Batch,e)}var n="";!e&&ii(this._batch)<40&&(n=dt()(this.getBatchToSave())),localStorage.setItem("Search3sLoggingBeforeUnload",n)}},e.prototype.getBatchToSave=function(){return{LocalStorageVersion:1,Batch:this._batch}},e.prototype.getBatchToSend=function(){var e=this._batch;return this._batch={},{batch:e,body:ze(e,(function(e,t){return{Key:t,Value:ze(e,(function(e){return e}))}}))}},e}(),Vc=function(){function e(e,t,r,n,i,o){this._scenarioName=e,this._getAuthToken=t,this._xAnchorMailbox=r,this._batchTimeout=n||1e3,this._logManager=new Hc(this._scenarioName,this._batchTimeout,this._getAuthToken,this._xAnchorMailbox,i,o)}return e.prototype.canConsumeEvent=function(e){return!0},e.prototype.consume=function(e,t){var r=qs(e);if(r){var n=this.getKey(r);this._logManager&&n&&this._logManager.logEvent(r,n,t)}},e.prototype.flush=function(){return this._logManager&&this._logManager.flush(),L.a.resolve()},e.prototype.destroy=function(){this.flush(),delete this._logManager},e.prototype.getLogManager=function(){return this._logManager},e.prototype.getKey=function(e){var t,r;switch(e.Name){case"SearchEntityActions":case"SearchActions":case"ClientDataSource":case"ClientLayout":case"ResultsRendered":case"SearchFeedback":case"CachedContentRendered":case"CounterFactualInformation":return null===(t=null==e?void 0:e.Attributes.LogicalId)||void 0===t?void 0:t.toString();case"ResponseReceived":return null===(r=null==e?void 0:e.Attributes.TraceId)||void 0===r?void 0:r.toString();default:Object(Mt.a)(e.Name)}},e}();var Kc=/(_Start|_Success|_ExpectedFailure|_UnexpectedFailure|_UnexpectedFailure_Unknown| start| cache)$/i;function Zc(e,t){var r,n,i,o,a,s=t.userAadObjectId,c=function(e){var t=e.appName,r=e.tenantAadObjectId,n=e.userPuid,i=e.userAadObjectId;return{"UserInfo.Id":is(r)?n:i,"UserInfo.MsaId":n,"UserInfo.IdType":is(r)?ns.AWTUserIdType.MSAPUID:ns.AWTUserIdType.UserObjectId,"UserInfo.OMSTenantId":r,"AppInfo.Name":t}}({appName:"Microsoft Search",tenantAadObjectId:t.tenantAadObjectId,userAadObjectId:s,userPuid:""}),u="",l="";e.exportOptions&&(u=e.exportOptions.exportType,l=e.exportOptions.exportName);var f=(null===(n=null===(r=e.properties)||void 0===r?void 0:r.impressionGuid)||void 0===n?void 0:n.toString())||"",d=(null===(o=null===(i=e.properties)||void 0===i?void 0:i.conversationId)||void 0===o?void 0:o.toString())||"",p=(null===(a=e.properties)||void 0===a?void 0:a.timeStampDifference)?new Date((new Date).getTime()+Number(e.properties.timeStampDifference)).toISOString():"",h=yt()({},e.properties);return yt()(yt()({},c),{clientCorrelationId:f,hostClientCorrelationId:os(h,Pa),clientType:e.source,eventId:e.eventId,exportType:u,exportName:l,impressionGuid:f,conversationId:d,timeStamp:p})}function Jc(e){if(Kc.test(e.eventId))return"QoSEvent";var t=e.featureName;switch(t){case"MicrosoftSearchClickEvent":case"MicrosoftSearchClickEntityEvent":case"MicrosoftSearchDiagnosticsEvent":case"MicrosoftSearchPerformanceEvent":case"MicrosoftSearchQueryEvent":case"MicrosoftSearchRankingEvent":case"MicrosoftSearchRoundTripTimeEvent":case"MicrosoftSearchValidateEvent":case"MicrosoftSearchImpressionEvent":case"MicrosoftSearchSignInEvent":case"MicrosoftSearchSignOutEvent":case"MicrosoftSearchValueEvent":case"MicrosoftSearchQfValueEvent":case"MicrosoftSearchClientLayoutEvent":case"MicrosoftSearchClientDataSourceEvent":case"MicrosoftSearchResultsRenderedEvent":case"MicrosoftSearchCachedContentRenderedEvent":case"MicrosoftSearchAnswerResultsRenderedEvent":case"MicrosoftSearchFeedbackEvent":case"MicrosoftSearchCounterFactualInformationEvent":case"MicrosoftSearchResourcePerformanceEvent":case"MicrosoftSearchPerformanceTimingsEvent":case"MicrosoftSearchVariantEvent":case"MicrosoftSearchQfVariantEvent":case"MicrosoftSearchPrivacyEvent":case"MicrosoftSearchLatencyEvent":case"MicrosoftSearchMissingInstEvent":return"MicrosoftSearchEvent";default:return Object(Mt.b)(t,"Error")}}var Xc=function(e){var t,r=e.event,n=e.additionalProperties,i=Jc(r);switch(ji(r,n),i){case"MicrosoftSearchEvent":t=function(e){if(fs(e.featureName))switch(e.featureName){case"MicrosoftSearchClientLayoutEvent":return Rs(e);case"MicrosoftSearchClickEvent":return ws(e);case"MicrosoftSearchClickEntityEvent":return ws(e,!0,!0);case"MicrosoftSearchClientDataSourceEvent":return Ps(e);case"MicrosoftSearchRoundTripTimeEvent":return Ls(e);case"MicrosoftSearchCachedContentRenderedEvent":return vs(e);case"MicrosoftSearchCounterFactualInformationEvent":return Ds(e,!0);default:return}}(r);var o=n.isConsoleLogger;if(t&&!o&&"Office"===r.source){var a=yt()({eventType:"USAGE"},t);return void Fc().dispatch(a)}break;case"QoSEvent":case"Error":return;default:return Object(Mt.a)(i)}if(t){var s=Zc(r,n);return t.properties=Object(st.l)(t.properties||{},yt()({},s)),as(t),{awtEventData:t,dataCategories:Ba.NotSet,diagnosticLevel:Na.OptionalDiagnosticData}}};var Yc,$c=["EducationAssignment_Insight_Click","EducationAssignment_ResultListItem_Click","EducationAssignment_Hero_ResultListItem_Click","Acronym_Attribution_Click","Acronym_Expand_Text_Click","Bookmark_Click","Bookmark_Insight_Click","Bookmark_ResultListItem_Click","Connectors_ResultListItem_Click","Connectors_All_ResultCluster_ResultListItem_Click","Conversation_All_ResultCluster_ResultListItem_Click","Conversation_All_ResultListItem_Click","Conversation_All_Hero_ResultListItem_Click","Conversation_AutoExpanded_Teams_Insight_Click","Conversation_AutoExpanded_Yammer_Insight_Click","Conversation_Teams_Insight_Click","Conversation_Yammer_Insight_Click","FederatedSearch_ResultListItem_Click","File_AutoExpanded_Insight_Click","EducationAssignment_AutoExpanded_Insight_Click","File_Click","File_Insight_Click","File_ResultListItem_Click","File_Hero_ResultListItem_Click","FilesAndSites_ResultListItem_Click","Location_GetDirections_Click","Offer_Insight_Click","Offer_LocateStore_Click","Offer_ResultGridItem_Click","Offer_ResultListItem_Click","Person_About_File_Click","Person_Files_File_Click","PowerBi_AutoExpanded_Insight_Click","PowerBi_Click","PowerBi_Hero_ResultListItem_Click","PowerBi_Insight_Click","PowerBi_SeeMorePowerBi_Click","PowerBi_ResultListItem_Click","Qna_Insight_Click","Qna_Link_Click","Qna_ResultListItem_Click","Site_AutoExpanded_Insight_Click","Site_Insight_Click","Site_ResultListItem_Click","Site_Hero_ResultListItem_Click","Turing_AutoExpanded_Insight_Click","Turing_Insight_Click","Topic_Resource_Click","Topic_Link_Click","Topic_Title_Click","Topic_Definition_License_Click","IndustryNews_Carousel_NewsCard_Click","Productivity_CreateExcelSheet_Click","Productivity_CreatePowerpointPresentation_Click","Productivity_CreateWordDoc_Click","Productivity_Meeting_DeepLink_Click","Productivity_SetupAMeeting_Click"];!function(e){e[e.People=0]="People",e[e.Documents=1]="Documents",e[e.Bookmarks=2]="Bookmarks",e[e.Group=3]="Group",e[e.Buildings=4]="Buildings",e[e.PowerBi=5]="PowerBi",e[e.RefQnA=6]="RefQnA",e[e.Conversation=7]="Conversation",e[e.Sites=8]="Sites",e[e.BuildingsV2=9]="BuildingsV2",e[e.AllResults=99]="AllResults"}(Yc||(Yc={}));function eu(e){var t=e.eventId;return Sr(e.featureName,function(e,t){var r=t.eventScope,n=t.cardType,i=t.clientSize,o=t.target,a=t.index,s=t.value,c=t.queryType,u=t.queryIntent,l=t.interpretation,f=t.notificationKind,d=t.notificationCampaign,p=t.id,h=t.isHero,v=t.muid,g=t.conversationId,_=t.impressionGuid,y=t.logicalSearchId,b=t.page,m=t.placement,k=t.entityId,T=t.content,S=t.mouseX,w=t.mouseY;Et($c,e)&&function(e,t,r,n,i,o,a,s,c){var u={impressionGuid:n||"",conversationId:r||"",logicalSearchId:i||"",time:(new Date).getTime(),muid:o,eventScope:e,clickEventId:t,entityId:a,isHero:s,page:c};!function(e,t){try{window.sessionStorage&&window.sessionStorage.setItem(e,t)}catch(e){}}("bfbClickDwellLink",dt()(u))}(r,e,g,_,y,v,p,h,b);var x={eventId:e,SC:xr(r),cardType:n};n&&i&&(x.S=Cr(n,i));o&&(x.T="Tour"===r?o:function(e){switch(e){case"Person":return Yc.People;case"File":return Yc.Documents;case"Bookmark":return Yc.Bookmarks;case"Group":return Yc.Group;case"Building":return Yc.BuildingsV2;case"Conversation":return Yc.Conversation;case"Site":return Yc.Sites;case"Qna":return Yc.RefQnA;default:return e}}(o));!o&&p&&(x.T=p);a&&(x.I=a);s&&(x.value=s);c&&(x.QTYP=c);u&&(x.queryIntent=u);l&&(x.INTR=l);o&&"Bookmark"===r&&(x.TT="ACT");f&&(x.notificationKind=f);d&&(x.notificationCampaign=d);m&&(x.placement=m);k&&(x.entityId=k);T&&(x.content=T);(S||w)&&(x.mouseX=S,x.mouseY=w);var C=wr(t);return Object(Pt.a)(x,C)}(t,e.properties))}function tu(e){var t=e.eventId;return Sr(e.featureName,function(e,t){var r=t.eventScope,n=t.cardType,i=t.clientSize,o=t.target,a=t.teamsResultsCount,s=t.yammerResultsCount,c=t.index,u=t.queryType,l=t.interpretation,f=t.count,d=t.notificationKind,p=t.notificationCampaign,h=t.value,v=t.content,g=t.alreadySignedIn,_=t.ssoSignedIn,y=t.placement,b=t.entityId,m={eventId:e,SC:r&&xr(r),S:n&&Cr(n,i),cardType:n};o&&(m.T=function(e){switch(e){case"BookmarkDisambig":return"BKDSMG";case"ConversationsDisambig":return"CDSMG";case"GroupDisambig":return"GDSMG";case"PersonDisambig":return"PDSMG";case"PersonGroup":return"PGRP";case"PersonFloorplan":return"PFLP";case"Ribbon":return"GLM";default:return e}}(o));a&&(m.NT=a);s&&(m.NY=s);c&&(m.I=c);h&&(m.value=h);u&&(m.QTYP=u);l&&(m.INTR=l);f&&(m.N=f);o&&"Bookmark"===r&&(m.TT="ACT");d&&(m.notificationKind=d);p&&(m.notificationCampaign=p);v&&(m.content=v);void 0!==g&&(m.alreadySignedIn=g);void 0!==_&&(m.ssoSignedIn=_);void 0!==y&&(m.placement=y);b&&(m.entityId=b);var k=wr(t);return Object(Pt.a)(m,k)}(t,e.properties))}var ru=r(87),nu=r.n(ru),iu=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof nu.a){var i=0;for(n=nu()(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};function ou(e){var t=e.eventId;return Sr(e.featureName,function(e,t){var r=t.placement,n=t.domain,i=iu(t,["placement","domain"]),o={eventId:e,P:r,T:n},a=wr(i);return Object(Pt.a)(o,a)}(t,e.properties))}function au(e){var t=e.eventId;return Sr(e.featureName,function(e,t){var r=t.name,n=t.value,i=t.eventScope,o=t.clientSize,a=t.targetId,s=t.targetEventId,c={eventId:e,N:r,V:n,targetId:a,targetEventId:s};i&&(c.eventScope=i,c.SC=xr(i));o&&(c.clientSize=o);var u=wr(t);return Object(Pt.a)(c,u)}(t,e.properties))}function su(e){if(function(e){var t=e;switch(t){case"MicrosoftSearchClickEvent":case"MicrosoftSearchClickEntityEvent":case"MicrosoftSearchDiagnosticsEvent":case"MicrosoftSearchPerformanceEvent":case"MicrosoftSearchQueryEvent":case"MicrosoftSearchRankingEvent":case"MicrosoftSearchRoundTripTimeEvent":case"MicrosoftSearchImpressionEvent":case"MicrosoftSearchSignInEvent":case"MicrosoftSearchSignOutEvent":case"MicrosoftSearchValueEvent":case"MicrosoftSearchQfValueEvent":case"MicrosoftSearchFeedbackEvent":case"MicrosoftSearchAnswerResultsRenderedEvent":case"MicrosoftSearchResourcePerformanceEvent":case"MicrosoftSearchPerformanceTimingsEvent":case"MicrosoftSearchVariantEvent":case"MicrosoftSearchQfVariantEvent":case"MicrosoftSearchPrivacyEvent":case"MicrosoftSearchResultsRenderedEvent":case"MicrosoftSearchLatencyEvent":case"MicrosoftSearchMissingInstEvent":case"MicrosoftSearchValidateEvent":return!0;case"MicrosoftSearchClientDataSourceEvent":case"MicrosoftSearchClientLayoutEvent":case"MicrosoftSearchCachedContentRenderedEvent":case"MicrosoftSearchCounterFactualInformationEvent":return!1;default:return Object(Mt.b)(t,!1)}}(e.featureName))switch(e.featureName){case"MicrosoftSearchImpressionEvent":return tu(e);case"MicrosoftSearchClickEvent":case"MicrosoftSearchClickEntityEvent":return eu(e);case"MicrosoftSearchValueEvent":case"MicrosoftSearchQfValueEvent":return au(e);case"MicrosoftSearchRankingEvent":return ou(e);case"MicrosoftSearchFeedbackEvent":return Us(e);case"MicrosoftSearchResultsRenderedEvent":return Ns(e);default:return Sr(e.featureName,e.properties)}}var cu=function(e){var t,r=e.event,n=e.additionalProperties,i=Jc(r);switch(ji(r,n),i){case"MicrosoftSearchEvent":t=su(r);var o=n.isConsoleLogger;if(t&&!o&&"Office"===r.source&&("MicrosoftSearchFeedbackEvent"===r.featureName||"MicrosoftSearchResultsRenderedEvent"===r.featureName)){var a=yt()({eventType:"USAGE"},t);Fc().dispatch(a)}break;case"Error":t={name:"Errors",properties:r.properties};break;case"QoSEvent":return;default:Object(Mt.b)(i,function(e){var t={name:"Event"};return e&&(t.properties={eventId:e}),t}())}if(t){var s=function(e,t){var r=Zc(e,t);return yt()(yt()({},r),{version:e.version,eventType:e.type})}(r,n);return t.properties=Object(st.l)(t.properties||{},yt()({},s)),as(t),{awtEventData:t,dataCategories:Ba.NotSet,diagnosticLevel:Na.OptionalDiagnosticData}}};function uu(e,t,r){uo(e,{eventId:t,properties:r})}function lu(){({}),[],Ln(),!1,Ci(),eo.length=0,!1,!1,ro&&(clearInterval(ro),ro=void 0),void 0,function(){},0,!1,{},{},{},{},0}function fu(e){var t=e.clientType,r=e.buildVersion,n=e.conversationId,i=e.enablePrivacyCop,o=e.getSubstrateToken,a=e.loggingContext,s=e.clientId,c=a.is3sLoggingEnabled,u=a.is3SEventsLoggingEnabled,l=a.formCode,f=a.clientSize;lu(),i&&(ao=!0);var d=function(e){var t=e.loggerCallback,r=e.clientId,n=e.getSubstrateToken,i=e.loggingContext,o=i.isConsoleLoggerEnabled,a=i.is3sConsoleLoggerEnabled,s=i.is3sLoggingEnabled,c=i.is3SEventsLoggingEnabled,u=i.disableAriaLogger,l=new Ka;o&&l.registerConsumer(new Ja(cu));a&&l.registerConsumer(new Ja(hu));s&&du(l,"MicrosoftSearch3S",Xc,e);u||du(l,"MicrosoftSearch",cu,e);c&&n&&r&&function(e,t){var r=t.getSubstrateToken,n=t.clientId,i=t.scenarioName,o=t.xAnchorMailbox,a=t.useSilentSubstrate,s=t.loggingContext,c=t.substrateHostName;if(!s)return;var u=s.eventsApiTimeout,l=s.market;if(!r||!n)return;var f=new Vc($i(i,n,a),r,o,u,l,c);e.registerConsumer(f)}(l,e);t&&l.registerConsumer(new Xa(t));return l}(e),p=new Ha(Promise.resolve(d),new Va(t,r,n),(function(){return!0}),function(e){var t=e.msbApiEnvironment,r=e.impressionGuid,n=e.conversationId,i=e.loggingContext,o=e.logicalSearchId,a=e.clientId,s=e.clientType,c=e.domainsFilter,u=e.isMiniSerp;if(!i)return function(){return{}};var l=i.muid,f=i.hasMsa,d=i.aadUserId,p=i.formCode,h=i.partnerCode,v=i.market,g=i.tenantId,_=i.tenantName,y=i.dataCenter,b=i.deviceType,m=i.sessionId,k=i.canvas,T=i.environment,S=i.placeholderId,w=i.serviceGroup,x=i.traceId,C=i.puid,O=i.snrVersion,E=i.msbCode,P="Office"===k,I=i.page;if(!I)switch(s){case"Office":I=1===(null==c?void 0:c.length)?c[0]:"All";break;case"MicrosoftTeams":I="Teams";break;case"BingVertical":I="All";break;case"Bing":switch(k){case"PoleUX":I="CarouselSmall";break;case"Serp":I="Mainline";break;case"Homepage":I="Homepage"}break;case"Wsb":I=u?"CarouselSmall":"PageSmall";break;case"Owa":I="Owa"}var A=S||(P?hr():void 0),R=e.component||"Search";return function(){return{muid:l,hasMsa:f,aadUserId:d,formCode:p,partnerCode:h,market:v,tenantId:g,tenantName:_,dataCenter:y,deviceType:b,sessionId:m,canvas:k,page:I,environment:T&&ho(T)||ho(t),impressionGuid:r,conversationId:n,logicalSearchId:o,clientId:a,placeholderId:A,component:R,serviceGroup:w,tid:x,puid:C,snrVersion:O,msbCode:E}}}(e));return(null==a?void 0:a.puid)||function(e,t,r){Object(dr.__awaiter)(this,void 0,void 0,(function(){var n;return Object(dr.__generator)(this,(function(i){switch(i.label){case 0:return t&&r?(o="Puid",so.push(o),[4,pu(r)]):[2];case 1:return n=i.sent(),go(e,{puid:n}),yo("Puid",{puid:n}),[2]}var o}))}))}(p,!(!c&&!u),o),"msb.ux.workserp"===s&&""!==l&&"QBRE"!==l&&f&&uu(p,"CrossEntryPoint_Work_Navigation",{eventScope:"Page",clientSize:f}),p}function du(e,t,r,n){var i=n.culture,o=n.loggingContext,a={isGDPRIntegratedLoggerDisabled:!0,forceIntegratedLogger:!1,tenant:t,environment:n.isDev?"Dev":"Prod"},s=new rs(o&&o.aadUserId||"","","",i||"",r,a);e.registerConsumer(s)}function pu(e){var t,r;return Object(dr.__awaiter)(this,void 0,void 0,(function(){var n;return Object(dr.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e()];case 1:return n=null===(t=i.sent())||void 0===t?void 0:t.token,[2,null===(r=JSON.parse(atob(n.split(".")[1])))||void 0===r?void 0:r.puid];case 2:return i.sent(),[2];case 3:return[2]}}))}))}var hu=function(e){var t=qs(e.event);if(t)return as(t),{awtEventData:t,dataCategories:Ba.NotSet,diagnosticLevel:Na.OptionalDiagnosticData}},vu=Array.prototype.join;var gu=function(e,t){return null==e?"":vu.call(e,t)};function _u(e,t){t&&t.variants&&function(e,t){var r,n=Object(re.a)(t),i={variants:Object(St.a)(n)?"":gu(ze(n,(function(e){return e+":"+t[e]})),"&")},o="ClientQF"===(null===(r=e.getStaticProperties()())||void 0===r?void 0:r.component);lo(e,{eventId:"Variants",properties:i},o)}(e,t.variants)}var yu;function bu(e){var t=e.clientCorrelationId,r=e.loggingContext,n=e.environment,i=e.culture,o=e.clientType,a=e.isMiniSerp,s=e.clientId,c=e.getSubstrateToken,u=e.substrateHostName,l=t||hr(),f=fu({msbApiEnvironment:n,conversationId:l,impressionGuid:l,culture:i,buildVersion:"1.20210728.1.0",clientType:o,loggingContext:r,isDev:!1,logicalSearchId:e.logicalSearchId||hr(),component:"ClientQF",isMiniSerp:a,clientId:s,getSubstrateToken:c,substrateHostName:u});return _u(f,r),f}!function(e){e[e.ProbeLoaded=0]="ProbeLoaded",e[e.OnLoaded=1]="OnLoaded",e[e.ProbeInitialized=2]="ProbeInitialized",e[e.Initialize=3]="Initialize",e[e.OnInitialize=4]="OnInitialize",e[e.OnDataLoaded=5]="OnDataLoaded",e[e.InitializeHost=6]="InitializeHost",e[e.OnInitializeHost=7]="OnInitializeHost",e[e.Localize=8]="Localize",e[e.OnLocalize=9]="OnLocalize",e[e.PostLoad=10]="PostLoad",e[e.OnPostLoad=11]="OnPostLoad",e[e.GetSuggestions=12]="GetSuggestions",e[e.OnGetSuggestions=13]="OnGetSuggestions",e[e.GetExtraSuggestions=14]="GetExtraSuggestions",e[e.OnGetExtraSuggestions=15]="OnGetExtraSuggestions",e[e.GetZeroQfSuggestions=16]="GetZeroQfSuggestions",e[e.OnGetZeroQfSuggestions=17]="OnGetZeroQfSuggestions",e[e.SignIn=18]="SignIn",e[e.OnSignIn=19]="OnSignIn",e[e.SignOut=20]="SignOut",e[e.OnSignOut=21]="OnSignOut",e[e.SoftSignOut=22]="SoftSignOut",e[e.OnSoftSignOut=23]="OnSoftSignOut",e[e.RefreshData=24]="RefreshData",e[e.OnRefreshData=25]="OnRefreshData",e[e.RebuildData=26]="RebuildData",e[e.OnRebuildData=27]="OnRebuildData",e[e.ClearTrie=28]="ClearTrie",e[e.OnClearTrie=29]="OnClearTrie",e[e.SaveTrie=30]="SaveTrie",e[e.OnSaveTrie=31]="OnSaveTrie",e[e.DeleteData=32]="DeleteData",e[e.OnDeleteData=33]="OnDeleteData",e[e.setAccessToken=34]="setAccessToken",e[e.logRoundTripData=35]="logRoundTripData",e[e.logGroupClientLayout=36]="logGroupClientLayout",e[e.OnHandleTenantSwitch=37]="OnHandleTenantSwitch",e[e.HandleTenantSwitch=38]="HandleTenantSwitch"}(yu||(yu={}));var mu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},ku=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Tu(e,t){return mu(this,void 0,void 0,(function(){var r;return ku(this,(function(n){switch(n.label){case 0:return r=e.createRequestUrl("bookmarks"),[4,e.makeRequest(r,"POST",t)];case 1:return[2,n.sent()]}}))}))}function Su(e,t){return mu(this,void 0,void 0,(function(){var r,n,i;return ku(this,(function(o){switch(o.label){case 0:r=[],n=void 0,o.label=1;case 1:return[4,Tu(e,{clientContext:{clientType:t},continuationToken:n})];case 2:i=o.sent(),n=i.continuationToken,i.results&&(r=r.concat(i.results)),o.label=3;case 3:if(n)return[3,1];o.label=4;case 4:return[2,r]}}))}))}var wu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},xu=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Cu(e,t){return wu(this,void 0,void 0,(function(){var r;return xu(this,(function(n){switch(n.label){case 0:return r=e.createRequestUrl("buildings"),[4,e.makeRequest(r,"POST",t)];case 1:return[2,n.sent()]}}))}))}function Ou(e,t){return wu(this,void 0,void 0,(function(){var r,n,i;return xu(this,(function(o){switch(o.label){case 0:r=[],n=void 0,o.label=1;case 1:return[4,Cu(e,{clientContext:{clientType:t},continuationToken:n})];case 2:i=o.sent(),n=i.continuationToken,i.results&&(r=r.concat(i.results)),o.label=3;case 3:if(n)return[3,1];o.label=4;case 4:return[2,r]}}))}))}var Eu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Pu=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Iu(e,t){return Eu(this,void 0,void 0,(function(){var r;return Pu(this,(function(n){switch(n.label){case 0:return r=e.createRequestUrl("featuredqueries"),[4,e.makeRequest(r,"GET",t)];case 1:return[2,n.sent()]}}))}))}function Au(e,t){return Eu(this,void 0,void 0,(function(){var r,n,i;return Pu(this,(function(o){switch(o.label){case 0:return r=[],[4,Iu(e,{clientContext:{clientType:t}})];case 1:return n=o.sent(),i=function(e){var t=new Array;if(!e)return t;for(var r=0,n=e;r<n.length;r++){var i=n[r],o={entity:{displayText:"",queryIntent:"",domain:"EducationAssignment",id:"",url:""},secondaryQueries:[],definitiveQueries:[]};o.entity.displayText=i.featuredQuery,o.secondaryQueries=i.supportedQueries,o.definitiveQueries=i.supportedQueries,o.entity.queryIntent=i.queryIntent,t=t.concat(o)}return t}(n.results),[2,r=r.concat(i)]}}))}))}var Ru=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},ju=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof gt.a&&(o[ht.a]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Du(e,t){return Ru(this,void 0,void 0,(function(){var r;return ju(this,(function(n){switch(n.label){case 0:return r=e.createRequestUrl("qnas"),[4,e.makeRequest(r,"POST",t)];case 1:return[2,n.sent()]}}))}))}function Mu(e,t){return Ru(this,void 0,void 0,(function(){var r,n,i;return ju(this,(function(o){switch(o.label){case 0:r=[],n=void 0,o.label=1;case 1:return[4,Du(e,{clientContext:{clientType:t},continuationToken:n})];case 2:i=o.sent(),n=i.continuationToken,i.results&&(r=r.concat(i.results)),o.label=3;case 3:if(n)return[3,1];o.label=4;case 4:return[2,r]}}))}))}var Lu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Fu(e,t,r){return Lu(this,void 0,void 0,D.a.mark((function n(){var i,o,a;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={$top:na(r,ea.HqfGroup,"999"),$select:"id,displayName,description,mail,mailNickname,groupTypes,securityEnabled,visibility"},o=t.id?"users/".concat(encodeURIComponent(t.id),"/memberOf"):"me/memberOf",a=e.createRequestUrl(o,"v1.0",i),n.prev=3,n.next=6,e.makeRequest(a,"GET",t);case 6:return n.abrupt("return",n.sent);case 9:if(n.prev=9,n.t0=n.catch(3),404!==n.t0.statusCode){n.next=14;break}return n.abrupt("return",{});case 14:throw n.t0;case 15:case"end":return n.stop()}}),n,null,[[3,9]])})))}var Bu=r(65);var Nu=function(){},Wu=Bu.a&&1/Object(si.a)(new Bu.a([,-0]))[1]==1/0?function(e){return new Bu.a(e)}:Nu;var Uu=function(e,t,r){var n=-1,i=Ke,o=e.length,a=!0,s=[],c=s;if(r)a=!1,i=Ze;else if(o>=200){var u=t?null:Wu(e);if(u)return Object(si.a)(u);a=!1,i=Xe.a,c=new qe.a}else c=t?[]:s;e:for(;++n<o;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;t&&c.push(f),s.push(l)}else i(c,f,r)||(c!==s&&c.push(f),s.push(l))}return s};var zu=function(e,t){return e&&e.length?Uu(e,Le(t,2)):[]},qu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Qu(e,t,r){return qu(this,void 0,void 0,D.a.mark((function n(){var i,o,a,s,c,u,l;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={$top:na(r,ea.HqfFile,"1500")},o=e.createRequestUrl("me/insights/used","beta",i),a=ur("msbqfmrufilter"),n.prev=3,n.next=6,e.makeRequest(o,"GET",t);case 6:if((s=n.sent)&&s.value&&(c=zu(s.value,(function(e){return e.resourceVisualization.title})))&&Object(Pt.a)(s,{value:c}),!(a&&s&&s.value)){n.next=16;break}if(u=(new Date).getTime(),!(l=Ti(s.value,(function(e){if(!e||!e.lastUsed||!e.lastUsed.lastAccessedDateTime)return!1;var t=new Date(e.lastUsed.lastAccessedDateTime).getTime();return u-t<63072e6})))){n.next=15;break}return n.abrupt("return",Object(Pt.a)({},s,{value:l}));case 15:case 16:return n.abrupt("return",s);case 19:if(n.prev=19,n.t0=n.catch(3),404!==n.t0.statusCode){n.next=24;break}return n.abrupt("return",{});case 24:throw n.t0;case 25:case"end":return n.stop()}}),n,null,[[3,19]])})))}function Gu(e){var t=new v.a;t.set("aspx","Other"),t.set("aspx","Other"),t.set("script","Other"),t.set("unknown","Other"),t.set("prn","Other"),t.set("slk","Other"),t.set("dwg","Other"),t.set("eps","Other"),t.set("indd","Other"),t.set("notebook","Other"),t.set("psd","Other"),t.set("vsx","Other"),t.set("vsw","Other"),t.set("vtx","Other"),t.set("vssm","Other"),t.set("vssx","Other"),t.set("vstm","Other"),t.set("vstx","Other"),t.set("heapsnapshot","Other"),t.set("farx","Other"),t.set("apk","Other"),t.set("encoffmetro","Other"),t.set("application","Other"),t.set("fluid","Other"),t.set("linq","Other"),t.set("bond","Other"),t.set("vs","Other"),t.set("ios10","Other"),t.set("docx","Word"),t.set("doc","Word"),t.set("docm","Word"),t.set("dot","Word"),t.set("dotm","Word"),t.set("dotx","Word"),t.set("thmx","Word"),t.set("odt","Word"),t.set("rtf","Word"),t.set("pptx","PowerPoint"),t.set("pptm","PowerPoint"),t.set("ppt","PowerPoint"),t.set("pot","PowerPoint"),t.set("potm","PowerPoint"),t.set("potx","PowerPoint"),t.set("ppa","PowerPoint"),t.set("pps","PowerPoint"),t.set("ppsm","PowerPoint"),t.set("ppsx","PowerPoint"),t.set("pptm","PowerPoint"),t.set("odp","PowerPoint"),t.set("xlsx","Excel"),t.set("xls","Excel"),t.set("xla","Excel"),t.set("xlam","Excel"),t.set("xlb","Excel"),t.set("xlc","Excel"),t.set("xld","Excel"),t.set("xll","Excel"),t.set("xlm","Excel"),t.set("xlsb","Excel"),t.set("xlsm","Excel"),t.set("xlt","Excel"),t.set("xltm","Excel"),t.set("xltx","Excel"),t.set("xlw","Excel"),t.set("odc","Excel"),t.set("ods","Excel"),t.set("tlb","Excel"),t.set("pdf","Pdf"),t.set("mov","Video"),t.set("mp4","Video"),t.set("mp4v","Video"),t.set("mts","Video"),t.set("ts","Video"),t.set("wmv","Video"),t.set("webm","Video"),t.set("asf","Video"),t.set("m2ts","Video"),t.set("m4v","Video"),t.set("one","OneNote"),t.set("onetoc2","OneNote"),t.set("png","Image"),t.set("jpeg","Image"),t.set("jpg","Image"),t.set("eps","Image"),t.set("gif","Image"),t.set("raw","Image"),t.set("tiff","Image"),t.set("bmp","Image"),t.set("orf","Image"),t.set("tif","Image"),t.set("pub","Publisher"),t.set("mpp","Project"),t.set("accdb","Access"),t.set("pub","Publisher"),t.set("msg","Mail"),t.set("eml","Mail"),t.set("csv","Csv"),t.set("zip","Archive"),t.set("har","Web"),t.set("html","Web"),t.set("htm","Web"),t.set("txt","Text"),t.set("dif","Text"),t.set("ini","Text"),t.set("log","Text"),t.set("json","Text"),t.set("xml","Xml");var r=t.get(e.toLowerCase());return r||"None"}function Hu(e){return qu(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,null==e?void 0:e.then((function(e){e.EntityResults.filter((function(e){return"Files"===e.EntityType}))[0].Entities.forEach((function(e){if("File"===e.FileType){var t={id:"",lastUsed:{lastAccessedDateTime:"",lastModifiedDateTime:""},resourceVisualization:{containerDisplayName:"",containerType:"",containerWebUrl:"",mediaType:"",previewImageUrl:"",previewText:"",title:"",type:"Other"},resourceReference:{id:"",type:"",webUrl:""}};t.id=e.Id||"",t.lastUsed.lastAccessedDateTime=e.LastAccessedDateTime||"",t.lastUsed.lastModifiedDateTime=e.LastModifiedDateTime||"",t.resourceVisualization.containerDisplayName=e.LastModifiedByDisplayName||"",t.resourceVisualization.containerType=e.ContainerType||"",t.resourceVisualization.containerWebUrl=e.ContainerWebUrl||"",t.resourceVisualization.mediaType=e.MediaType||"",t.resourceVisualization.previewImageUrl=e.PreviewImageUrl||"",t.resourceVisualization.previewText=e.PreviewText||"",t.resourceVisualization.title=e.Title||(n=e.FileName,(i=n.split(".")).length>1?i.slice(0,-1).join("."):n),t.resourceVisualization.type=0===e.FileSize?"Folder":e.FileExtension?Gu(e.FileExtension):"Other",t.resourceReference.id=e.resourceReferenceId||"",t.resourceReference.type=e.resourceReferenceType||"",t.resourceReference.webUrl=e.AccessUrl||"",r.push(t)}var n,i}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}var Vu=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Ku(e,t,r,n,i,o){return Vu(this,void 0,void 0,D.a.mark((function a(){var s,c,u,l,f,d,p,h,v,g,_,y,b,m,k,T;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={RawQuery:""},c=[],u=[{AttributeName:"person_type",AttributeValue:"Person"},{AttributeName:"person_type_subclass",AttributeValue:"OrganizationUser"}],f=function(e){var t=[];return e.forEach((function(e){var r={Constraints:[e]};t.push(r)})),t},d={EntityType:"People",ModifiedQuery:(l=function(e,t,r){return{RawQuery:"",MaxResults:na(e,t,r),QueryType:"0"}})(o,ea.HqfPeople,"1500"),ReturnEntitySetFeatures:"true",ConstraintSets:f(u)},p={EntityType:"Files",ModifiedQuery:l(o,ea.HqfFile,"1500"),ReturnEntitySetFeatures:"true"},h={EntityType:"Bookmark",ModifiedQuery:l(o,ea.HqfBookmark,"5000"),ReturnEntitySetFeatures:"true"},v={EntityType:"Qna",ModifiedQuery:l(o,ea.HqfQna,"1500"),ReturnEntitySetFeatures:"true"},g={EntityType:"Location",ModifiedQuery:l(o,ea.HqfBuilding,"1500"),ReturnEntitySetFeatures:"true"},_={CorrelationId:t,ClientRequestId:void 0,CorrelationVector:void 0,ScenarioTag:"msb.ux.bulk.qf",Culture:n},y=[],i.forEach((function(e){switch(e){case"People":y.push(d);break;case"Files":y.push(p);break;case"Qna":y.push(v),c.push.apply(c,["EnableUserQnaES"]);break;case"Building":y.push(g),c.push.apply(c,["EnableUserLocationES"]);break;case"Bookmark":y.push(h),c.push.apply(c,["EnableUserBookmarkES"]);break;default:y.push(d,h,p,v,g,h),c.push.apply(c,["EnableBookmarkES","EnableUserBookmarkES","EnableQnaES","EnableUserQnaES","EnableLocationES","EnableUserLocationES"])}})),b={Query:s,EntityRequests:y,RequestMetadata:_},m={},(k={}).Accept="application/json",c.length>0&&(m.setflight=c.join(",")),a.next=20,e.makeRequest("POST","/api/v2/entityserve",k,m,"","EntityServe","",b).then((function(e){return lt("Substrate HQF: Resolve"),T=JSON.parse(e.Response),Zu(r,"OnFulFilled",e),T}),(function(e){lt("Substrate HQF: Rejected"),Zu(r,"OnRejected",e)})).catch((function(e){lt("Substrate HQF: Failed",e),Zu(r,"OnError")}));case 20:return a.abrupt("return",T);case 21:case"end":return a.stop()}}),a)})))}function Zu(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;lt("Substrate HQF: Logging APi status started");try{Ro(e,r?dt()({StatusCode:r.StatusCode,RestCallStatus:r.RestCallStatus,IsEmptyResults:r.IsEmptyResults,Latency:r.Latency,apiCallStatus:t}):t)}catch(r){Ro(e,t+":Failed")}lt("Substrate HQF: Logging APi status Ended")}function Ju(e,t,r,n,i,o){return Vu(this,void 0,void 0,D.a.mark((function a(){var s;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!(ur("msbhqf3s")||lr("Qf3sMigration")||Xu(o)||Yu())){a.next=10;break}if(s=new xa(e)){a.next=7;break}lt("QueryFormulationWorker::reloadTrieData substrateRestProvider not initialized..."),a.next=10;break;case 7:return a.next=9,Ku(s,t,r,n,i,o);case 9:return a.abrupt("return",a.sent);case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),So(r,a.t0);case 15:case"end":return a.stop()}}),a,null,[[0,12]])})))}function Xu(e){var t=e.isWsb,r=e.isMiniSerp;return ur("bfb3sidh")||lr("MicrosoftInternal")&&!ur("bfbqf3spfoff")&&!t&&!r}function Yu(){return ur("bfb3sosentity")||lr("MicrosoftInternal")&&!ur("bfbqf3soff")}function $u(e){var t=new Date;return t.setMinutes(t.getMinutes()+e)}function el(e){return Math.floor((new Date).getTime()-e)}function tl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=Ii();if(r)return(r-e).toFixed(t)}function rl(e,t){var r="",n=e.headers;if(n){var i=n["x-msedge-ref"];i&&(r="".concat("x-msedge-ref",": ").concat(i))}return yt()({},e,{message:"".concat(t,": ").concat(e.message," ").concat(r)})}var nl=r(149);var il=function(e,t){for(var r=-1,n=e.length;++r<n&&Ve(t,e[r],0)>-1;);return r},ol=/^\s+/;var al=function(e,t,r){if((e=me(e))&&(r||void 0===t))return e.replace(ol,"");if(!e||!(t=be(t)))return e;var n=bi(e),i=il(n,bi(t));return Jo(n,i).join("")};var sl=function(e,t){for(var r=e.length;r--&&Ve(t,e[r],0)>-1;);return r},cl=/\s+$/;var ul=function(e,t,r){if((e=me(e))&&(r||void 0===t))return e.replace(cl,"");if(!e||!(t=be(t)))return e;var n=bi(e),i=sl(n,bi(t))+1;return Jo(n,0,i).join("")},ll=/^\s+|\s+$/g;var fl=function(e,t,r){if((e=me(e))&&(r||void 0===t))return e.replace(ll,"");if(!e||!(t=be(t)))return e;var n=bi(e),i=bi(t),o=il(n,i),a=sl(n,i)+1;return Jo(n,o,a).join("")};var dl=function(){var e=arguments,t=me(e[0]);return e.length<3?t:t.replace(e[1],e[2])},pl={parenDash:/[()-]+/gi,parenDashBrace:/[(){}-]+/gi,parenDashDot:/[()-.]+/gi,parenDashDotComa:/[()-.,]+/gi,parenDashDotComaCol:/[()-.,:]+/gi},hl=/[&*-/[\]()_|:{}.,?!]+/gi,vl=/[\s]+/gi,gl=/  +/g;function _l(e){return e?fl(dl(dl(e.toLowerCase(),hl," "),vl," ")):""}function yl(e){if(!e)return"";var t=al(dl(dl(e.toLowerCase(),hl," "),vl," "));return" "===t.charAt(t.length-1)&&" "!==e.charAt(e.length-1)?ul(t):t}function bl(e){return al(e.replace(gl," ").toLowerCase())}function ml(e,t){var r=e,n=pl[t];n&&(r=e.replace(n," "));var i=bl(r);return" "===i.charAt(i.length-1)&&" "!==e.charAt(e.length-1)?ul(i):i}function kl(e,t,r){var n=function(e,t){var r=[];if(e){var n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(e);!(n=(a=s.next()).done);n=!0){var c=a.value;r.push(_l(c))}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}if(t){var u=!0,l=!1,f=void 0;try{for(var d,p=Ho()(t);!(u=(d=p.next()).done);u=!0){var h=d.value;r.push(_l(h))}}catch(e){l=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(l)throw f}}}return r}(t,r);if(e){var i=Object(nl.filterOutNull)(ze(Sl(null,e),_l));n=n.concat(i)}return n}function Tl(e,t,r){if(t.length)for(var n=0;n<t.length;n++){var i=R(t);i.splice(n,1),Tl(e+" "+t[n],i,r)}else r.push(e)}function Sl(e,t){var r=[],n=t.split(" ");if(n.length>4){r.push(t);var i="",o=t.indexOf("(");if(o>-1&&(i=t.substring(o+1,t.length-2),n=(t=t.substr(0,o).trim()).split(" ")),n.length>4)n=[n[0],n[1],n[n.length-2],n[n.length-1]];else if(i&&n.length<4){var a=i.split(" ");a&&a.length&&n.push(a[0])}}if(e){var s=function(e,t){var r=e.split(" ");r.length>1&&(e=r[0]);for(var n=0;n<t.length;n++)if(0===t[n].indexOf(e))return n;return null}(e,n);if(null!=s){var c=R(n);c.splice(s,1),Tl(n[s],c,r)}}else for(var u=0;u<n.length;u++){var l=R(n);l.splice(u,1),Tl(n[u],l,r)}return r}function wl(e){return e?24e3-e.length:0}function xl(e){return e?wl(e.displayTitle):0}function Cl(e){return e?wl(e.displayQuestion):0}function Ol(e){return e?wl(e.name):0}function El(e,t){if(!e)return 0;var r=0;return(!e.groupTypes||ai(e.groupTypes,"Unified")<0)&&(r=1e3),24e3-t-r}function Pl(e,t){return e?24e3-t:0}function Il(e){e.sort((function(e,t){return t.suggestion.rank-e.suggestion.rank}))}var Al=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Rl(e){if(e){var t=e.definitiveQueries,r=e.secondaryQueries,n=e.entity,i=n.displayTitle,o=n.domain,a=n.id,s=n.url,c=kl(i,t,r);if(!Object(St.a)(c))return{keywords:c,suggestion:{query:i,domain:o||"Bookmark",id:a,identifiers:{url:s},rank:xl(n),secondaryQueries:r,definitiveQueries:t}}}}function jl(e,t,r){return Al(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process bookmarks..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e){return Rl(e)}))))||Object(St.a)(i)){n.next=6;break}return Il(i),n.next=6,e.build(null,i,r);case 6:case"end":return n.stop()}}),n)})))}function Dl(e){return Al(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,null==e?void 0:e.then((function(e){e.EntityResults.filter((function(e){return"Bookmark"===e.EntityType}))[0].Entities.forEach((function(e){var t={entity:{displayTitle:"",domain:"Bookmark",id:"",query:"",url:""},definitiveQueries:[],secondaryQueries:[]};t.entity.id=e.GlobalId||"",t.entity.displayTitle=e.DisplayTitle||"",t.entity.domain="Bookmark",t.entity.url=e.Url||"",t.entity.query=e.Query||"",t.definitiveQueries=e.DefinitiveQueries||[],t.secondaryQueries=e.SecondaryQueries||[],r.push(t)}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}var Ml=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Ll(e){if(e){var t=e.definitiveQueries,r=e.secondaryQueries,n=e.entity,i=n.name,o=n.domain,a=n.id,s=n.fullAddress,c=kl(i,t,r);if(!Object(St.a)(c))return{keywords:c,suggestion:{query:i,domain:o||"Building",id:a,title:s,rank:Ol(n),secondaryQueries:r,definitiveQueries:t}}}}function Fl(e,t,r){return Ml(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process buildings..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e){return Ll(e)}))))||Object(St.a)(i)){n.next=6;break}return Il(i),n.next=6,e.build(null,i,r);case 6:case"end":return n.stop()}}),n)})))}function Bl(e){return Ml(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,null==e?void 0:e.then((function(e){e.EntityResults.filter((function(e){return"Location"===e.EntityType}))[0].Entities.forEach((function(e){var t={entity:{fullAddress:"",domain:"Building",id:"",name:"",latitude:0,longitude:0},definitiveQueries:[],secondaryQueries:[]};t.entity.id=e.GlobalId||"",t.entity.fullAddress=e.FullAddress||"",t.entity.domain="Building",t.entity.name=e.Name||"",t.definitiveQueries=e.DefinitiveQueries||[],t.secondaryQueries=e.SecondaryQueries||[],r.push(t)}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}var Nl=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Wl(e){if(e){var t,r=e.definitiveQueries,n=e.secondaryQueries,i=e.entity,o=i.displayText,a=i.domain,s=i.id,c=kl(o,r,n);if(!Object(St.a)(c))return{keywords:c,suggestion:{query:o,domain:a||"EducationAssignment",id:s,rank:(t=i,t?wl(t.displayText):0),secondaryQueries:n,definitiveQueries:r}}}}function Ul(e,t,r){return Nl(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process text..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e){return Wl(e)}))))||Object(St.a)(i)){n.next=6;break}return Il(i),n.next=6,e.build(null,i,r);case 6:case"end":return n.stop()}}),n)})))}var zl=function(e){return e&&e.length?Uu(e):[]},ql=Array.prototype.reverse;var Ql=function(e){return null==e?e:ql.call(e)},Gl=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Hl(e,t){if(e){var r=e.displayName,n=e.mail,i=e.mailNickname,o=Vl(r,n,i),a=e.groupTypes,s=a&&ai(a,"Unified")>=0||!1,c="Private"===e.visibility;return{keywords:o,suggestion:{query:r,domain:"Group",id:e.id,rank:El(e,t),identifiers:{uniqueName:n},isO365Group:s,isPrivate:c,mailNickname:i}}}}function Vl(e,t,r){return zl(Object(nl.filterOutNull)(ze(Un(Sl(null,e),Object(nl.filterOutNull)([t,r])),_l)))}function Kl(e,t,r){return Gl(this,void 0,void 0,D.a.mark((function n(){var i,o;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process groups..."),i=Ql(t),!(o=Object(nl.filterOutNull)(ze(i,(function(e,t){return Hl(e,t)}))))||Object(St.a)(o)){n.next=7;break}return Il(o),n.next=7,e.build(null,o,r);case 7:case"end":return n.stop()}}),n)})))}var Zl=Object(nt.a)((function(e){var t=X(e,Pi);return t.length&&t[0]===e[0]?Ei(t):[]})),Jl=gt()(),Xl={},Yl={},$l=void 0;function ef(){lt("IndexedDB::collectDatabases...",Object(re.a)(Xl));var e=Object(re.a)(Xl);Pr(e,(function(e){Xl[e]!==Jl&&(Xl[e].close(),delete Xl[e])})),lt("IndexedDB::collectDatabases completed. ",Object(re.a)(Xl))}function tf(e,t,r){var n="".concat(e,":").concat(t),i=Xl[n];if(i===Jl){if(!Yl[n])throw new Error("Unable to queue database retrieval. dbLoadingPromises has no ".concat(n," record"));return Yl[n]}return $l&&clearTimeout($l),$l=setTimeout(ef,6e4),i?L.a.resolve(i):(Xl[n]=Jl,Yl[n]=new L.a((function(i,o){var a;lt("indexedDB::open",n);var s=indexedDB.open(e,t);s.onerror=function(t){lt("indexedDB retrieve error",e,t),delete Xl[n],o(t)},s.onupgradeneeded=function(t){lt("indexedDB upgrade needed",e,t);var n=t.target.result;r(n)},s.onsuccess=function(){a=s.result,lt("indexedDB retrieve success",e,a),Xl[n]=a,delete Yl[n],i(a)}})),Yl[n])}var rf=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function nf(){return null!=self.indexedDB}function of(e,t,r){try{e.objectStoreNames.contains(t)&&e.deleteObjectStore(t),e.createObjectStore(t)}catch(e){}}function af(e){of(e,"mru"),of(e,"person"),of(e,"bookmark"),of(e,"qna"),of(e,"location"),ur("bfbedusug")&&of(e,"educationAssignment"),of(e,"token"),of(e,"trie"),of(e,"servertrie"),of(e,"user"),of(e,"group"),of(e,"refreshtime"),of(e,"variants")}function sf(){return tf("msb",15,af)}function cf(e,t){return rf(this,void 0,void 0,D.a.mark((function r(){var n=this;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new L.a((function(r,i){return rf(n,void 0,void 0,D.a.mark((function n(){var o,a,s,c,u;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=(new Date).getTime(),lt("IndexedDB::Trying to open ".concat(e," for reading...")),n.next=5,sf();case 5:a=n.sent,s=a.transaction([e]),c=s.objectStore(e),lt("IndexedDB::Trying to read ".concat(t," from ").concat(e,"...")),(u=c.get(t)).onerror=function(r){var n=r.target.error;lt("IndexedDB::Unable to read ".concat(t," from ").concat(e),n),i(n||new Error("Unknown read error"))},u.onsuccess=function(n){if(n&&n.target&&n.target.result){lt("IndexedDB::Received data for ".concat(t," from ").concat(e," (").concat(el(o)," ms)"));var a=u.result;r(a)}else lt("IndexedDB::No data found for ".concat(t," in ").concat(e," (").concat(el(o)," ms)")),i(new Error("".concat(t," in ").concat(e," not found in IndexedDB")))},n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),i(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))})));case 1:case"end":return r.stop()}}),r)})))}function uf(e,t){var r=this;return nf()?new L.a((function(n,i){return rf(r,void 0,void 0,D.a.mark((function r(){var o,a,s,c;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,o=(new Date).getTime(),lt("IndexedDB::Trying to open ".concat(e," for writing...")),r.next=5,sf();case 5:a=r.sent,s=a.transaction([e],"readwrite"),c=s.objectStore(e),s.oncomplete=function(t){lt("IndexedDB::Write transaction completed for ".concat(e," (").concat(el(o)," ms)")),n()},s.onerror=function(e){var t=e.target.error;i(t||new Error("Unknown IndexedDb Error"))},s.onabort=function(e){var t=e.target.error;i(t||new Error("Unknown IndexedDb Error"))},t(c,n,i),r.next=18;break;case 14:r.prev=14,r.t0=r.catch(0),i(r.t0);case 18:case"end":return r.stop()}}),r,null,[[0,14]])})))})):L.a.reject(new Error("IndexedDB not supported"))}function lf(e,t,r){return nf()?uf(e,(function(n,i,o){lt("IndexedDB::Trying to write ".concat(t," to ").concat(e,"..."));var a=n.put(r,t);a.onerror=function(e){var t=e.target.error;o(t||new Error("Unknown write error"))},a.onsuccess=function(r){lt("IndexedDB::Data written for ".concat(t," to ").concat(e))}})):L.a.reject(new Error("IndexedDB not supported"))}function ff(e,t){return nf()?uf(e,(function(r,n,i){lt("IndexedDB::Trying to delete ".concat(t," from ").concat(e,"..."));var o=r.delete(t);o.onerror=function(e){var t=e.target.error;i(t||new Error("Unknown delete error"))},o.onsuccess=function(r){lt("IndexedDB::Data deleted for ".concat(t," from ").concat(e))}})):L.a.reject(new Error("IndexedDB not supported"))}function df(e,t,r){return rf(this,void 0,void 0,D.a.mark((function n(){var i,o;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(nf()){n.next=3;break}return r(),n.abrupt("return",L.a.reject(new Error("IndexedDB not supported")));case 3:return n.prev=3,n.next=6,cf(e,t);case 6:return(i=n.sent).timestamp&&(o=$u(-1440),i.timestamp<o&&(lt("IndexedDB::Refreshing data for ".concat(t," in ").concat(e," because data was older than a day (").concat(i.timestamp," < ").concat(o,")")),r())),n.abrupt("return",i.data);case 11:throw n.prev=11,n.t0=n.catch(3),lt("IndexedDB::Unable to load data from ".concat(e," ").concat(t),n.t0),n.t0;case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))}function pf(e,t){return rf(this,void 0,void 0,D.a.mark((function r(){var n;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(nf()){r.next=2;break}return r.abrupt("return",L.a.reject(new Error("IndexedDB not supported")));case 2:return r.prev=2,r.next=5,cf(e,t);case 5:return n=r.sent,r.abrupt("return",n.data);case 9:throw r.prev=9,r.t0=r.catch(2),lt("IndexedDB::Unable to load data from ".concat(e," ").concat(t),r.t0),r.t0;case 13:case"end":return r.stop()}}),r,null,[[2,9]])})))}function hf(e,t,r){return lf(e,t,{data:r,timestamp:(new Date).getTime()})}function vf(e){return df("bookmark","all",e)}function gf(e){return hf("bookmark","all",e)}function _f(){return ff("bookmark","all")}function yf(e){return df("qna","all",e)}function bf(e){return hf("qna","all",e)}function mf(){return ff("qna","all")}function kf(e){return df("location","all",e)}function Tf(e){return hf("location","all",e)}function Sf(){return ff("location","all")}function wf(e){return df("educationAssignment","all",e)}function xf(e){return hf("educationAssignment","all",e)}function Cf(){return ff("educationAssignment","all")}function Of(e){return df("mru","all",e)}function Ef(e){return hf("mru","all",e)}function Pf(){return ff("mru","all")}function If(e){return df("person","all",e)}function Af(e){return hf("person","all",e)}function Rf(){return ff("person","all")}function jf(e){return df("group","all",e)}function Df(e){return hf("group","all",e)}function Mf(){return ff("group","all")}function Lf(e){return df("trie","trie",e)}function Ff(e){return df("trie","triedata",e)}function Bf(e,t){if(!nf())return L.a.reject(new Error("IndexedDB not supported"));return uf("trie",(function(r,n,i){lt("IndexedDB::Trying to write ".concat("trie",", ").concat("triedata"," to ").concat("trie","..."));var o=(new Date).getTime(),a={data:e,timestamp:o},s={data:t,timestamp:o},c=r.put(a,"trie"),u=r.put(s,"triedata");c.onerror=function(e){lt("IndexedDB::Unable to write ".concat("trie"," to ").concat("trie"),e.target.error),i(e)},c.onsuccess=function(e){lt("IndexedDB::Data written for ".concat("trie"," to ").concat("trie"))},u.onerror=function(e){lt("IndexedDB::Unable to write ".concat("triedata"," to ").concat("trie"),e.target.error),i(e)},u.onsuccess=function(e){lt("IndexedDB::Data written for ".concat("triedata"," to ").concat("trie"))}}))}function Nf(){if(!nf())return L.a.reject(new Error("IndexedDB not supported"));return uf("trie",(function(e,t,r){lt("IndexedDB::Trying to delete ".concat("trie",",").concat("triedata"," from ").concat("trie","..."));var n=e.delete("trie"),i=e.delete("triedata");n.onerror=function(e){lt("IndexedDB::Unable to delete ".concat("trie"," delete ").concat("trie"),e.target.error),r(e)},n.onsuccess=function(e){lt("IndexedDB::Data deleted for ".concat("trie"," from ").concat("trie"))},i.onerror=function(e){lt("IndexedDB::Unable to delete ".concat("triedata"," from ").concat("trie"),e.target.error),r(e)},i.onsuccess=function(e){lt("IndexedDB::Data deleted for ".concat("triedata"," from ").concat("trie"))}}))}function Wf(){return df("servertrie","input",(function(){}))}function Uf(e){return hf("servertrie","input",e)}function zf(e){return lf("user","info",e)}function qf(){return rf(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Qf(),r=Gf(),e.next=4,L.a.all([t,r]);case 4:return n=e.sent,i=Vo(n,2),o=i[0],a=i[1],e.abrupt("return",o||a);case 9:case"end":return e.stop()}}),e)})))}function Qf(){return rf(this,void 0,void 0,D.a.mark((function e(){var t,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nf()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,cf("refreshtime","time");case 5:if(t=e.sent,r=$u(-1440),!(t<r)){e.next=12;break}return lt("IndexedDB::Data is stale because data was older than a day (".concat(t," < ").concat(r,")")),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(2),lt("IndexedDB::Unable to load data from ".concat("refreshtime"," ").concat("time"),e.t0),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))}function Gf(){return rf(this,void 0,void 0,D.a.mark((function e(){var t,r,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nf()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,cf("variants","variants");case 5:if(t=e.sent,r=Zl(sr||[],or),(n=Zl(r,t)).length===r.length&&n.length===t.length){e.next=13;break}return lt("IndexedDB::Data needs refresh due to mismatch of storedvariants ".concat(t," vs new variants ").concat(r)),e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(2),lt("IndexedDB::Unable to load data from ".concat("variants"," ").concat("variants"),e.t0),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,null,[[2,16]])})))}function Hf(e){return df("bookmark","top",e)}function Vf(e){return hf("bookmark","top",e)}function Kf(){return ff("bookmark","top")}var Zf=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Jf={a:1,an:1,and:1,are:1,as:1,at:1,be:1,by:1,for:1,from:1,has:1,he:1,in:1,is:1,it:1,its:1,of:1,on:1,that:1,the:1,to:1,was:1,were:1,will:1,with:1};function Xf(e){if(e&&e.resourceVisualization&&e.lastUsed){var t=e.resourceVisualization,r=e.resourceReference,n=e.lastUsed,i=t.title,o=t.containerDisplayName,a=t.type;if(i&&n.lastAccessedDateTime){var s=Yf(i),c=new Date(n.lastAccessedDateTime);return{keywords:s,suggestion:{query:i,domain:"File",id:e.id,identifiers:{url:r&&r.webUrl},title:o,rank:0,timestamp:c.getTime(),fileType:a}}}}}function Yf(e){for(var t=e.toLowerCase(),r=fl(dl(t,/[ |\-_\n\t\r?]+/gi," ")),n=r.split(/ |-|_/),i=[r],o=0;o<n.length;o++)Jf[n[o]]&&n.splice(o,1);for(var a=0;a<=n.length;a++)for(var s=0;s<=n.length;s++)a!==s&&(a===n.length?i.push(n[s]):s===n.length?i.push(n[a]):i.push(n[a]+" "+n[s]));return Object(nl.filterOutNull)(ze(i,_l))}function $f(e,t,r){return Zf(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process mru..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e){return Xf(e)}))))||Object(St.a)(i)){n.next=7;break}return i.sort((function(e,t){var r=e.suggestion&&e.suggestion.timestamp||0;return(t.suggestion&&t.suggestion.timestamp||0)-r})),Pr(i,(function(e,t){e.suggestion.rank=24e3-t})),n.next=7,e.build(null,i,r);case 7:case"end":return n.stop()}}),n)})))}function ed(e){return Zf(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Of((function(){}));case 2:return r=t.sent,t.abrupt("return",Object(nl.filterOutNull)(ze(r.slice(0,e),(function(e){var t;return null===(t=Xf(e))||void 0===t?void 0:t.suggestion}))));case 4:case"end":return t.stop()}}),t)})))}var td=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function rd(e){if(e){var t=e.secondaryQueries,r=e.definitiveQueries,n=e.entity,i=n.displayQuestion,o=n.domain,a=n.id,s=n.url,c=kl(i,r,t);if(!Object(St.a)(c))return{keywords:c,suggestion:{query:i,domain:o||"Qna",id:a,identifiers:{url:s},rank:Cl(n),secondaryQueries:t,definitiveQueries:r}}}}function nd(e,t,r){return td(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process qnas..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e){return rd(e)}))))||Object(St.a)(i)){n.next=6;break}return Il(i),n.next=6,e.build(null,i,r);case 6:case"end":return n.stop()}}),n)})))}function id(e){return td(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,null==e?void 0:e.then((function(e){e.EntityResults.filter((function(e){return"Qna"===e.EntityType}))[0].Entities.forEach((function(e){var t={entity:{displayQuestion:"",domain:"Qna",id:"",query:"",url:""},definitiveQueries:[],secondaryQueries:[]};t.entity.id=e.GlobalId||"",t.entity.displayQuestion=e.DisplayQuestion||"",t.entity.domain="Qna",t.entity.url=e.Url||"",t.entity.query=e.Query||"",t.definitiveQueries=e.DefinitiveQueries||[],t.secondaryQueries=e.SecondaryQueries||[],r.push(t)}))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))}var od,ad,sd,cd=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function ud(e){if(!e)return e;var t=e.split("@");return(t.length>1?t[0]:e).toLowerCase()}function ld(e,t){if(e){var r=function(e){var t=void 0;if(e.userPrincipalName)t=e.userPrincipalName;else if(e.scoredEmailAddresses&&!Object(St.a)(e.scoredEmailAddresses)){var r=e.scoredEmailAddresses[0].address;r&&(t=r)}return t}(e);return{keywords:fd(e.displayName,r),suggestion:{query:e.displayName,domain:"Person",id:ud(e.id),title:e.jobTitle,rank:Pl(e,t),identifiers:{uniqueName:r}}}}}function fd(e,t){var r=Object(nl.filterOutNull)(ze(Sl(null,e),_l));return t&&r.push(ud(t)),r}function dd(e,t,r){return cd(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process recipient cache..."),!(i=Object(nl.filterOutNull)(ze(t,(function(e,t){return ld(e,t)}))))||Object(St.a)(i)){n.next=6;break}return Il(i),n.next=6,e.build(null,i,r);case 6:case"end":return n.stop()}}),n)})))}function pd(e){return cd(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,If((function(){}));case 2:return r=t.sent,t.abrupt("return",Object(nl.filterOutNull)(ze(r.slice(0,e),(function(e,t){var r;return null===(r=ld(e,t))||void 0===r?void 0:r.suggestion}))));case 4:case"end":return t.stop()}}),t)})))}function hd(e,t,r){return Object(dr.__awaiter)(this,void 0,void 0,(function(){var n;return Object(dr.__generator)(this,(function(i){switch(i.label){case 0:return n=e.createRequestUrl("impression/query/top"),r?[3,2]:[4,e.makeRequest(n,"POST",t)];case 1:return[2,i.sent()];case 2:return[4,e.makeRequest(n,"POST",t)];case 3:return[2,i.sent()]}}))}))}function vd(e,t){var r=null,n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(t);!(n=(a=s.next()).done);n=!0){var c=a.value;if(!(e.length>=c.charCount))break;r=c}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}function gd(e,t,r){return t in e?T()(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _d={domainOptions:(od={},gd(od,"Person",{minimumMatchCount:6,spaceInTheMiddleRequired:!0}),gd(od,"Bookmark",{minimumMatchCount:8}),gd(od,"Building",{minimumMatchCount:6}),gd(od,"File",{minimumMatchCount:6}),gd(od,"Group",{minimumMatchCount:6}),gd(od,"Qna",{minimumMatchCount:6}),gd(od,"EducationAssignment",{minimumMatchCount:6}),od),triggerOptions:{minimumMatchCount:8}},yd={domainOptions:(ad={},gd(ad,"Person",{minimumMatchCount:6,spaceInTheMiddleRequired:!0}),gd(ad,"Bookmark",{minimumMatchCount:6}),gd(ad,"Building",{minimumMatchCount:6}),gd(ad,"File",{minimumMatchCount:6}),gd(ad,"Group",{minimumMatchCount:6}),gd(ad,"Qna",{minimumMatchCount:6}),gd(ad,"EducationAssignment",{minimumMatchCount:6}),ad),triggerOptions:{minimumMatchCount:6}},bd={domainOptions:(sd={},gd(sd,"Person",{minimumMatchCount:4,spaceInTheMiddleRequired:!0}),gd(sd,"Bookmark",{minimumMatchCount:4}),gd(sd,"Building",{minimumMatchCount:4}),gd(sd,"File",{minimumMatchCount:4}),gd(sd,"Group",{minimumMatchCount:4}),gd(sd,"Qna",{minimumMatchCount:4}),gd(sd,"EducationAssignment",{minimumMatchCount:4}),sd),triggerOptions:{minimumMatchCount:4}};function md(e,t,r){var n=ur("bfbqfhccount")?yd:ur("bfbqfhccountwsb")?bd:_d,i=r&&r.suggestionConfidenceOptions||n;return function(e,t,r,n,i){if(!r)return;var o=ml(t.suggestion.query,i),a=kd(e,o);if(a.isFullQueryMatch&&(!r.spaceInTheMiddleRequired||a.isSpaceInTheMiddle)&&a.matchCount>=r.minimumMatchCount)t.confidence="High";else{var s=function(e,t,r){if(!r||!t)return!1;var n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(t);!(n=(a=s.next()).done);n=!0){var c=a.value,u=kd(e,bl(c));if(u.isFullQueryMatch&&u.matchCount>=r.minimumMatchCount)return!0}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return!1}(e,t.suggestion.definitiveQueries,n);t.confidence=s?"High":"Low"}}(e,t,t.suggestion.domain&&i.domainOptions[t.suggestion.domain],i.triggerOptions,i.ignoreChars)}function kd(e,t){for(var r=0,n=0,i=!1,o=0,a=!1;r<e.length&&n<t.length&&e.charAt(r)===t.charAt(n);)o++," "===e.charAt(r)&&(i=!0),r++,n++;return r===e.length&&(a=!0),{isFullQueryMatch:a,matchCount:o,isSpaceInTheMiddle:i}}var Td,Sd=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function wd(e,t){if(t){var r=xd(e,t);return t.rank=function(e){return e?("Person"===e.domain&&(e.rank=23800+e.rank),e.rank):0}(t),t.isServerSuggestion=!0,t.userQuery=e,{keywords:r,suggestion:t}}}function xd(e,t){return Object(nl.filterOutNull)(ze(Sl(_l(e),_l(t.query)),_l))}function Cd(e,t,r){return Sd(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("Process query formulation response...",t,r),!(i=Object(nl.filterOutNull)(ze(r,(function(e){return wd(t,e)}))))||Object(St.a)(i)){n.next=6;break}return lt("Ingesting query formulation results...",i),n.next=6,e.build(t,i,!1);case 6:return n.abrupt("return",{query:t,inputs:i,timestamp:(new Date).getTime()});case 7:case"end":return n.stop()}}),n)})))}var Od=(gd(Td={},"Person",(function(e){var t;return"Person"!==e.domain?[]:fd(e.query,null===(t=e.identifiers)||void 0===t?void 0:t.uniqueName)})),gd(Td,"Bookmark",(function(e){return"Bookmark"!==e.domain?[]:kl(e.query,e.definitiveQueries,e.secondaryQueries)})),gd(Td,"Building",(function(e){return"Building"!==e.domain?[]:kl(e.query,e.definitiveQueries,e.secondaryQueries)})),gd(Td,"Group",(function(e){if("Group"!==e.domain)return[];var t=e.query,r=e.identifiers,n=e.mailNickname;return Vl(t,null==r?void 0:r.uniqueName,n)})),gd(Td,"File",(function(e){return"File"!==e.domain?[]:Yf(e.query)})),gd(Td,"Qna",(function(e){return"Qna"!==e.domain?[]:kl(e.query,e.definitiveQueries,e.secondaryQueries)})),gd(Td,"EducationAssignment",(function(e){return"EducationAssignment"!==e.domain?[]:kl(e.query,e.definitiveQueries,e.secondaryQueries)})),Td);function Ed(e){return e.domain+e.id}function Pd(e,t){return e.domain===t.domain&&e.id===t.id}function Id(e){if(e.isServerSuggestion)return function(e){return e.isServerSuggestion?xd(e.userQuery,e):[]}(e);var t=Od[e.domain];return t?t(e):[]}var Ad=[{charCount:0,timestamp:$u(-10080)},{charCount:2,timestamp:$u(-43200)},{charCount:4,timestamp:$u(-1576800)}],Rd=[{charCount:1,score:100},{charCount:2,score:250},{charCount:3,score:2500}];function jd(e,t,r,n,i){var o=[];if(!Object(St.a)(r)){var a=function(e,t,r){return Object(nl.filterOutNull)(ze(t,(function(t){var n=Object(nl.filterOutNull)(ze(t.indices,(function(t){var n=e.resolveIndex(t),i=null==r?void 0:r.domains;return!i||!n||n.domain&&-1!==i.indexOf(n.domain)?n:null})));return Object(St.a)(n)?null:{score:t.score,fuzzyCount:t.fuzzyCount,query:t.query,clientOnly:t.clientOnly,suggestions:n}})))}(e,r,n);Object(St.a)(a)||(a.sort((function(e,t){return t.score-e.score})),Pr(a,(function(e){!function(e){e.sort((function(e,t){var r=Dd(e),n=Dd(t);return r>n?-1:r<n?1:t.rank-e.rank}))}(e.suggestions)})),Fd(a,o,t,0,n),0===o.length&&Fd(a,o,t,1,n))}var s=ml(i,n&&n.suggestionConfidenceOptions&&n.suggestionConfidenceOptions.ignoreChars);Pr(o,(function(e){return md(s,e,n)})),function(e){var t=Number.MAX_VALUE,r=Number.MIN_VALUE,n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(e);!(n=(a=s.next()).done);n=!0){var c=a.value;"High"===c.confidence&&c.score<t?t=c.score:"High"!==c.confidence&&c.score>r&&(r=c.score)}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}var u=t<=1e6?1e6-t+1:0,l=r>=1e6?1e6-r-1:0,f=!0,d=!1,p=void 0;try{for(var h,v=Ho()(e);!(f=(h=v.next()).done);f=!0){var g=h.value;"High"===g.confidence?g.score+=u:g.score+=l}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}}(o),function(e){e.sort((function(e,t){if(e.score>t.score)return-1;if(e.score<t.score)return 1;var r=Dd(e.suggestion);return Dd(t.suggestion)-r}))}(o);var c=ze(o,(function(e){return r=(t=e).suggestion,n=t.score,i=t.confidence,Object(Pt.a)({},r,{rank:n,confidence:i});var t,r,n,i})),u=!1;return Pr(o,(function(e){u=u||e.clientOnly||!1})),{suggestions:c,clientOnly:u}}function Dd(e){switch(e.domain){case"Person":return 10;case"File":return 15;case"Bookmark":return 5;case"Qna":return 4;case"Building":return 3;case"Group":return 2;case"EducationAssignment":return 5;default:return 0}}function Md(e,t,r,n,i){switch(e.domain){case"Bookmark":return(t.length>1&&1===r&&n<=1||t.length>2&&i.Bookmark<2)&&(i.Bookmark++,!0);case"Qna":return t.length>2&&i.Qna<2&&(i.Qna++,!0);case"Building":return t.length>2&&i.Building<2&&(i.Building++,!0);case"File":var o=vd(t,Ad);return!!(o&&e.timestamp&&e.timestamp>o.timestamp&&i.Mru<2)&&(i.Mru++,!0);case"Person":var a=vd(t,Rd);return!!(a&&e.rank>=24e3-a.score)&&(i.Person++,!0);case"Group":return t.length>2&&i.Group<2&&(i.Group++,!0);case"EducationAssignment":return t.length>2&&i.EducationAssignment<2&&(i.EducationAssignment++,!0);default:return!1}}function Ld(e,t){var r=t&&t.count||4;return e.length>=r}function Fd(e,t,r,n,i){for(var o={Bookmark:0,Mru:0,Person:0,Qna:0,Building:0,Group:0,EducationAssignment:0},a=0;a<e.length&&!Ld(t,i);a++)for(var s=e[a],c=function(e){var i=s.suggestions[e];i&&Md(i,r,n,t.length,o)&&!xi(t,(function(e){return Pd(i,e.suggestion)}))&&t.push({suggestion:i,score:s.score,fuzzyCount:s.fuzzyCount,clientOnly:s.clientOnly})},u=0;u<s.suggestions.length&&!Ld(t,i);u++)c(u)}function Bd(e,t,r,n){var i=e.getSuggestions(t);return jd(e,t,i,r,n)}var Nd=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Wd(e){return Nd(this,void 0,void 0,D.a.mark((function t(){var r,n,i;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.msbRestProvider,(n=e.options)&&r){t.next=3;break}throw new Error("QueryFormulationContext was not initialized properly. One of the fields is null");case 3:return i=n.clientType,t.next=6,Ud(r,i);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))}function Ud(e,t){return Nd(this,void 0,void 0,D.a.mark((function r(){var n,i;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n={clientContext:{clientType:t},numberOfTopQueries:10,scenarioTypeFilter:"Bookmark"},r.next=3,hd(e,n);case 3:return i=r.sent,r.abrupt("return",i.queries);case 5:case"end":return r.stop()}}),r)})))}function zd(e){return Nd(this,void 0,void 0,D.a.mark((function t(){var r,n;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Hf((function(){}));case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,Wd(e);case 11:return Hd("topBookmarks",Vf,Kf,n=t.sent),t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,null,[[0,7]])})))}function qd(e,t){return Nd(this,void 0,void 0,D.a.mark((function r(){var n;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,zd(t);case 2:return n=r.sent,r.abrupt("return",Object(nl.filterOutNull)(ze(n.slice(0,e),(function(e){return r=e,Bd(t.trie,r,{domains:["Bookmark"]},r).suggestions[0];var r}))));case 4:case"end":return r.stop()}}),r)})))}function Qd(e,t,r){return Nd(this,void 0,void 0,D.a.mark((function n(){return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:lt("Process top bookmarks..."),lt(e,t,r);case 2:case"end":return n.stop()}}),n)})))}var Gd=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Hd(e,t,r,n){return Gd(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(n);case 3:e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=10,r();case 10:throw e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,5]])})))}function Vd(e,t,r,n,i,o){return Gd(this,void 0,void 0,D.a.mark((function a(){var s;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return lt("Fetching ".concat(e,"...")),a.next=3,t();case 3:return s=a.sent,r(s,o),Hd(0,n,i,s).catch((function(e){})),a.abrupt("return",s);case 7:case"end":return a.stop()}}),a)})))}function Kd(e,t,r,n,i,o,a,s){return Gd(this,void 0,void 0,D.a.mark((function c(){var u,l,f=this;return D.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(u=function(){return Gd(f,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),rl(e.t0,"Error fetching ".concat(r));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))},!e){c.next=6;break}return lt("".concat(r," fetch forced")),c.next=5,Vd(r,u,s,o,a,!1);case 5:return c.abrupt("return");case 6:return c.prev=6,lt("Reading ".concat(r," from db...")),c.next=10,i((function(){lt("".concat(r," reload needed")),Vd(r,u,s,o,a,!0)}));case 10:l=c.sent,t&&s(l,!1),c.next=19;break;case 14:return c.prev=14,c.t0=c.catch(6),c.next=19,Vd(r,u,s,o,a,!1);case 19:case"end":return c.stop()}}),c,null,[[6,14]])})))}function Zd(e,t,r,n,i,o){return Gd(this,void 0,void 0,D.a.mark((function a(){var s=this;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Kd(n,i,"bookmarks",(function(){return Gd(s,void 0,void 0,D.a.mark((function e(){var n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yu()){e.next=7;break}return e.next=3,Dl(o);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.next=9,Su(t,r);case 9:return i=e.sent,e.abrupt("return",i||[]);case 11:case"end":return e.stop()}}),e)})))}),(function(e){return vf(e)}),gf,_f,(function(t,r){return jl(e,t,r)}));case 2:case"end":return a.stop()}}),a)})))}function Jd(e,t,r,n,i,o){return Gd(this,void 0,void 0,D.a.mark((function a(){var s=this;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Kd(n,i,"qnas",(function(){return Gd(s,void 0,void 0,D.a.mark((function e(){var n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yu()){e.next=7;break}return e.next=3,id(o);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.next=9,Mu(t,r);case 9:return i=e.sent,e.abrupt("return",i||[]);case 11:case"end":return e.stop()}}),e)})))}),(function(e){return yf(e)}),bf,mf,(function(t,r){return nd(e,t,r)}));case 2:case"end":return a.stop()}}),a)})))}function Xd(e,t,r,n,i,o){return Gd(this,void 0,void 0,D.a.mark((function a(){var s=this;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Kd(n,i,"buildings",(function(){return Gd(s,void 0,void 0,D.a.mark((function e(){var n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Yu()){e.next=7;break}return e.next=3,Bl(o);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.next=9,Ou(t,r);case 9:return i=e.sent,e.abrupt("return",i||[]);case 11:case"end":return e.stop()}}),e)})))}),(function(e){return kf(e)}),Tf,Sf,(function(t,r){return Fl(e,t,r)}));case 2:case"end":return a.stop()}}),a)})))}function Yd(e,t,r,n,i){return Gd(this,void 0,void 0,D.a.mark((function o(){return D.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!ur("bfbedusug")){o.next=3;break}return o.next=3,Kd(n,i,"educationAssignments",(function(){return Au(t,r)}),(function(e){return wf(e)}),xf,Cf,(function(t,r){return Ul(e,t,r)}));case 3:case"end":return o.stop()}}),o)})))}function $d(e,t,r,n,i,o){return Gd(this,void 0,void 0,D.a.mark((function a(){var s=this;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Kd(r,n,"mru",(function(){return Gd(s,void 0,void 0,D.a.mark((function e(){var r,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Xu(i)){e.next=7;break}return e.next=3,Hu(o);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.next=9,Qu(t,{},i);case 9:return n=e.sent,e.abrupt("return",n.value||[]);case 11:case"end":return e.stop()}}),e)})))}),(function(e){return Of(e)}),Ef,Pf,(function(t,r){return $f(e,t,r)}));case 2:case"end":return a.stop()}}),a)})))}function ep(e,t,r,n,i,o,a,s,c,u){return Gd(this,void 0,void 0,D.a.mark((function l(){var f=this;return D.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Kd(n,i,"recipient",(function(){return Gd(f,void 0,void 0,D.a.mark((function e(){var n,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},!ur("msbqflokippl")){e.next=8;break}return e.next=4,_a(t,r,o,{},a,s,c);case 4:return n=e.sent,e.abrupt("return",n.value||[]);case 8:if(!Xu(c)){e.next=15;break}return e.next=11,aa(u);case 11:return i=e.sent,e.abrupt("return",i);case 15:return e.next=17,oa(t,{},c);case 17:return n=e.sent,e.abrupt("return",n.value||[]);case 19:case"end":return e.stop()}}),e)})))}),(function(e){return If(e)}),Af,Rf,(function(t,r){return dd(e,t,r)}));case 2:case"end":return l.stop()}}),l)})))}function tp(e,t,r,n,i){return Gd(this,void 0,void 0,D.a.mark((function o(){var a=this;return D.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Kd(r,n,"group",(function(){return Gd(a,void 0,void 0,D.a.mark((function e(){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fu(t,{},i);case 2:return r=e.sent,e.abrupt("return",r.value||[]);case 4:case"end":return e.stop()}}),e)})))}),(function(e){return jf(e)}),Df,Mf,(function(t,r){return Kl(e,t,r)}));case 2:case"end":return o.stop()}}),o)})))}function rp(e,t,r,n){return Gd(this,void 0,void 0,D.a.mark((function i(){return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Kd(t,r,"topBookmarks",(function(){return Wd(e)}),(function(e){return Hf(e)}),Vf,Kf,(function(e,t){return Qd(n,e,t)}));case 2:case"end":return i.stop()}}),i)})))}function np(e,t){return Gd(this,void 0,void 0,D.a.mark((function r(){var n,i,o,a,s,c,u,l;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=4;break}return r.next=3,Uf([]);case 3:return r.abrupt("return");case 4:return r.prev=4,r.next=7,Wf();case 7:n=r.sent,r.next=16;break;case 10:return r.prev=10,r.t0=r.catch(4),r.next=15,Uf([]);case 15:return r.abrupt("return");case 16:i=ip(n),o=!0,a=!1,s=void 0,r.prev=20,c=Ho()(i);case 22:if(o=(u=c.next()).done){r.next=29;break}return l=u.value,r.next=26,e.build(l.query,l.inputs,!1);case 26:o=!0,r.next=22;break;case 29:r.next=35;break;case 31:r.prev=31,r.t1=r.catch(20),a=!0,s=r.t1;case 35:r.prev=35,r.prev=36,o||null==c.return||c.return();case 38:if(r.prev=38,!a){r.next=41;break}throw s;case 41:return r.finish(38);case 42:return r.finish(35);case 43:return r.next=45,Uf(i);case 45:case"end":return r.stop()}}),r,null,[[4,10],[20,31,35,43],[36,,38,42]])})))}function ip(e){var t=[],r=$u(-1440),n=!0,i=!1,o=void 0;try{for(var a,s=Ho()(e);!(n=(a=s.next()).done);n=!0){var c=a.value;c.timestamp&&c.timestamp>r&&t.push(c)}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return t}function op(e,t,r,n,i){return Gd(this,void 0,void 0,D.a.mark((function o(){var a,s,c,u,l,f,d,p,h,v,g,_,y,b,m,k,T,S,w,x,C,O,E,P,I;return D.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=t.msbRestProvider,s=t.graphRestProvider,c=t.lokiRestProvider,u=t.options,l=t.loggerContext,u&&a&&s){o.next=3;break}throw new Error("QueryFormulationContext was not initialized properly. One of the fields is null");case 3:if(!ur("msbqflokippl")||c){o.next=5;break}throw new Error("QueryFormulationContext was not initialized properly. lokiRestProvider is null");case 5:if(f=u.clientType,d=u.culture,p=t.userContext,h=t.isDataStoreSupported,v=p.isDataLoadAllowed,g=p.userInfo,_=u.environment,y=u.clientCorrelationId,g){o.next=11;break}throw new Error("QueryFormulationContext was not initialized properly, userinfo is null");case 11:if(v){o.next=17;break}if(!h){o.next=16;break}return o.next=15,np(e);case 15:e.markDirty();case 16:return o.abrupt("return");case 17:return Xu(u)&&(b=Ju(a,y,l,d,["People","Files"],u)),Yu()&&(m=Ju(a,y,l,d,["Bookmark"],u),k=Ju(a,y,l,d,["Qna","Building"],u)),T=ra(u,ea.HqfFile)?$d(e,s,r,n,u,b):L.a.resolve(),S=ra(u,ea.HqfPeople)?ep(e,s,c,r,n,g.user.id,y,_,u,b):L.a.resolve(),w=ra(u,ea.HqfBookmark)?Zd(e,a,f,r,n,m):L.a.resolve(),x=ra(u,ea.HqfQna)?Jd(e,a,f,r,n,k):L.a.resolve(),C=ra(u,ea.HqfBuilding)?Xd(e,a,f,r,n,k):L.a.resolve(),O=ra(u,ea.HqfGroup)?tp(e,s,r,n,u):L.a.resolve(),E=ra(u,ea.HqfEducationAssignment)&&ur("bfbedusug")?Yd(e,a,f,r,n):L.a.resolve(),P=ra(u,ea.HqfTopBookmark)&&ur("bfbzqfwork")?rp(t,r,n,e):L.a.resolve(),I=np(e,i),o.next=30,L.a.all([w,x,C,E,T,S,O,I,P]);case 30:case"end":return o.stop()}}),o)})))}function ap(e){return Gd(this,void 0,void 0,D.a.mark((function t(){var r,n,i,o,a,s,c,u,l,f,d,p,h;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=ra(e,ea.HqfBookmark)?_f():L.a.resolve(),n=ra(e,ea.HqfQna)?mf():L.a.resolve(),i=ra(e,ea.HqfBuilding)?Sf():L.a.resolve(),o=ra(e,ea.HqfFile)?Pf():L.a.resolve(),a=ra(e,ea.HqfPeople)?Rf():L.a.resolve(),s=ra(e,ea.HqfGroup)?Mf():L.a.resolve(),c=Nf(),u=ff("servertrie","input"),l=ff("user","info"),f=ff("refreshtime","time"),d=ff("variants","variants"),p=ra(e,ea.HqfEducationAssignment)&&ur("bfbedusug")?Cf():L.a.resolve(),h=ra(e,ea.HqfTopBookmark)&&ur("bfbzqfwork")?Kf():L.a.resolve(),t.next=15,L.a.all([r,n,i,o,a,s,c,u,l,f,d,p,h]);case 15:case"end":return t.stop()}}),t)})))}function sp(e){return Gd(this,void 0,void 0,D.a.mark((function t(){var r,n,i,o,a,s;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=pd(10),n=ed(10),i=qd(10,e),t.next=5,L.a.all([n,r,i]);case 5:return o=t.sent,a=[].concat(R(o[0]),R(o[1]),R(o[2])),s={suggestions:ze(a,(function(e){return(t=e).confidence="Low",t;var t}))},t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})))}(Object(ct.declareString)("search-components-group.search.shared.groupsTitleWithCount1")),(Object(ct.declareStringWithPlaceholders)("search-components-group.search.shared.groupsTitleWithCount"));(Object(ct.declareStringWithPlaceholders)("search-components-group.search.group.membersCount")),(Object(ct.declareStringWithPlaceholders)("search-components-group.search.group.membersCountMax")),(Object(ct.declareString)("search-components-group.search.group.membersCount1")),(Object(ct.declareString)("search-components-group.search.group.group")),(Object(ct.declareString)("search-components-group.search.group.privateDistributionList"));var cp=(Object(ct.declareString)("search-components-group.search.group.distributionList")),up=((Object(ct.declareString)("search-components-group.search.group.groups")),(Object(ct.declareString)("search-components-group.search.group.groupsUppercase")),(Object(ct.declareString)("search-components-group.search.group.groupsLowercase")),(Object(ct.declareString)("search-components-group.search.group.publicGroup"))),lp=(Object(ct.declareString)("search-components-group.search.group.privateGroup"));(Object(ct.declareString)("search-components-group.search.group.groupConversations")),(Object(ct.declareString)("search-components-group.search.group.groupFiles")),(Object(ct.declareString)("search-components-group.search.group.groupMembers")),(Object(ct.declareString)("search-components-group.search.group.groupOwners")),(Object(ct.declareStringWithPlaceholders)("search-core.search.group.membersHeader")),(Object(ct.declareString)("search-core.search.group.seeAllMembers")),(Object(ct.declareString)("search-core.search.group.membersTab")),(Object(ct.declareString)("search-core.search.group.members")),(Object(ct.declareString)("search-core.search.group.seeGroupMembersAriaLabel")),(Object(ct.declareString)("search-core.search.group.overview")),(Object(ct.declareString)("search-core.search.group.aboutUppercase"));function fp(e){var t=e.isO365Group,r=e.isPrivate;return t?r?lp():up():cp()}function dp(e){if(!e)return e;switch(e.domain){case"Group":return function(e){if(!e)return e;var t=e.isO365Group,r=e.isPrivate,n=Mn(e);return n.title=fp({isO365Group:t,isPrivate:r}).toUpperCase(),n}(e);case"File":case"Building":return function(e){if(!e||!e.title)return e;var t=Mn(e);return t.title=e.title.toUpperCase(),t}(e);default:return e}}r(46),Object(nt.a)((function(e,t){if(null==e)return[];var r=t.length;return r>1&&Object(kt.a)(e,t[0],t[1])?t=[]:r>2&&Object(kt.a)(t[0],t[1],t[2])&&(t=[t[0]]),Wn(e,rt(t,1),[])}));var pp=function(e){return function(t){t=me(t);var r=Gn(t)?bi(t):void 0,n=r?r[0]:t.charAt(0),i=r?Jo(r,1).join(""):t.slice(1);return n[e]()+i}}("toUpperCase");var hp=function(e){return pp(me(e).toLowerCase())};var vp=function(e){return function(t){return null==e?void 0:e[t]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),gp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_p=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var yp=function(e){return(e=me(e))&&e.replace(gp,vp).replace(_p,"")},bp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var mp=function(e){return e.match(bp)||[]},kp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Tp=function(e){return kp.test(e)},Sp="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",wp="["+Sp+"]",xp="\\d+",Cp="[\\u2700-\\u27bf]",Op="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ep="[^\\ud800-\\udfff"+Sp+xp+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Pp="(?:\\ud83c[\\udde6-\\uddff]){2}",Ip="[\\ud800-\\udbff][\\udc00-\\udfff]",Ap="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Rp="(?:"+Op+"|"+Ep+")",jp="(?:"+Ap+"|"+Ep+")",Dp="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Mp="[\\ufe0e\\ufe0f]?"+Dp+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Pp,Ip].join("|")+")[\\ufe0e\\ufe0f]?"+Dp+")*"),Lp="(?:"+[Cp,Pp,Ip].join("|")+")"+Mp,Fp=RegExp([Ap+"?"+Op+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[wp,Ap,"$"].join("|")+")",jp+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[wp,Ap+Rp,"$"].join("|")+")",Ap+"?"+Rp+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ap+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",xp,Lp].join("|"),"g");var Bp=function(e){return e.match(Fp)||[]};var Np=function(e,t,r){return e=me(e),void 0===(t=r?void 0:t)?Tp(e)?Bp(e):mp(e):e.match(t)||[]},Wp=RegExp("['’]","g");var Up;zp=function(e,t,r){return t=t.toLowerCase(),e+(r?hp(t):t)};var zp;!function(e){e[e.Other=0]="Other",e[e.None=1]="None",e[e.Word=2]="Word",e[e.Excel=3]="Excel",e[e.PowerPoint=4]="PowerPoint",e[e.Pdf=5]="Pdf",e[e.Story=6]="Story",e[e.Video=7]="Video",e[e.ExternalWebPage=8]="ExternalWebPage",e[e.OneNote=9]="OneNote",e[e.InfoPath=10]="InfoPath",e[e.Visio=11]="Visio",e[e.Publisher=12]="Publisher",e[e.Project=13]="Project",e[e.Access=14]="Access",e[e.Mail=15]="Mail",e[e.Csv=16]="Csv",e[e.Archive=17]="Archive",e[e.Xps=18]="Xps",e[e.Audio=19]="Audio",e[e.Image=20]="Image",e[e.Web=21]="Web",e[e.Text=22]="Text",e[e.Xml=23]="Xml",e[e.Sketch=24]="Sketch",e[e.OneNotePage=25]="OneNotePage",e[e.Folder=26]="Folder",e[e.GDOC=27]="GDOC",e[e.GSLIDES=28]="GSLIDES",e[e.GSHEET=29]="GSHEET",e[e.GDRAW=30]="GDRAW",e[e.GTABLE=31]="GTABLE",e[e.GFORM=32]="GFORM"}(Up||(Up={}));var qp=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Qp(e,t,r,n){return qp(this,void 0,void 0,D.a.mark((function i(){var o,a,s,c,u,l,f;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return c=Ii(),u=new Date,i.prev=2,i.next=5,e();case 5:o=i.sent,i.next=13;break;case 8:throw i.prev=8,i.t0=i.catch(2),a=i.t0,s=null==a?void 0:a.message,i.t0;case 13:return i.prev=13,l=Ii(),f=new Date,t({response:o,startTime:c,endTime:l,startDateTime:u,endDateTime:f,errorMessage:s,requestError:a,eventId:r,qfLoggerContext:n}),i.finish(13);case 19:return i.abrupt("return",o);case 20:case"end":return i.stop()}}),i,null,[[2,8,13,19]])})))}var Gp=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};function Hp(e,t,r){var n={messageType:yu.OnGetSuggestions,query:t,suggestions:r};e.postMessage(n)}function Vp(e,t,r){var n={messageType:yu.OnGetExtraSuggestions,query:t,suggestions:r};e.postMessage(n)}function Kp(e,t){var r={messageType:yu.OnGetZeroQfSuggestions,suggestions:t};e.postMessage(r)}function Zp(e,t,r){var n={messageType:yu.setAccessToken,token:t,success:r};e.postMessage(n)}function Jp(e,t,r){var n={messageType:t,id:r};e.postMessage(n)}function Xp(e,t){var r={messageType:yu.logRoundTripData,data:t};e.postMessage(r)}function Yp(e,t){var r={messageType:yu.OnHandleTenantSwitch,isTenantSwitched:t};e.postMessage(r)}function $p(e,t,r,n){var i,o=n&&n.count||4;if(ii(t.suggestions)>=o||t.clientOnly)return!0;var a=n&&n.serverSuggestionOptions,s=bl(r).length;if(a&&(a.skipServerSuggestions||a.minimumQueryLength&&a.minimumQueryLength>s))return!0;var c=null===(i=(e&&e.getWorkerContext()).options)||void 0===i?void 0:i.hqfCfg;if(c&&c.isStdEnabled){var u=(e&&e.getWorkerContext()).serverTrieInput;if(u&&u.length>0)return u.findIndex((function(e){return r===e.query}))>-1}return!1}function eh(e,t,r,n){return Gp(this,void 0,void 0,D.a.mark((function i(){var o,a,s,c,u,l;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=Ii(),a=!!(null==n?void 0:n.qfLoggerContext),s=[],c={},ur("bfbsuggestionlog")&&(c.QueryLen=(null==r?void 0:r.length)||0),lt("QueryFormulation::onGetSuggestions",r),r&&!Ui(r)){i.next=11;break}return ur("bfbsuggestionlog")&&(c.isQueryEmpty="true",Do(t,c)),Hp(e,"",[]),Vp(e,"",[]),i.abrupt("return");case 11:if(!a){i.next=17;break}return i.next=14,Qp((function(){return e.getSuggestions(r,n)}),(function(t){return Xp(e,t)}),"QueryFormulation_Client_RoundTripTime",null==n?void 0:n.qfLoggerContext);case 14:i.t0=i.sent,i.next=20;break;case 17:return i.next=19,e.getSuggestions(r,n);case 19:i.t0=i.sent;case 20:if(u=i.t0){i.next=26;break}return ur("bfbsuggestionlog")&&(c.isSearchResultUndefined="true",Do(t,c)),Hp(e,r,[]),Vp(e,r,[]),i.abrupt("return");case 26:o&&(l=tl(o))&&lt("QueryFormulation::onGetSuggestions got results in ".concat(l," ms"),r),Hp(e,r,u.suggestions),a&&(s=s.concat(u.suggestions)),$p(e,u,r,n)?(ur("bfbsuggestionlog")&&(c.CacheHit="true"),Vp(e,r,[])):e.getServerSuggestions(r,u.suggestions,n).then((function(n){lt("QueryFormulation::onGetSuggestions got response from server",r,n);var i=n&&n.suggestions||[];Vp(e,r,i),ur("bfbservertrielog")&&jo(t,r,i),a&&(s=s.concat(i)),ur("bfbsuggestionlog")&&(c.CacheMiss="true",c.ServerSuggCount=null==n?void 0:n.suggestions.length,Do(t,c))})),ur("bfbsuggestionlog")&&(c.ClntSuggCount=null==u?void 0:u.suggestions.length,Do(t,c));case 31:case"end":return i.stop()}}),i)})))}function th(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){var n;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getZeroQuerySuggestions(t);case 2:if(n=r.sent){r.next=6;break}return Kp(e,[]),r.abrupt("return");case 6:return Kp(e,n.suggestions),r.abrupt("return");case 8:case"end":return r.stop()}}),r)})))}function rh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(lt("QueryFormulation::onSetAccessToken"),t){r.next=5;break}return Zp(e,t,!1),r.abrupt("return");case 5:return r.next=7,e.setAccessToken(t);case 7:Zp(e,t,!0),lt("QueryFormulation::onSetAccessToken successfully updated token");case 9:case"end":return r.stop()}}),r)})))}function nh(e){return Gp(this,void 0,void 0,D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.initializeData();case 2:Jp(e,yu.OnInitialize),e.isDataLoaded()&&Jp(e,yu.OnDataLoaded);case 4:case"end":return t.stop()}}),t)})))}function ih(e){return Gp(this,void 0,void 0,D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isDataInitialized()&&Jp(e,yu.OnInitialize);case 1:case"end":return t.stop()}}),t)})))}function oh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.initializeHost(t.options);case 2:Jp(e,yu.OnInitializeHost,t.id);case 3:case"end":return r.stop()}}),r)})))}function ah(e,t){e.localize(t.culture,t.strings),Jp(e,yu.OnLocalize,t.id)}function sh(e,t){e.onPostLoad(),Jp(e,yu.OnPostLoad,t)}function ch(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.onSignIn();case 2:Jp(e,yu.OnSignIn,t);case 3:case"end":return r.stop()}}),r)})))}function uh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.onSignOut();case 2:Jp(e,yu.OnSignOut,t);case 3:case"end":return r.stop()}}),r)})))}function lh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.onSoftSignOut();case 2:Jp(e,yu.OnSoftSignOut,t);case 3:case"end":return r.stop()}}),r)})))}function fh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.refreshData();case 2:Jp(e,yu.OnRefreshData,t);case 3:case"end":return r.stop()}}),r)})))}function dh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.rebuildData();case 2:Jp(e,yu.OnRebuildData,t);case 3:case"end":return r.stop()}}),r)})))}function ph(e,t){e.clearTrie(),Jp(e,yu.OnClearTrie,t)}function hh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.saveTrie();case 2:Jp(e,yu.OnSaveTrie,t);case 3:case"end":return r.stop()}}),r)})))}function vh(e,t){return Gp(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.deleteAllData();case 2:Jp(e,yu.OnDeleteData,t);case 3:case"end":return r.stop()}}),r)})))}function gh(e,t,r){return Gp(this,void 0,void 0,D.a.mark((function n(){var i;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.handleTenantSwitch(t,r);case 2:i=n.sent,Yp(e,i);case 4:case"end":return n.stop()}}),n)})))}var _h=[{charCount:0,fuzzyCount:0},{charCount:6,fuzzyCount:1},{charCount:10,fuzzyCount:2}],yh={"@":[{char:"@",score:0},{char:"",score:11500}],"":[{char:"@",score:11500},{char:"-",score:11500},{char:".",score:11500},{char:",",score:11500},{char:"a",score:11500},{char:"b",score:11500},{char:"c",score:11500},{char:"d",score:11500},{char:"e",score:11500},{char:"f",score:11500},{char:"g",score:11500},{char:"h",score:11500},{char:"i",score:11500},{char:"j",score:11500},{char:"k",score:11500},{char:"l",score:11500},{char:"m",score:11500},{char:"n",score:11500},{char:"o",score:11500},{char:"p",score:11500},{char:"q",score:11500},{char:"r",score:11500},{char:"s",score:11500},{char:"t",score:11500},{char:"u",score:11500},{char:"v",score:11500},{char:"w",score:11500},{char:"x",score:11500},{char:"y",score:11500},{char:"z",score:11500},{char:"0",score:11500},{char:"1",score:11500},{char:"2",score:11500},{char:"3",score:11500},{char:"4",score:11500},{char:"5",score:11500},{char:"6",score:11500},{char:"7",score:11500},{char:"8",score:11500},{char:"9",score:11500},{char:"æ",score:11500},{char:"ø",score:11500},{char:"å",score:11500},{char:"(",score:1e3},{char:")",score:1e3},{char:'"',score:1e3},{char:"-",score:11500},{char:" ",score:11500}],"-":[{char:"",score:11500},{char:" ",score:11500}],".":[{char:"",score:11500}],",":[{char:"",score:11500}],a:[{char:"",score:11500},{char:"q",score:11500},{char:"s",score:6e3},{char:"w",score:11500},{char:"x",score:6e3},{char:"i",score:6e3},{char:"z",score:11500},{char:"à",score:1e4},{char:"á",score:1e4},{char:"â",score:1e4},{char:"ã",score:1e4},{char:"ä",score:1e4},{char:"å",score:1e4}],b:[{char:"",score:11500},{char:"f",score:6e3},{char:"g",score:11500},{char:"h",score:11500},{char:"n",score:6e3},{char:"v",score:6e3}],c:[{char:"",score:11500},{char:"d",score:11500},{char:"f",score:11500},{char:"v",score:6e3},{char:"x",score:6e3},{char:"ç",score:1e4}],d:[{char:"",score:11500},{char:"c",score:11500},{char:"e",score:11500},{char:"f",score:6e3},{char:"r",score:11500},{char:"s",score:6e3},{char:"w",score:6e3},{char:"x",score:11500}],e:[{char:"",score:11500},{char:"d",score:11500},{char:"f",score:6e3},{char:"r",score:6e3},{char:"s",score:11500},{char:"w",score:6e3},{char:"3",score:6e3},{char:"4",score:6e3},{char:"è",score:1e4},{char:"é",score:1e4},{char:"ê",score:1e4},{char:"ë",score:1e4}],f:[{char:"",score:11500},{char:"b",score:6e3},{char:"c",score:11500},{char:"d",score:6e3},{char:"e",score:6e3},{char:"g",score:6e3},{char:"r",score:11500},{char:"t",score:11500},{char:"v",score:11500}],g:[{char:"",score:11500},{char:"b",score:11500},{char:"f",score:6e3},{char:"h",score:6e3},{char:"n",score:6e3},{char:"r",score:6e3},{char:"t",score:11500},{char:"v",score:11500},{char:"y",score:11500}],h:[{char:"",score:11500},{char:"b",score:11500},{char:"g",score:6e3},{char:"j",score:6e3},{char:"n",score:11500},{char:"t",score:6e3},{char:"u",score:11500},{char:"y",score:11500}],i:[{char:"",score:11500},{char:"j",score:11500},{char:"k",score:11500},{char:"l",score:6e3},{char:"a",score:6e3},{char:"o",score:6e3},{char:"u",score:6e3},{char:"8",score:6e3},{char:"9",score:6e3},{char:"ì",score:1e4},{char:"í",score:1e4},{char:"î",score:1e4},{char:"ï",score:1e4}],j:[{char:"",score:11500},{char:"h",score:6e3},{char:"i",score:11500},{char:"k",score:6e3},{char:"m",score:11500},{char:"n",score:11500},{char:"u",score:11500},{char:"y",score:6e3}],k:[{char:"",score:11500},{char:"i",score:11500},{char:"j",score:6e3},{char:"l",score:6e3},{char:"m",score:11500},{char:"o",score:11500},{char:"u",score:6e3},{char:"ø",score:6e3}],l:[{char:"",score:11500},{char:"i",score:6e3},{char:"k",score:6e3},{char:"m",score:6e3},{char:"o",score:11500},{char:"p",score:11500},{char:"æ",score:6e3},{char:"ø",score:6e3},{char:"å",score:6e3}],m:[{char:"",score:11500},{char:"j",score:11500},{char:"k",score:11500},{char:"n",score:6e3}],n:[{char:"",score:11500},{char:"b",score:6e3},{char:"g",score:6e3},{char:"h",score:11500},{char:"j",score:11500},{char:"m",score:6e3},{char:"ñ",score:1e4}],o:[{char:"",score:11500},{char:"i",score:6e3},{char:"k",score:11500},{char:"l",score:11500},{char:"p",score:6e3},{char:"9",score:6e3},{char:"0",score:6e3},{char:"ò",score:1e4},{char:"ó",score:1e4},{char:"ô",score:1e4},{char:"õ",score:1e4},{char:"ö",score:1e4},{char:"ø",score:1e4}],p:[{char:"",score:11500},{char:"l",score:11500},{char:"o",score:6e3},{char:"æ",score:6e3},{char:"ø",score:6e3},{char:"å",score:6e3},{char:"0",score:6e3}],q:[{char:"",score:11500},{char:"a",score:11500},{char:"s",score:6e3},{char:"w",score:6e3},{char:"1",score:6e3},{char:"2",score:6e3}],r:[{char:"",score:11500},{char:"d",score:11500},{char:"e",score:6e3},{char:"f",score:11500},{char:"g",score:6e3},{char:"t",score:6e3},{char:"4",score:6e3},{char:"5",score:6e3}],s:[{char:"",score:11500},{char:"a",score:6e3},{char:"d",score:6e3},{char:"e",score:11500},{char:"q",score:6e3},{char:"w",score:11500},{char:"x",score:11500},{char:"z",score:11500},{char:"ß",score:1e4}],t:[{char:"",score:11500},{char:"f",score:11500},{char:"g",score:11500},{char:"h",score:6e3},{char:"r",score:6e3},{char:"y",score:6e3},{char:"5",score:6e3},{char:"6",score:6e3}],u:[{char:"",score:11500},{char:"h",score:11500},{char:"i",score:6e3},{char:"j",score:11500},{char:"k",score:6e3},{char:"y",score:6e3},{char:"7",score:6e3},{char:"8",score:6e3},{char:"ù",score:1e4},{char:"ú",score:1e4},{char:"û",score:1e4},{char:"ü",score:1e4}],v:[{char:"",score:11500},{char:"b",score:6e3},{char:"c",score:6e3},{char:"d",score:6e3},{char:"f",score:11500},{char:"g",score:11500}],w:[{char:"",score:11500},{char:"a",score:11500},{char:"d",score:6e3},{char:"e",score:6e3},{char:"q",score:6e3},{char:"s",score:11500},{char:"2",score:6e3},{char:"3",score:6e3}],x:[{char:"",score:11500},{char:"c",score:6e3},{char:"d",score:11500},{char:"s",score:11500},{char:"z",score:6e3},{char:"ks",score:6500}],y:[{char:"",score:11500},{char:"g",score:11500},{char:"h",score:11500},{char:"j",score:6e3},{char:"t",score:6e3},{char:"u",score:6e3},{char:"6",score:6e3},{char:"7",score:6e3},{char:"ý",score:1e4},{char:"ÿ",score:1e4}],z:[{char:"",score:11500},{char:"a",score:11500},{char:"s",score:11500},{char:"x",score:6e3}],0:[{char:"",score:11500},{char:"9",score:6e3},{char:"o",score:6e3},{char:"p",score:6e3}],1:[{char:"",score:11500},{char:"2",score:6e3},{char:"q",score:6e3}],2:[{char:"",score:11500},{char:"1",score:6e3},{char:"3",score:6e3},{char:"q",score:6e3},{char:"w",score:6e3}],3:[{char:"",score:11500},{char:"2",score:6e3},{char:"4",score:6e3},{char:"w",score:6e3},{char:"e",score:6e3}],4:[{char:"",score:11500},{char:"3",score:6e3},{char:"5",score:6e3},{char:"e",score:6e3},{char:"r",score:6e3}],5:[{char:"",score:11500},{char:"4",score:6e3},{char:"6",score:6e3},{char:"r",score:6e3},{char:"t",score:6e3}],6:[{char:"",score:11500},{char:"5",score:6e3},{char:"7",score:6e3},{char:"t",score:6e3},{char:"y",score:6e3}],7:[{char:"",score:11500},{char:"6",score:6e3},{char:"8",score:6e3},{char:"y",score:6e3},{char:"u",score:6e3}],8:[{char:"",score:11500},{char:"7",score:6e3},{char:"9",score:6e3},{char:"u",score:6e3},{char:"i",score:6e3}],9:[{char:"",score:11500},{char:"8",score:6e3},{char:"0",score:6e3},{char:"i",score:6e3},{char:"o",score:6e3}],"æ":[{char:"",score:11500},{char:"l",score:6e3},{char:"p",score:6e3},{char:"ø",score:6e3},{char:"å",score:6e3}],"ø":[{char:"",score:11500},{char:"k",score:6e3},{char:"l",score:6e3},{char:"o",score:1e4},{char:"p",score:6e3},{char:"æ",score:6e3},{char:"å",score:6e3}],"å":[{char:"",score:11500},{char:"l",score:6e3},{char:"o",score:6e3},{char:"p",score:6e3},{char:"æ",score:6e3},{char:"ø",score:6e3}],"(":[{char:"",score:1e3}],")":[{char:"",score:1e3}],'"':[{char:"",score:1e3}],"'":[{char:"",score:11500}]," ":[{char:"-",score:11500}]};function bh(e,t,r,n,i,o,a,s,c,u,l){for(;r&&e<t.length;){if(r.pruned&&l)return void kh(e,t,r,n,i,o,a,s,c,u,l);var f=t[e];if(c&&wh(e,t,i)&&mh(f,r,e,t,n,i,o,a,s,c,u,l),!r[f]){r=null;break}r=r[f],a=a||r.clientOnly||!1,n+=5e4,s+=f,e++}if(r&&(!c||c&&0!==i)){var d=n+-12e3*i;(void 0===u[s]||u[s]<d)&&(!function(e,t,r,n,i,o){var a={score:e,fuzzyCount:t,indices:r.indices,clientOnly:n,query:i};o.push(a)}(d,i,r,a,s,o),u[s]=d)}}function mh(e,t,r,n,i,o,a,s,c,u,l,f){var d=yh[e];if(d&&d.length)for(var p=0;p<d.length;p++){var h=d[p],v=t[h.char];v?bh(r+1,n,v,i+h.score,o+1,a,s||v.clientOnly||!1,c+h.char,u,l,f):""===h.char&&bh(r+1,n,t,i+h.score,o+1,a,s,c+h.char,u,l,f)}for(var g=yh[""],_=0;_<g.length;_++){var y=g[_],b=t[y.char];b&&bh(r,n,b,i+y.score,o+1,a,s||b.clientOnly||!1,c+y.char,u,l,f)}}function kh(e,t,r,n,i,o,a,s,c,u,l){var f=!0,d=!1,p=void 0;try{for(var h,v=Ho()(r.indices);!(f=(h=v.next()).done);f=!0){var g=h.value,_=l(g),y=null==_?void 0:_.keywords;if(void 0!==y&&0!==y.length){var b=null==_?void 0:_.serverQuery,m=!0,k=!1,T=void 0;try{for(var S,w=Ho()(y);!(m=(S=w.next()).done);m=!0){var x=S.value;x.length>s.length&&x.substr(0,s.length)===s&&Th(e,t,g,n,i,o,a,s,c,u,x,b)}}catch(e){k=!0,T=e}finally{try{m||null==w.return||w.return()}finally{if(k)throw T}}}}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}}function Th(e,t,r,n,i,o,a,s,c,u,l,f){for(;s.length<l.length&&e<t.length;){var d=t[e];if(c&&wh(e,t,i)&&Sh(d,r,e,t,n,i,o,a,s,c,u,l,f),d!==l[s.length])break;n+=5e4,s+=d,e++}if(e===t.length&&(!c||c&&0!==i)){var p=n+-12e3*i,h=!!f&&(0===s.indexOf(f)&&f.length>3);(void 0===u[s]||u[s]<=p)&&(!function(e,t,r,n,i,o){var a={score:e,fuzzyCount:t,indices:[r],clientOnly:n,query:i};o.push(a)}(p,i,r,a||h,s,o),u[s]=p)}}function Sh(e,t,r,n,i,o,a,s,c,u,l,f,d){var p=yh[e];if(p&&p.length)for(var h=0;h<p.length;h++){var v=p[h];(v.char===f[c.length]||""===v.char)&&Th(r+1,n,t,i+v.score,o+1,a,s,c+v.char,u,l,f,d)}for(var g=yh[""],_=0;_<g.length;_++){var y=g[_];if(y.char===f[c.length]){Th(r,n,t,i+y.score,o+1,a,s,c+y.char,u,l,f,d);break}}}function wh(e,t,r){var n=0===e,i=vd(t,_h);return!!(!n&&i&&r<i.fuzzyCount)}function xh(e,t,r,n,i,o){bh(0,e,t,0,0,r,n,"",i,{},o)}function Ch(e,t,r){return e[t]?function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1}(e[t].indices,r)||e[t].indices.push(r):e[t]={indices:[r]},e[t]}var Oh,Eh=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ph=function(){function e(){n(this,e),this.root={indices:[]},this.trieData={},this.trieDataArray=[],this.isDirty=!1,this.isIncomplete=!1}return w(e,[{key:"getSuggestions",value:function(e){var t=this,r=[];return xh(e,this.root,r,!1,!1,(function(e){return t.getSuggestionInfo(e)})),function(e,t){for(var r=0,n=0;n<e.length;n++)if((r+=e[n].indices?e[n].indices.length:0)>=t)return!0;return!1}(r,4)||xh(e,this.root,r,!1,!0,(function(e){return t.getSuggestionInfo(e)})),r}},{key:"resolveIndex",value:function(e){if(e<this.trieDataArray.length)return this.trieDataArray[e]}},{key:"getSuggestionInfo",value:function(e){var t=this.resolveIndex(e);if(t){var r=t.isServerSuggestion?t.userQuery:void 0;return{keywords:Id(t),serverQuery:r}}}},{key:"build",value:function(e,t,r){return Eh(this,void 0,void 0,D.a.mark((function n(){var i,o,a,s,c,u,l,f,d,p,h,v;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(lt("SuggestionTrie::build",e,t.length,r),!t){n.next=50;break}i=!0,o=!1,a=void 0,n.prev=5,s=Ho()(t);case 7:if(i=(c=s.next()).done){n.next=32;break}if(!(u=c.value).suggestion||Object(St.a)(u.keywords)){n.next=29;break}for(l=!0,f=!1,d=void 0,n.prev=13,p=Ho()(u.keywords);!(l=(h=p.next()).done);l=!0)v=h.value,this.addKeyword(v,u.suggestion),this.isDirty=!0;n.next=21;break;case 17:n.prev=17,n.t0=n.catch(13),f=!0,d=n.t0;case 21:n.prev=21,n.prev=22,l||null==p.return||p.return();case 24:if(n.prev=24,!f){n.next=27;break}throw d;case 27:return n.finish(24);case 28:return n.finish(21);case 29:i=!0,n.next=7;break;case 32:n.next=38;break;case 34:n.prev=34,n.t1=n.catch(5),o=!0,a=n.t1;case 38:n.prev=38,n.prev=39,i||null==s.return||s.return();case 41:if(n.prev=41,!o){n.next=44;break}throw a;case 44:return n.finish(41);case 45:return n.finish(38);case 46:if(e&&(this.recordQueryData(e),this.isDirty=!0),!r){n.next=50;break}return n.next=50,this.save();case 50:case"end":return n.stop()}}),n,this,[[5,34,38,46],[13,17,21,29],[22,,24,28],[39,,41,45]])})))}},{key:"size",value:function(){return this.trieSize(this.root)}},{key:"prune",value:function(e){var t={indices:[]},r=e||1;this.clonePruned(this.root,t,r),this.root=t,this.isDirty=!0}},{key:"trieSize",value:function(e){if(!e)return 0;var t=1;for(var r in e)e[r]&&e[r].indices&&(t+=this.trieSize(e[r]));return t}},{key:"clonePruned",value:function(e,t,r){if(e.indices.length<=r&&e!==this.root)t.pruned=!0;else for(var n in e)if(e[n]&&e[n].indices){var i=e[n];t[n]={indices:i.indices.slice()},this.clonePruned(i,t[n],r)}}},{key:"load",value:function(e){return Eh(this,void 0,void 0,D.a.mark((function t(){var r,n,i,o,a,s;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!1,n=function(){r||(r=!0,e(!0))},t.prev=2,i=Lf(n),o=Ff(n),t.next=7,L.a.all([i,o]);case 7:return t.next=9,i;case 9:return a=t.sent,t.next=12,o;case 12:s=t.sent,this.assign(a,s),t.next=21;break;case 16:return t.prev=16,t.t0=t.catch(2),lt("Unable to load trie. Reloading data...",t.t0),t.next=21,e(!1);case 21:case"end":return t.stop()}}),t,this,[[2,16]])})))}},{key:"loadWithStaleRefresh",value:function(e,t){return Eh(this,void 0,void 0,D.a.mark((function r(){var n,i,o,a,s,c,u,l;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=pf("trie","trie"),i=pf("trie","triedata"),o=qf(),r.next=6,L.a.all([n,i,o]);case 6:a=r.sent,s=Vo(a,3),c=s[0],u=s[1],l=s[2],this.assign(c,u),l&&(ur("bfbindexdblog")&&Mo(t,"timerefresh",""),e(!0)),r.next=21;break;case 15:return r.prev=15,r.t0=r.catch(0),ur("bfbindexdblog")&&Mo(t,"newUser",""),lt("Unable to load trie. Refreshing data...",r.t0),r.next=21,e(!1);case 21:case"end":return r.stop()}}),r,this,[[0,15]])})))}},{key:"save",value:function(){return Eh(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("SuggestionTrie::save"),e.prev=1,e.next=4,Bf(this.root,this.trieDataArray);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),lt("Unable to save trie. Trying to remove existing data...",e.t0),e.next=11,Nf();case 11:this.isDirty=!1;case 12:case"end":return e.stop()}}),e,this,[[1,6]])})))}},{key:"saveIfDirty",value:function(){return Eh(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lt("SuggestionTrie::saveIfDirty",this.isDirty),!this.isDirty){e.next=4;break}return e.next=4,this.save();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"markDirty",value:function(){this.isDirty=!0}},{key:"isEmpty",value:function(){return Object(St.a)(this.trieDataArray)}},{key:"isDataIncomplete",value:function(){return this.isIncomplete}},{key:"markIncomplete",value:function(){this.isIncomplete=!0}},{key:"reset",value:function(){lt("SuggestionTrie::reset"),this.root={indices:[]},this.trieData={},this.trieDataArray=[],this.isDirty=!1,this.isIncomplete=!1}},{key:"getRoot",value:function(){return this.root}},{key:"getDataLookup",value:function(){return this.trieData}},{key:"getData",value:function(){return this.trieDataArray}},{key:"assign",value:function(e,t){for(var r={},n=0;n<t.length;++n)r[Ed(t[n])]=n;this.root=e,this.trieDataArray=t,this.trieData=r}},{key:"recordQueryData",value:function(e){var t=function e(t,r){var n=r[t[0]],i=t.substr(1);if(n)return i?e(i,n):n}(e,this.root);t&&(t.clientOnly=e.length>3)}},{key:"addKeyword",value:function(e,t){var r=this.root,n=Ed(t),i=-1;void 0===this.trieData[n]?(i=this.trieDataArray.length,this.trieDataArray.push(t),this.trieData[n]=i):(i=this.trieData[n],this.trieDataArray[i].rank<t.rank&&(this.trieDataArray[i]=t));for(var o=0;o<e.length&&!r.pruned;)r=Ch(r,e[o++],i);o<e.length&&r.pruned&&-1===r.indices.indexOf(i)&&r.indices.push(i)}}]),e}();!function(e){e[e.Unknown=0]="Unknown",e[e.SignedIn=1]="SignedIn",e[e.SignedOut=2]="SignedOut"}(Oh||(Oh={}));var Ih=function(e,t,r,n){return new(r||(r=L.a))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},Ah=self;new(function(){function e(t){var r=this;n(this,e),this.transport=t,this.isInitializing=!1,this.isDataLoading=!1,this.isDataReLoading=!1,this.isInitialized=!1,this.needRefreshing=!1,this.optionsResolver=st.f,this.pageLoadedResolver=function(){},this.userInfoLoadedResolver=function(){},this.accessTokenLoadedResolver=function(){},this.msbAccessToken="",this.onSaveServerSuggestionsTimer=function(){var e=r.context,t=e.trie,n=e.serverTrieInput;if(e.isDataStoreSupported){var i=t.isDataIncomplete(),o=i||r.isDataLoading?L.a.resolve():t.saveIfDirty();i?lt("QueryFormulationWorker::saveServerSuggestions trie save disabled as trie has errors"):i&&lt("QueryFormulationWorker::saveServerSuggestions trie save disabled because the data is still loading");var a=r.wrapIndexedDbRequest((function(){return Uf(n)}));L.a.all([o,a]).then((function(){lt("QueryFormulationWorker::saveServerSuggestions succeeded",n)})).catch((function(e){lt("QueryFormulationWorker::saveServerSuggestions failed",e)}))}},this.getGraphToken=function(){return Ih(r,void 0,void 0,D.a.mark((function e(){var t,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(new Date).getTime(),this.graphToken&&!(this.graphToken.tokenExpiry&&this.graphToken.tokenExpiry<t)){e.next=11;break}return this.graphToken?lt("QueryFormulationWorker: : getGraphToken Token expired (".concat(this.graphToken.tokenExpiry," < ").concat(t,"). Fetching fresh graph token...")):lt("QueryFormulationWorker::getGraphToken No cached token. Fetching new graph token..."),e.next=5,this.ensureHostInitialized();case 5:if(r=this.context.msbRestProvider){e.next=8;break}throw new Error("msbRestProvider was not initialized");case 8:return e.next=10,rr(r);case 10:this.graphToken=e.sent;case 11:return e.abrupt("return",this.graphToken&&this.graphToken.token||"");case 12:case"end":return e.stop()}}),e,this)})))};var i={userInfoLoaded:!1,lastUserInfoLoaded:!1,signInState:Oh.Unknown,isDataLoadAllowed:!1};this.context={trie:new Ph,serverTrieInput:[],userContext:i,loggerContext:{pendingValueParams:[],pendingRoundTripTimeParams:[],pendingErrorParams:[]},isDataStoreSupported:nf(),zeroQuerySuggestions:{suggestions:[]}},this.options=new L.a((function(e){r.optionsResolver=e})),this.pageLoaded=new L.a((function(e){r.pageLoadedResolver=e})),this.userInfoLoaded=new L.a((function(e){r.userInfoLoadedResolver=e})),this.accessTokenLoaded=new L.a((function(e){r.accessTokenLoadedResolver=e}));var o="undefined"!=typeof performance?performance.now():0;this.pageLoadTime=new Date((new Date).getTime()-o)}return w(e,[{key:"initialize",value:function(){var e=this;this.transport.subscribe((function(t){return e.onMessage(t)}));var t,r,n,i=new Wo(this.getGraphToken);this.context.graphRestProvider=i,this.wasInitializedMarker=L.a.all([this.initializeRestProvider(),this.initializeLogging()]).then((function(){return e.setLokiRestProvider()})).then((function(){return e.loadUser()})),this.postMessage({messageType:yu.OnLoaded}),Object(ct.setLocalizationErrorHandlerForDefaultStringProvider)((function(e){})),t=this.context.loggerContext,r=this.pageLoadTime,n=new Date,Io(t,"Loaded",r,n)}},{key:"wasInitialized",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.wasInitializedMarker){e.next=2;break}throw new Error("initialize() was not called");case 2:return e.next=4,this.wasInitializedMarker;case 4:case"end":return e.stop()}}),e,this)})))}},{key:"postMessage",value:function(e){lt("QueryFormulationWorker::postMessage",yu[e.messageType],e),this.transport.send(e)}},{key:"initializeData",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o=this;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(new Date).getTime(),lt("QueryFormulationWorker::initializeData"),!this.isInitializing){e.next=5;break}return lt("QueryFormulationWorker::initializeData already initializing."),e.abrupt("return");case 5:return e.prev=5,r=setTimeout((function(){lt("QueryFormulationWorker::initializeData timed out, fallback to server"),o.isInitializing=!1,o.postMessage({messageType:yu.OnInitialize})}),7e3),this.isInitializing=!0,e.next=11,this.ensureHostInitialized();case 11:if(!ur("msbqfdebugcln")){e.next=18;break}return lt("QueryFormulationWorker:: for debug use, cleaning the cache and reloading the data"),clearTimeout(r),e.next=16,this.refreshTrieData(!0,!0);case 16:e.next=25;break;case 18:return n=this.context.trie.loadWithStaleRefresh((function(e){return Ih(o,void 0,void 0,D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return lt("QueryFormulationWorker::initializeData refreshTrieData"),e||(lt("QueryFormulationWorker::initializeData was not initialized, fallback to server"),this.postMessage({messageType:yu.OnInitialize})),t.next=4,this.refreshTrieData(!1,!0);case 4:ur("bfbindexdblog")&&Mo(this.context.loggerContext,"initializedata","");case 5:case"end":return t.stop()}}),t,this)})))}),this.context.loggerContext),i=this.initializeServerTrieInput(),e.next=22,L.a.all([n,i]);case 22:return e.next=24,this.intializeZeroQuerySuggestions();case 24:clearTimeout(r);case 25:this.isInitialized=!0,this.isInitializing=!1,e.next=32;break;case 29:e.prev=29,e.t0=e.catch(5),this.isInitializing=!1;case 32:lt("QueryFormulationWorker::initializeData completed (".concat(el(t)," ms)"));case 33:case"end":return e.stop()}}),e,this,[[5,29]])})))}},{key:"isDataInitialized",value:function(){return this.isInitialized}},{key:"initializeHost",value:function(e){var t,r;lt("QueryFormulationWorker::initializeHost",e),this.context.options=e,t=e.variants,sr=t,r=e.tenantVariants,cr=r,e.isConsoleLoggerEnabled&&(ut.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]},ut.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]}),this.optionsResolver(e)}},{key:"localize",value:function(e,t){lt("QueryFormulationWorker::localize",e,t),Object(ct.addStringMapForDefaultStringProvider)(e,t)}},{key:"onPostLoad",value:function(){lt("QueryFormulationWorker::onPostLoad"),this.pageLoadedResolver()}},{key:"onSignIn",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::onSignIn"),this.context.userContext.signInState=Oh.Unknown,e.next=5,this.tryFetchUserInfo();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"onSignOut",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::onSignOut"),(t=this.context.userContext).signInState=Oh.SignedOut,t.userInfo=void 0,t.userInfoLoaded=!1,e.next=7,this.wipeOutData();case 7:ur("bfbindexdblog")&&Mo(this.context.loggerContext,"","UserSignout"),this.isInitialized=!1;case 9:case"end":return e.stop()}}),e,this)})))}},{key:"onSoftSignOut",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:lt("QueryFormulationWorker::onSoftSignOut"),(t=this.context.userContext).signInState=Oh.SignedOut,t.userInfo=void 0,t.userInfoLoaded=!1;case 5:case"end":return e.stop()}}),e,this)})))}},{key:"saveTrie",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.context.trie.save();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"deleteAllData",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context.isDataStoreSupported){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,ap(this.context.options);case 5:ur("bfbindexdblog")&&Mo(this.context.loggerContext,"","successful"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),ur("bfbindexdblog")&&Mo(this.context.loggerContext,"","failed"),lt("QueryFormulationWorker::deleteAll there was errors deleting the data",e.t0);case 12:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"clearTrie",value:function(){this.context.trie.reset(),this.context.serverTrieInput=[],this.clearSaveServerSuggestionsTimer(),this.context.zeroQuerySuggestions={suggestions:[]}}},{key:"refreshData",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::QueryFormulationWorker:refreshData"),e.next=3,this.reloadTrieData(!1);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"rebuildData",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshTrieData(!0);case 2:this.context.serverTrieInput=[];case 3:case"end":return e.stop()}}),e,this)})))}},{key:"setAccessToken",value:function(e){return Ih(this,void 0,void 0,D.a.mark((function t(){var r,n=this;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(lt("QueryFormulationWorker:setAccessToken"),(r=this.msbAccessToken&&e!==this.msbAccessToken)&&(lt("QueryFormulationWorker:setAccessToken updated token, will soft sign out"),this.onSoftSignOut()),this.msbAccessToken=e,this.getMsbAccessToken=function(){return new L.a((function(e){return e(n.msbAccessToken)}))},this.accessTokenLoadedResolver(),!r){t.next=10;break}return lt("QueryFormulationWorker:setAccessToken reloading user with updated token"),t.next=10,this.loadUser();case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getWorkerContext",value:function(){return this.context}},{key:"getSuggestions",value:function(e,t){return Ih(this,void 0,void 0,D.a.mark((function r(){var n,i,o,a,s,c;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.context,i=n.userContext,o=n.trie,r.next=3,this.ensureHostInitialized();case 3:if(!Ui(e)){r.next=5;break}return r.abrupt("return",void 0);case 5:if(i.signInState!==Oh.SignedOut){r.next=9;break}return lt("QueryFormulationWorker::getSuggestions User is not authorized. getSuggestions returns nothing"),r.abrupt("return",void 0);case 9:return a=yl(e),s=Bd(o,a,t,e),c=ze(s.suggestions,dp),r.abrupt("return",{suggestions:c,clientOnly:s.clientOnly});case 13:case"end":return r.stop()}}),r,this)})))}},{key:"getServerSuggestions",value:function(e,t,r){var n;return Ih(this,void 0,void 0,D.a.mark((function i(){var o,a,s,c,u,l,f,d,p,h,v,g,_,y,b,m,k,T,S,w,x,C,O,E=this;return D.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=(new Date).getTime(),i.next=3,this.ensureHostInitialized();case 3:if(a=i.sent,s=ur("bfb3sqf")||Qo(),!Ui(e)){i.next=7;break}return i.abrupt("return",void 0);case 7:if(c=this.context,u=c.msbRestProvider,l=c.substrateRestProvider,f=c.userContext,d=c.trie,u){i.next=10;break}return i.abrupt("return",void 0);case 10:if(f.signInState!==Oh.SignedOut){i.next=13;break}return i.abrupt("return",void 0);case 13:if(lt("QueryFormulationWorker::getServerSuggestions",e),p=null===(n=this.context.options)||void 0===n?void 0:n.clientCorrelationId,h=void 0,v=[],!s||!p){i.next=37;break}if(g=l||new xa(u),_=r&&r.count||10,y=a.culture||"en-US",!(null==r?void 0:r.qfLoggerContext)){i.next=27;break}return i.next=24,Qp((function(){return ma(g,e,_,p,y,null==r?void 0:r.domains)}),(function(e){return Xp(E,e)}),"QueryFormulation_Server_RoundTripTime",null==r?void 0:r.qfLoggerContext);case 24:i.t0=i.sent,i.next=30;break;case 27:return i.next=29,ma(g,e,_,p,y,null==r?void 0:r.domains);case 29:i.t0=i.sent;case 30:if(b=i.t0,lt("QueryFormulationWorker::getServerSuggestions:getSubstrateSuggestions got 3s response from server",e,b,t),null==b?void 0:b.Groups){i.next=34;break}return i.abrupt("return",void 0);case 34:v=Ta(b.Groups),i.next=52;break;case 37:if(m={query:e,count:r&&r.count||10,domains:null==r?void 0:r.domains,clientContext:{clientType:a.clientType},isCacheMissRequest:!!ur("bfbqfcm")||void 0},!(null==r?void 0:r.qfLoggerContext)){i.next=44;break}return i.next=41,Qp((function(){return Jt(u,m)}),(function(e){return Xp(E,e)}),"QueryFormulation_Server_RoundTripTime",null==r?void 0:r.qfLoggerContext);case 41:i.t1=i.sent,i.next=47;break;case 44:return i.next=46,Jt(u,m);case 46:i.t1=i.sent;case 47:if(k=i.t1,lt("QueryFormulationWorker::getServerSuggestions:getSuggestions got msb response from server",e,k,t),null==k?void 0:k.results){i.next=51;break}return i.abrupt("return",void 0);case 51:v=k.results;case 52:return i.next=54,Cd(d,e,v);case 54:return h=i.sent,T=Bd(d,e,r,e),S=at(T.suggestions,t,Pd),w=r&&r.count||4,x=w-t.length,C=J(S,x),this.saveServerSuggestions(h),O=ze(C,dp),lt("QueryFormulationWorker::getServerSuggestions completed in ".concat(el(o)," ms"),h),i.abrupt("return",{suggestions:O});case 64:case"end":return i.stop()}}),i,this)})))}},{key:"getZeroQuerySuggestions",value:function(e){return Ih(this,void 0,void 0,D.a.mark((function t(){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.context.userContext,t.next=3,this.ensureHostInitialized();case 3:if(r.signInState!==Oh.SignedOut){t.next=7;break}return lt("QueryFormulationWorker::getSuggestions User is not authorized. getSuggestions returns nothing"),t.abrupt("return",void 0);case 7:return t.abrupt("return",this.filterZeroQfResults(e));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"filterZeroQfResults",value:function(e){var t=e&&e.count||4,r=this.context.zeroQuerySuggestions;if(!r)return{suggestions:[]};var n=r.suggestions,i=this.getDomainSuggestions(n,"File",e),o=this.getDomainSuggestions(n,"Person",e),a=this.getDomainSuggestions(n,"Bookmark",e),s=Math.floor(t/3),c=t-Math.min(s,i.length)-Math.min(s,a.length),u=[].concat(R(i.slice(0,s)),R(o.slice(0,c)),R(a.slice(0,s)));return{suggestions:(null==e?void 0:e.dynamicRanking)?this.randomizeSuggestionResults(u):u}}},{key:"getDomainSuggestions",value:function(e,t,r){var n=[],i=null==r?void 0:r.domains;return n=i?-1!==i.indexOf(t)?e.filter((function(e){return e.domain===t})):[]:e.filter((function(e){return e.domain===t})),(null==r?void 0:r.dynamicRanking)?this.randomizeSuggestionResults(n):n}},{key:"randomizeSuggestionResults",value:function(e){return e?e.sort((function(){return Math.random()-.5})):[]}},{key:"handleTenantSwitch",value:function(e,t){return Ih(this,void 0,void 0,D.a.mark((function r(){var n,i,o;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.context.userContext,i=n.lastUserInfo,o=n.lastUserInfoLoaded,!i||!o||!e&&!t){r.next=19;break}if(t===i.tenant.id&&e===i.user.id){r.next=16;break}return lt("QueryFormulationWorker::handleTenantSwitch is true. Cleaning store and forcing reload."),r.prev=5,r.next=8,this.wipeOutData();case 8:r.next=13;break;case 10:r.prev=10,r.t0=r.catch(5),lt("QueryFormulationWorker::wipeOutData failed. Cleaning store and forcing reload.");case 13:return r.abrupt("return",!0);case 16:return r.abrupt("return",!1);case 17:r.next=20;break;case 19:return r.abrupt("return",!1);case 20:case"end":return r.stop()}}),r,this,[[5,10]])})))}},{key:"isDataLoaded",value:function(){return!this.isDataReLoading}},{key:"saveServerSuggestions",value:function(e){this.context.serverTrieInput.push(e),this.clearSaveServerSuggestionsTimer(),this.saveServerSuggestionsTimer=setTimeout(this.onSaveServerSuggestionsTimer,3e3)}},{key:"clearSaveServerSuggestionsTimer",value:function(){this.saveServerSuggestionsTimer&&(clearTimeout(this.saveServerSuggestionsTimer),this.saveServerSuggestionsTimer=void 0)}},{key:"initializeRestProvider",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::initializeRestProvider"),e.next=3,this.ensureHostInitialized();case 3:if(!zo(t=e.sent)){e.next=7;break}return e.next=7,this.accessTokenLoaded;case 7:this.context.msbRestProvider=new Vt(t.environment,Uo(t.variants),this.getMsbAccessToken,void 0,zo(t)),lt("QueryFormulationWorker::initializeRestProvider initialized");case 9:case"end":return e.stop()}}),e,this)})))}},{key:"initializeLogging",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::initializeLogging"),e.next=3,this.ensureHostInitialized();case 3:t=e.sent,r=bu(t),n=this.context,i=n.userContext,(o=n.loggerContext).logger=r,a=new Date,i.userInfo&&(lt("updateLoggerUserInfo",i.userInfo),vo(r,i.userInfo)),_o(o),lt("QueryFormulationWorker::initializeLogging initialized","PageLoadTime",this.pageLoadTime,a);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"onMessage",value:function(e){e.data&&e.data.hasOwnProperty("messageType")?function(e,t,r){Gp(this,void 0,void 0,D.a.mark((function n(){var i,o,a,s,c;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=t,n.t0=t.messageType,n.next=n.t0===yu.ProbeLoaded?4:n.t0===yu.Initialize?6:n.t0===yu.ProbeInitialized?9:n.t0===yu.InitializeHost?12:n.t0===yu.Localize?16:n.t0===yu.PostLoad?19:n.t0===yu.SignIn?21:n.t0===yu.SignOut?24:n.t0===yu.SoftSignOut?27:n.t0===yu.RefreshData?30:n.t0===yu.RebuildData?33:n.t0===yu.SaveTrie?36:n.t0===yu.DeleteData?39:n.t0===yu.ClearTrie?42:n.t0===yu.GetSuggestions?44:n.t0===yu.GetExtraSuggestions?48:n.t0===yu.setAccessToken?49:n.t0===yu.GetZeroQfSuggestions?52:n.t0===yu.HandleTenantSwitch?56:60;break;case 4:return Jp(e,yu.OnLoaded),n.abrupt("break",62);case 6:return n.next=8,nh(e);case 8:return n.abrupt("break",62);case 9:return n.next=11,ih(e);case 11:return n.abrupt("break",62);case 12:return o=t,n.next=15,oh(e,o);case 15:return n.abrupt("break",62);case 16:return ah(e,t),n.abrupt("break",62);case 19:return sh(e,i.id),n.abrupt("break",62);case 21:return n.next=23,ch(e,i.id);case 23:return n.abrupt("break",62);case 24:return n.next=26,uh(e,i.id);case 26:return n.abrupt("break",62);case 27:return n.next=29,lh(e,i.id);case 29:return n.abrupt("break",62);case 30:return n.next=32,fh(e,i.id);case 32:return n.abrupt("break",62);case 33:return n.next=35,dh(e,i.id);case 35:return n.abrupt("break",62);case 36:return n.next=38,hh(e,i.id);case 38:return n.abrupt("break",62);case 39:return n.next=41,vh(e,i.id);case 41:return n.abrupt("break",62);case 42:return ph(e,i.id),n.abrupt("break",62);case 44:return a=t,n.next=47,eh(e,r,a.query,a.options);case 47:case 48:return n.abrupt("break",62);case 49:return rh(e,t.token),n.abrupt("break",62);case 52:return s=t,n.next=55,th(e,s.options);case 55:return n.abrupt("break",62);case 56:return c=t,n.next=59,gh(e,c.userId,c.tenantId);case 59:case 60:return n.abrupt("break",62);case 62:case"end":return n.stop()}}),n)})))}(this,e.data,this.context.loggerContext):lt("QueryFormulationWorker::onMessage. Unknown message format",e.data)}},{key:"setLokiRestProvider",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureHostInitialized();case 2:ur("msbqflokippl")&&(t=this.context.msbRestProvider,r=new Bo(t),this.context.lokiRestProvider=r);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"loadUser",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.a.all([this.loadSavedUserInfo(),this.tryFetchUserInfo()]);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),lt("QueryFormulationWorker::loadUser Unable to load user...",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})))}},{key:"ensureHostInitialized",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.options;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"ensurePageLoaded",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::ensurePageLoaded wait for page loaded"),e.next=3,this.pageLoaded;case 3:lt("QueryFormulationWorker::ensurePageLoaded done waiting for page loaded");case 4:case"end":return e.stop()}}),e,this)})))}},{key:"ensureUserInfoLoaded",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lt("QueryFormulationWorker::ensureUserInfoLoaded wait for user info loaded"),e.next=3,this.userInfoLoaded;case 3:lt("QueryFormulationWorker::ensureUserInfoLoaded done waiting for user info loaded");case 4:case"end":return e.stop()}}),e,this)})))}},{key:"loadSavedUserInfo",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o=this;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.context,r=t.userContext,n=t.loggerContext,i=t.isDataStoreSupported,e.prev=1,!i){e.next=6;break}return e.next=5,to(n,(function(){return o.wrapIndexedDbRequest((function(){return nf()?cf("user","info"):L.a.reject(new Error("IndexedDB not supported"))}))}),"LoadLastUserInfo_RoundTripTime");case 5:r.lastUserInfo=e.sent;case 6:lt("QueryFormulationWorker::loadUserInfoFromStore last userInfo",r.lastUserInfo),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),lt("QueryFormulationWorker::loadUserInfoFromStore Unable to fetch user info from indexedDB...",e.t0);case 12:return r.lastUserInfoLoaded=!0,e.prev=13,e.next=16,this.onUserInfoLoaded();case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(13),lt("QueryFormulationWorker::loadSavedUserInfo onUserInfoLoaded failed",e.t1),wo(this.context.loggerContext,e.t1);case 22:case"end":return e.stop()}}),e,this,[[1,9],[13,18]])})))}},{key:"tryFetchUserInfo",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o=this;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context,r=t.userContext,n=t.loggerContext,e.prev=1,e.next=4,to(n,(function(){return o.fetchUserInfo()}),"FetchUserInfo_RoundTripTime");case 4:r.userInfo=e.sent,r.userInfoLoaded=!0,r.signInState=Oh.SignedIn,lt("QueryFormulationWorker::tryFetchUserInfo current userInfo",r.userInfo),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),lt("QueryFormulationWorker::tryFetchUserInfo Unable to fetch user info from server...",e.t0),401!==(i=e.t0).statusCode&&403!==i.statusCode||(r.signInState=Oh.SignedOut);case 15:return e.prev=15,e.next=18,this.onUserInfoLoaded();case 18:e.next=24;break;case 20:e.prev=20,e.t1=e.catch(15),lt("QueryFormulationWorker::tryFetchUserInfo onUserInfoLoaded failed",e.t1),wo(this.context.loggerContext,e.t1);case 24:case"end":return e.stop()}}),e,this,[[1,10],[15,20]])})))}},{key:"fetchUserInfo",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureHostInitialized();case 2:if(t=this.context.msbRestProvider){e.next=5;break}throw new Error("msbRestProvider was not initialized");case 5:return e.next=7,er(t);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"updateIsDataLoadAllowed",value:function(){var e=this.context,t=e.loggerContext,r=e.userContext,n=e.isDataStoreSupported,i=r.userInfo,o=r.lastUserInfo,a=!1;i&&n&&(a=function(e,t){if(e.isDeviceTrusted)return lt("QueryFormulationWorker::canLoadAllData trusted device"),!0;if(e.isNetworkTrusted)return lt("QueryFormulationWorker::canLoadAllData trusted network"),!0;if(e.keepMeSignedIn)return lt("QueryFormulationWorker::canLoadAllData keep me signed in"),!0;if(t&&t.timestamp){var r=((new Date).getTime()-t.timestamp)/1e3;if(r>=172800)return lt("QueryFormulationWorker::canLoadAllData signed in for long enough (".concat(r," >= ").concat(172800,")")),!0;lt("QueryFormulationWorker::canLoadAllData signed in is too fresh (".concat(r," < ").concat(172800,")"))}return!1}(i,o)),function(e,t,r,n,i){var o={allowed:t,supported:i,networkTrusted:r&&r.isNetworkTrusted,deviceTrusted:r&&r.isDeviceTrusted,keepMeSignedIn:r&&r.keepMeSignedIn},a=(new Date).getTime(),s=((a-(n&&n.timestamp||a))/1e3).toFixed(0);fo(e,{eventId:"DataLoadAllowedDetails",properties:{name:"DataLoadAllowedDetails",value:Po(o,(function(e,t,r){return e.push(r+"="+(t?"1":"0")),e}),[]).join("&")+"&age="+s}})}(t,a,i,o,n),r.isDataLoadAllowed=a}},{key:"onUserInfoLoaded",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t,r,n,i,o,a,s,c,u;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.context,r=t.userContext,n=t.loggerContext,i=t.isDataStoreSupported,r.userInfoLoaded&&r.lastUserInfoLoaded){e.next=3;break}return e.abrupt("return");case 3:if(o=r.userInfo,a=r.lastUserInfo,o){e.next=7;break}return lt("QueryFormulationWorker::onUserInfoLoaded User is not authenticated. Ignoring."),e.abrupt("return");case 7:if((s=n.logger)&&(lt("updateLoggerUserInfo",r.userInfo),vo(s,o)),a){e.next=29;break}if(lt("QueryFormulationWorker::onUserInfoLoaded User was not saved. Saving to indexedDB"),c={user:o.user,tenant:o.tenant,timestamp:(new Date).getTime()},e.prev=12,!i){e.next=16;break}return e.next=16,this.wrapIndexedDbRequest((function(){return zf(c)}));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),lt("QueryFormulationWorker::onUserInfoLoaded Unable to save user info",e.t0);case 21:if(r.lastUserInfo=c,this.updateIsDataLoadAllowed(),this.userInfoLoadedResolver(),this.isInitialized||this.isInitializing){e.next=28;break}return lt("QueryFormulationWorker::onUserInfoLoaded Data was not loaded, reloading"),e.next=28,this.initializeData();case 28:return e.abrupt("return");case 29:if(o.tenant.id===a.tenant.id&&o.user.id===a.user.id){e.next=43;break}return lt("QueryFormulationWorker::onUserInfoLoaded User changed. Cleaning store and forcing reload."),e.next=33,this.wipeOutData();case 33:return u={user:o.user,tenant:o.tenant,timestamp:(new Date).getTime()},e.next=36,this.wrapIndexedDbRequest((function(){return zf(u)}));case 36:return r.lastUserInfo=u,this.updateIsDataLoadAllowed(),this.userInfoLoadedResolver(),e.next=41,this.refreshTrieData(!0);case 41:return ur("bfbindexdblog")&&Mo(this.context.loggerContext,"tenantswitch","tenantswitch"),e.abrupt("return");case 43:if(lt("QueryFormulationWorker::onUserInfoLoaded Same user loaded. No action required"),this.updateIsDataLoadAllowed(),this.userInfoLoadedResolver(),this.isInitialized||this.isInitializing){e.next=52;break}return lt("QueryFormulationWorker::onUserInfoLoaded Data was not loaded, reloading"),e.next=50,this.initializeData();case 50:e.next=56;break;case 52:if(!this.needRefreshing){e.next=56;break}return lt("QueryFormulationWorker:onUserInfoLoaded need refreshing"),e.next=56,this.reloadTrieData(!1);case 56:case"end":return e.stop()}}),e,this,[[12,18]])})))}},{key:"refreshTrieData",value:function(e,t){return Ih(this,void 0,void 0,D.a.mark((function r(){return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.isDataReLoading=!0,r.next=3,this.reloadTrieData(!0,e);case 3:return this.isDataReLoading=!1,r.prev=4,r.next=7,lf("refreshtime","time",(new Date).getTime());case 7:return r.next=9,lf("variants","variants",Zl(sr||[],or));case 9:r.next=14;break;case 11:r.prev=11,r.t0=r.catch(4),n=this.context.loggerContext,i=r.t0,Co(n,i,"QF initialization error: "+"Error updating trie with refresh time/variants"+", "+i.name+": "+i.message,"QFInitError");case 14:t&&this.postMessage({messageType:yu.OnDataLoaded});case 15:case"end":return r.stop()}var n,i}),r,this,[[4,11]])})))}},{key:"reloadTrieData",value:function(e,t){return Ih(this,void 0,void 0,D.a.mark((function r(){var n,i,o,a,s,c,u,l,f,d,p=this;return D.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!ur("msbqfnofetch")){r.next=2;break}return r.abrupt("return");case 2:return n=new Date,lt("QueryFormulationWorker::reloadTrieData",e),r.next=6,this.ensureHostInitialized();case 6:if(i=r.sent,o=this.context,a=o.msbRestProvider,s=o.graphRestProvider,a){r.next=11;break}return lt("QueryFormulationWorker::reloadTrieData msbRestProvider not initialized..."),r.abrupt("return");case 11:if(s){r.next=14;break}return lt("QueryFormulationWorker::reloadTrieData graphRestProvider not initialized..."),r.abrupt("return");case 14:if(!this.isDataLoading){r.next=17;break}return lt("QueryFormulationWorker::reloadTrieData already loading. Skipping"),r.abrupt("return");case 17:return c=new Ph,u=!1,r.prev=19,this.isDataLoading=!0,r.next=23,this.ensurePageLoaded();case 23:return r.next=25,this.ensureUserInfoLoaded();case 25:return r.next=27,op(c,this.context,e,!0,t);case 27:ur("bfbindexdblog")&&Mo(this.context.loggerContext,"successful",""),u=!0,this.needRefreshing=!1,this.isDataLoading=!1,r.next=42;break;case 33:if(r.prev=33,r.t0=r.catch(19),ur("bfbindexdblog")&&Mo(this.context.loggerContext,"failed",""),this.needRefreshing=!0,this.isDataLoading=!1,c.markIncomplete(),h=this.context.loggerContext,v=r.t0,Co(h,v,"ReloadTrieData failed. Unable to build trie. Error Name: "+v.name+", Error Message: "+v.message,"ReloadTrieDataError"),!c.isEmpty()){r.next=42;break}return r.abrupt("return");case 42:if(lt("QueryFormulationWorker::reloadTrieData completed, updating trie"),qo(i)&&(lt("QueryFormulationWorker::reloadTrieData prune the trie"),l=new Date,c.prune(),lt("QueryFormulationWorker::reloadTrieData triePrune completed (".concat(el(l.getTime())," ms)"))),this.context.trie=c,Ao(this.context.loggerContext,n,new Date),!u){r.next=63;break}return this.isInitialized=!0,r.prev=48,r.next=51,c.saveIfDirty();case 51:if(!qo(i)){r.next=58;break}return lt("Reloading the trie to force garbage collection"),f=new Ph,d=!0,r.next=57,f.load((function(e){xo(p.context.loggerContext),d=!1}));case 57:d&&(this.context.trie=f);case 58:r.next=63;break;case 60:r.prev=60,r.t1=r.catch(48);case 63:lt("QueryFormulationWorker::reloadTrieData completed (".concat(el(n.getTime())," ms)"));case 64:case"end":return r.stop()}var h,v}),r,this,[[19,33],[48,60]])})))}},{key:"initializeServerTrieInput",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context.isDataStoreSupported){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.t0=ip,e.next=6,Wf();case 6:e.t1=e.sent,this.context.serverTrieInput=(0,e.t0)(e.t1),e.next=14;break;case 10:e.prev=10,e.t2=e.catch(2),lt("initializeServerTrieInput Unable to load server trie input on startup...",e.t2),this.wrapIndexedDbRequest((function(){return Uf([])})).catch((function(e){}));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})))}},{key:"intializeZeroQuerySuggestions",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ur("bfbzqfwork")&&this.context.isDataStoreSupported){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,sp(this.context);case 5:if(t=e.sent){e.next=8;break}return e.abrupt("return");case 8:this.context.zeroQuerySuggestions=t,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),lt("intializeZeroQuerySuggestions unable to load",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])})))}},{key:"wrapIndexedDbRequest",value:function(e){return Ih(this,void 0,void 0,D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0.target&&t.t0.target.error&&"InvalidStateError"===t.t0.target.error.name&&(lt("QueryFormulationWorker::wrapIndexedDbRequest indexedDB is not supported. Marking as broken.",t.t0),this.context.isDataStoreSupported=!1),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"wipeOutData",value:function(){return Ih(this,void 0,void 0,D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.graphToken=void 0,this.clearTrie(),this.deleteAllData();case 3:case"end":return e.stop()}}),e,this)})))}}]),e}())(new x(Ah)).initialize(),void 0===Object(i.a)(Ah.Worker)&&(Ah.Worker=function(){});var Rh=function(e){function t(){return n(this,t),o(this,l(t).call(this,""))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=d()(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),t}(m(Worker))}]);